!function(){"use strict";angular.module("facetApp",["ui.router","seco.facetedSearch","ngTable","angular.filter","ngAnimate","ui.bootstrap","infinite-scroll","uiGmapgoogle-maps","rzModule"]).constant("_",_).constant("google",google).constant("RESULTS_PER_PAGE",25).constant("PAGES_PER_QUERY",1).value("SPARQL_ENDPOINT_URL","https://ldf.fi/nbf/sparql").run(["authStorage",function(e){e.init()}]).run(["google",function(e){e.charts.load("current",{packages:["corechart","line"]})}]).config(["$urlMatcherFactoryProvider",function(e){e.strictMode(!1)}]).service("authInterceptor",["$q","$state",function(e,t){this.responseError=function(a){return 401==a.status&&t.go("login"),e.reject(a)}}]).config(["$httpProvider",function(e){e.interceptors.push("authInterceptor")}]).config(["$locationProvider",function(e){e.html5Mode(!0)}]).config(["$stateProvider",function(e){e.state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginController",controllerAs:"vm"}).state("portal",{url:"",templateUrl:"views/portal.html",controller:"PortalController",controllerAs:"vm"}).state("person",{abstract:!0,url:"/henkilo/:personId",templateUrl:"views/person/tabs.html"}).state("person.detail",{url:"?tab",templateUrl:"views/person/detail.html",params:{tab:{value:"0",squash:!0}},controller:"DetailController",controllerAs:"vm"}).state("person.map",{url:"/kartat",templateUrl:"views/person/map.html",controller:"MapController",controllerAs:"vm"}).state("person.network",{url:"/verkosto?coloroption&sizeoption",params:{coloroption:{value:"0",squash:!0},sizeoption:{value:"0",squash:!0}},templateUrl:"views/person/network.html",controller:"PersonNetworkController",controllerAs:"vm"}).state("person.sentence",{url:"/lauseet",templateUrl:"views/person/sentences.html",controller:"PersonSentencesController",controllerAs:"vm"}).state("person.linguistics",{url:"/kielianalyysi",templateUrl:"views/person/linguistics.html",controller:"PersonLinguisticsController",controllerAs:"vm"}).state("place",{url:"/paikka/:placeId",templateUrl:"views/place.html",controller:"PlaceController",controllerAs:"vm"}).state("search",{url:"/haku",templateUrl:"views/search/tabs.html"}).state("search.table",{url:"/lista",templateUrl:"views/search/table.html",controller:"TableController",controllerAs:"vm"}).state("search.cards",{url:"/ruudukko",templateUrl:"views/search/cards.html",controller:"CardsController",controllerAs:"vm"}).state("maps",{url:"/kartat",templateUrl:"views/groupmap/tabs.html"}).state("maps.singleview",{url:"/tapahtumat",templateUrl:"views/groupmap/singleview.html",controller:"GroupmapController",controllerAs:"vm"}).state("maps.comparison",{url:"/vertaatapahtumat",abstract:!0,templateUrl:"views/comparison.html"}).state("maps.comparison.sides",{url:"",views:{"left@maps.comparison":{templateUrl:"views/groupmap/comparison.left.html",controller:"GroupmapController",controllerAs:"vm"},"right@maps.comparison":{templateUrl:"views/groupmap/comparison.right.html",controller:"GroupmapControllerRight",controllerAs:"vm"}}}).state("maps.singleview2",{url:"/elamat",templateUrl:"views/groupmap/singleview2.html",controller:"LifemapController",controllerAs:"vm"}).state("maps.comparison2",{url:"/vertaaelamat",abstract:!0,templateUrl:"views/comparison.html"}).state("maps.comparison2.sides",{url:"",views:{"left@maps.comparison2":{templateUrl:"views/groupmap/comparison2.left.html",controller:"LifemapController",controllerAs:"vm"},"right@maps.comparison2":{templateUrl:"views/groupmap/comparison2.right.html",controller:"LifemapControllerRight",controllerAs:"vm"}}}).state("relativenetwork",{url:"/sukulaisuudet",templateUrl:"views/network/relativeNetwork.html",controller:"NetworkRelativeController",controllerAs:"vm"}).state("network",{url:"",templateUrl:"views/network/tabs.html"}).state("network.net",{url:"/verkosto",templateUrl:"views/network/network.html",controller:"NetworkController",controllerAs:"vm"}).state("network.pointcloud",{url:"/pistepilvi",templateUrl:"views/network/pointcloud.html",controller:"PointcloudController",controllerAs:"vm"}).state("nlp",{url:"/kielianalyysi",abstract:!0,templateUrl:"views/nlp/tabs.html",controller:"NlpStatisticsController",controllerAs:"vm"}).state("nlp.statistics",{url:"?facets",params:{facets:{value:'{"dataset":{"value":"<http://ldf.fi/nbf/sources/source4>","constraint":"?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source4>."}}'}},templateUrl:"views/nlp/statistics.html",controller:"NlpStatisticsController",controllerAs:"vm"}).state("nlp.comparison",{url:"",abstract:!0,templateUrl:"views/nlp/comparison.html"}).state("nlp.comparison.sides",{url:"/vertaa?facets&facets2",params:{facets:null,facets2:null},views:{"left@nlp.comparison":{templateUrl:"views/nlp/comparison.left.html",controller:"NlpComparisonController",controllerAs:"vm"},"right@nlp.comparison":{templateUrl:"views/nlp/comparison.right.html",controller:"NlpComparisonControllerRight",controllerAs:"vm"},"buttons@nlp.comparison":{templateUrl:"views/description.npl.comparison.partial.html",controller:"NlpComparisonController",controllerAs:"vm"}}}).state("visu",{url:"/tilastot",templateUrl:"views/visu/tabs.html"}).state("visu.statistics",{url:"/palkit",templateUrl:"views/visu/statistics.html",controller:"VisuColumnController",controllerAs:"vm"}).state("visu.comparison",{url:"/vertaapalkit",abstract:!0,templateUrl:"views/comparison.html"}).state("visu.comparison.sides",{url:"",views:{"left@visu.comparison":{templateUrl:"views/visu/comparison.left.html",controller:"VisuColumnController",controllerAs:"vm"},"right@visu.comparison":{templateUrl:"views/visu/comparison.right.html",controller:"VisuColumnControllerRight",controllerAs:"vm"}}}).state("visu2",{url:"/tilastot2",abstract:!0,templateUrl:"views/visu2/visu.html"}).state("visu.statistics2",{url:"/piiraat",templateUrl:"views/visu2/statistics.html",controller:"VisuPieController",controllerAs:"vm"}).state("visu.comparison2",{url:"/vertaapiiraat",abstract:!0,templateUrl:"views/comparison.html"}).state("visu.comparison2.sides",{url:"",views:{"left@visu.comparison2":{templateUrl:"views/visu2/comparison.left.html",controller:"VisuPieController",controllerAs:"vm"},"right@visu.comparison2":{templateUrl:"views/visu2/comparison.right.html",controller:"VisuPieControllerRight",controllerAs:"vm"}}}).state("testing",{url:"/testing",templateUrl:"views/testing.html",controller:"CardsController",controllerAs:"vm"}).state("feedback",{url:"/palaute",templateUrl:"views/palaute.html"})}])}(),function(){"use strict";angular.module("facetApp").service("authStorage",["$window","$http",function(e,t){function a(a){return t.defaults.headers.common.Authorization="Basic "+a,e.sessionStorage.setItem("sparqlAuthToken",a)}function i(){return e.sessionStorage.getItem("sparqlAuthToken")}this.init=function(){var e=i();e&&a(e)},this.setToken=a,this.getToken=i,this.clearToken=function(){e.sessionStorage.removeItem("sparqlAuthToken")}}])}(),function(){"use strict";function e(e,t,a,i){this.login=function(e,n){a.clearToken();var s=btoa(e+":"+n),o={headers:{Authorization:"Basic "+s}};return t.get(i+"?query=ASK{}",o).then(function(){return a.setToken(s),!0}).catch(function(){return!1})}}angular.module("facetApp").service("loginService",e),e.$inject=["$q","$http","authStorage","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";angular.module("facetApp").filter("castArray",["_",function(e){return function(t){return e.castArray(t)}}])}(),function(){"use strict";function e(e,t,a){n.prototype.postProcess=function(a){return a.forEach(function(a){if(a.id=a.id.replace(/^.+?(p[0-9]+)$/,"$1"),a.birth=a.birth?t.castArray(a.birth):null,a.death=a.death?t.castArray(a.death):null,a.images=a.images?t.castArray(a.images):["images/person_placeholder.cd371769.svg"],a.imagesources=a.imagesources?t.castArray(a.imagesources):[!1],a.description&&(a.description=e.trustAsHtml(a.description)),a.source_paragraph&&(a.source_paragraph=e.trustAsHtml(a.source_paragraph)),a.lead_paragraph&&(a.lead_paragraph=e.trustAsHtml(a.lead_paragraph)),a.norssi&&(a.norssi=a.norssi.replace("http://ldf.fi/norssit/","")),a.kirjasampo&&(a.kirjasampo=a.kirjasampo.replace("http://","https://")),a.ulan&&(a.ulan=a.ulan.replace("vocab.getty.edu/ulan/","vocab.getty.edu/page/ulan/")),a.fennica){a.fennica.constructor!==Array&&(a.fennica=[a.fennica]);for(var i=0;i<a.fennica.length;i++)a.fennica[i]="http://data.nationallibrary.fi/"+a.fennica[i].replace("http://urn.fi/URN:NBN:fi:","").replace(/:/g,"/")}a.givenName||(a.givenName=""),a.familyName||(a.familyName=""),a.givenName.constructor===Array&&2==a.givenName.length&&(a.givenName=a.givenName[0]+" ja "+a.givenName[1]),a.hasExtLinks=a.viaf||a.ulan||a.wikidata||a.wikipedia||a.fennica||a.blf||a.website||a.eduskunta||a.warsampo||a.norssi||a.kirjasampo||a.website||a.genicom||a.genitree||a.yo1853}),a};var i=Object.getPrototypeOf(a);return n.prototype=angular.extend({},i,n.prototype),new n;function n(){this.objectClass=Object}}angular.module("facetApp").factory("personMapperService",e),e.$inject=["$sce","_","objectMapperService"]}(),function(){"use strict";function e(e,t){this.getFacets=function(){var t=angular.copy(a);return e.when(t)},this.getFacetOptions=function(){return angular.copy(i)};var a={entryText:{facetId:"entryText",graph:"<http://ldf.fi/nbf/people>",name:"Haku nimen perusteella",enabled:!0},dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source> ",name:"Tietokanta",chart:!0,enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"fennica",pattern:"?id <http://ldf.fi/nbf/fennica> [] .",label:"Fennica - Suomen kansallisbibliografia"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsampo> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssi> [] .",label:"Norssit"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] . ",label:"Kirjasampo"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"Biografiskt lexikon för Finland"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"},{id:"yo1853",pattern:"?id <http://ldf.fi/nbf/yo1853> [] .",label:"Ylioppilasmatrikkeli 1853–1899"}],chart:!0,enabled:!0,name:"Linkitetyt tietokannat"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",chart:!0,enabled:!0},familyName:{facetId:"familyName",predicate:"<http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://schema.org/familyName>",chart:!0,name:"Sukunimi"},author:{facetId:"author",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://schema.org/author>",chart:!0,name:"Kirjoittaja"},place:{facetId:"place",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place>",name:"Synnyinpaikka",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:5,enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/has_title>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Arvo, ammatti tai toiminta",chart:!0,enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/related_company>",name:"Yritys tai yhteisö",chart:!0,enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>",name:"Toimiala",chart:!0,enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli tai ryhmä",chart:!0,enabled:!0},keywords:{facetId:"keywords",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://purl.org/dc/elements/1.1/subject>",name:"Avainsanat",chart:!0,enabled:!0}},i={endpointUrl:{endpointUrl:t,usePost:!0}.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://www.w3.org/2004/02/skos/core#prefLabel> ?familyName . ?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"}}angular.module("facetApp").service("facetService",e),e.$inject=["$q","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t){this.getFacets=function(){var t=angular.copy(a);return e.when(t)},this.getFacetOptions=function(){return angular.copy(i)};var a={dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source>",name:"Tietokanta",enabled:!0},slider:{facetId:"slider",name:"Rajaa henkilöiden syntymäaika",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart>",enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"fennica",pattern:"?id <http://ldf.fi/nbf/fennica> [] .",label:"Fennica - Suomen kansallisbibliografia"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsampo> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssi> [] .",label:"Norssit"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] . ",label:"Kirjasampo"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"Biografiskt lexikon för Finland"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"},{id:"yo1853",pattern:"?id <http://ldf.fi/nbf/yo1853> [] .",label:"Ylioppilasmatrikkeli 1853–1899"}],enabled:!0,chart:!0,name:"Linkitetyt tietokannat"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",enabled:!0},author:{facetId:"author",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://schema.org/author>",name:"Kirjoittaja"},birthYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>",name:"Synnyinaika",enabled:!0},place:{facetId:"place",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place>",name:"Syntymäpaikka",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:5,enabled:!1},deathplace:{facetId:"deathplace",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>)/<http://ldf.fi/nbf/place>",name:"Kuolinpaikka",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:5,enabled:!1},deathYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>/<http://ldf.fi/nbf/time>",name:"Kuolinaika",enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/has_title>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Arvo, ammatti tai toiminta",chart:!0,enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/related_company>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Yritys tai yhteisö",enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Toimiala",enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli tai ryhmä",chart:!0,enabled:!0},keywords:{facetId:"keywords",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://purl.org/dc/elements/1.1/subject>",name:"Avainsanat",chart:!0,enabled:!0}},i={endpointUrl:{endpointUrl:t,usePost:!0}.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"}}angular.module("facetApp").service("mapfacetService",e),e.$inject=["$q","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){this.getResults=function(e){return w.getResults(e,function(){var e,i=t.search().sortBy;a.isString(i)||(i="?ordinal");e="?ordinal"===i?t.search().desc?i:"DESC("+i+")":t.search().desc?"DESC("+i+")":i;return"?ordinal"===i?e:e+" ?ordinal"}())},this.getFacets=i.getFacets,this.getFacetOptions=i.getFacetOptions,this.updateSortBy=function(e){(t.search().sortBy||"?ordinal")===e&&t.search("desc",!t.search().desc||null);t.search("sortBy",e)},this.getSortClass=function(e,a){var i=t.search().sortBy||"?ordinal",n=a?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";if("?ordinal"===e){if(i===e)return t.search().desc?n:n+"-alt"}else if(i===e)return t.search().desc?n+"-alt":n},this.getAuthors=function(e){var t="VALUES ?id { <"+e+"> } . ",a=r+f.replace("<RESULT_SET>",t);return y.getObjectsNoGrouping(a)},this.getByAuthor=function(e){var t="VALUES ?id2 { <"+e+"> } . ",a=r+m.replace("<RESULT_SET>",t);return y.getObjectsNoGrouping(a)},this.getAuthoredBios=function(e){var t="VALUES ?prs { <"+e+"> } . ?prs (owl:sameAs*|^owl:sameAs*) ?author . ",a=r+g.replace("<RESULT_SET>",t);return y.getObjectsNoGrouping(a)},this.getBios=function(e){var t="VALUES ?id { <"+e+"> } . ",a=r+d.replace("<RESULT_SET>",t);return y.getObjectsNoGrouping(a).then(function(e){return e})},this.getReferences=function(e){var t="VALUES ?id2 { <"+e+"> } . ",a=r+h.replace("<RESULT_SET>",t);return y.getObjectsNoGrouping(a)},this.getByReferences=function(e){var t="VALUES ?id2 { <"+e+"> } . ",a=r+v.replace("<RESULT_SET>",t);return y.getObjectsNoGrouping(a)},this.getPerson=function(t){/^p[0-9]+$/.test(t)&&(t="http://ldf.fi/nbf/"+t);var a="VALUES ?idorg { <"+t+"> } . ?idorg owl:sameAs* ?id . FILTER NOT EXISTS { ?id owl:sameAs [] } ",i=r+c.replace("<RESULT_SET>",a);return y.getObjects(i).then(function(t){return t.length?t[t.length-1]:e.reject("Not found")})},this.getRelatives=function(e){var t=r+p,a="VALUES ?idorg { <"+e+"> } . ?idorg owl:sameAs* ?id . FILTER NOT EXISTS { ?id owl:sameAs [] } ";return y.getObjectsNoGrouping(t.replace("<RESULT_SET>",a))},this.getSimilar=function(e){var t=r+u,a="VALUES ?id { <"+e+"> } . ";return y.getObjectsNoGrouping(t.replace("<RESULT_SET>",a)).then(function(e){return e})},this.getPortal=function(){return y.getObjectsNoGrouping(r+b).then(function(e){return e})};var r=" PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX owl: <http://www.w3.org/2002/07/owl#> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX nbf: <http://ldf.fi/nbf/> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX rels: <http://ldf.fi/nbf/relations/>  PREFIX schema: <http://schema.org/> PREFIX skos: <http://www.w3.org/2004/02/skos/core#> PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX sources: <http://ldf.fi/nbf/sources/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace> ",c=" SELECT DISTINCT * WHERE {  {   <RESULT_SET>   }   ?id skosxl:prefLabel ?plabel .   \t OPTIONAL { ?plabel schema:givenName ?givenName . }  \t OPTIONAL { ?plabel schema:familyName ?familyName . }   OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:fennica ?fennica . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id nbf:warsampo ?warsampo . }  OPTIONAL { ?id nbf:norssi ?norssi . }  OPTIONAL { ?id nbf:kirjasampo ?kirjasampo . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:genicom ?genicom . }  OPTIONAL { ?id nbf:genitree ?genitree . }  OPTIONAL { ?id nbf:yo1853 ?yo1853 . }  OPTIONAL { ?idorg (owl:sameAs*|^owl:sameAs+)/schema:relatedLink ?kansallisbiografia . }  OPTIONAL { ?idorg (owl:sameAs*|^owl:sameAs+)/dct:source/skos:prefLabel ?source . }  OPTIONAL { ?id foaf:focus ?prs .   \t\tOPTIONAL { ?prs ^crm:P98_brought_into_life ?bir .   \t\t\tOPTIONAL { ?bir nbf:place ?birth__id . ?birth__id skos:prefLabel ?birth__label }   \t\t\tOPTIONAL { ?bir nbf:time/skos:prefLabel ?birthDate }\t\t}   \t\tOPTIONAL { ?prs ^crm:P100_was_death_of ?dea . \t\t\tOPTIONAL { ?dea nbf:time/skos:prefLabel ?deathDate }  \t\t\tOPTIONAL { ?dea nbf:place ?death__id . ?death__id skos:prefLabel ?death__label }\t\t}   \t\tOPTIONAL { ?prs nbf:image [ schema:image ?images ; dct:source ?is ] \t\t\tOPTIONAL { ?is skos:prefLabel ?il } \t\t\tBIND (COALESCE(?il, ?is) AS ?imagesources ) \t    }  \t\tOPTIONAL { ?prs ^bioc:inheres_in ?occupation_id .   \t\t\t?occupation_id a nbf:Occupation ; skos:prefLabel ?occupation }  \t\tOPTIONAL { ?prs nbf:has_category ?category . }  } }",p='SELECT DISTINCT ?type (?relative__id AS ?id2) ?name  WHERE { <RESULT_SET>    VALUES (?class ?order) {     ( rels:Father 0)     ( rels:Mother 1)     ( rels:Parent 2)     ( rels:Spouse 3)     ( rels:Husband 3)     ( rels:Wife 3)     ( rels:Child 4)     ( rels:Daughter 4)     ( rels:Son 4 ) }    { ?id bioc:has_family_relation [          bioc:inheres_in ?rel ;         a ?class ;         a/skos:prefLabel ?type ] .    } UNION    { ?rel bioc:has_family_relation [          bioc:inheres_in ?id ;          a ?class ;         bioc:inverse_role/skos:prefLabel ?type ] .    }    FILTER (LANG(?type)="fi")    ?rel owl:sameAs* ?relative__id .    FILTER NOT EXISTS { ?relative__id owl:sameAs [] }    ?relative__id skosxl:prefLabel ?relative__label .    OPTIONAL { ?relative__label schema:familyName ?relative__familyName }    OPTIONAL { ?relative__label schema:givenName ?relative__givenName }    BIND (REPLACE(CONCAT( COALESCE(?relative__givenName,"") ," ", COALESCE(?relative__familyName,"")),"[(][^)]+[)]\\\\s*","") AS ?name)    OPTIONAL { ?relative__id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime } } ORDER BY ?order ?btime ',d="SELECT DISTINCT * WHERE { { <RESULT_SET> } ?id owl:sameAs*|^owl:sameAs ?prs . ?prs foaf:focus/nbf:has_biography ?bio .  OPTIONAL { ?bio dct:source ?source . ?source skos:prefLabel ?database }} ORDER BY str(?source)",u='SELECT DISTINCT (GROUP_CONCAT(DISTINCT(?prs); separator=",") as ?people) (COUNT(DISTINCT ?prs) AS ?count) WHERE {   { <RESULT_SET> }   ?dst a nbf:Distance ;         bioc:relates_to ?id, ?prs ;         nbf:value ?value .   FILTER (?prs!=?id)  } ORDER BY DESC(?value) LIMIT 16 ',f='SELECT DISTINCT (GROUP_CONCAT(DISTINCT(?author); separator=",") as ?people) (COUNT(DISTINCT ?id) AS ?count) WHERE {  <RESULT_SET>  ?id owl:sameAs*|^owl:sameAs ?prs .   ?prs foaf:focus/nbf:has_biography/schema:author ?author . }  ',m='SELECT (GROUP_CONCAT(DISTINCT(?id); separator=",") as ?people) (COUNT(DISTINCT ?id) AS ?count) WHERE {  {   SELECT DISTINCT ?author ?id2 ?prs2     WHERE {         <RESULT_SET>         ?id2 owl:sameAs*|^owl:sameAs ?prs2 .         ?prs2 foaf:focus/nbf:has_biography/nbf:authors ?author .     }   }   ?prs foaf:focus/nbf:has_biography/nbf:authors ?author .   ?prs owl:sameAs* ?id .   FILTER NOT EXISTS {?id owl:sameAs []}   FILTER (?id != ?prs2 && ?id != ?id2) } ',g='SELECT DISTINCT (GROUP_CONCAT(DISTINCT(?id); separator=",") as ?people) (COUNT(DISTINCT ?id) AS ?count) WHERE   { <RESULT_SET>   ?id foaf:focus/nbf:has_biography/schema:author ?author .   } ',h='SELECT (GROUP_CONCAT(DISTINCT(?id); separator=",") as ?people) (COUNT(DISTINCT ?id) AS ?count) WHERE {  <RESULT_SET>   { ?id2 nbf:in_bio ?id }   UNION    { ?id nbf:refers/nbf:target ?id2 }   FILTER (?id!=?id2)  }',v='SELECT (GROUP_CONCAT(DISTINCT(?id); separator=",") as ?people) (COUNT(DISTINCT ?id) AS ?count) WHERE {    <RESULT_SET>   { ?id nbf:in_bio ?id2 ;         owl:sameAs*/foaf:focus/nbf:has_biography [] }   UNION    { ?id2 nbf:refers/nbf:target ?id .     ?id owl:sameAs*/foaf:focus/nbf:has_biography [] }   FILTER (?id!=?id2) } ',b="SELECT * WHERE { ?x ?y ?z } LIMIT 1 ",k={endpointUrl:s,usePost:!0},w=new n(k,{mapper:l,queryTemplate:' SELECT DISTINCT * WHERE {  {   <RESULT_SET>   }  FILTER not exists { ?id owl:sameAs [] }  ?id skosxl:prefLabel ?plabel .   \tOPTIONAL { ?plabel schema:givenName ?givenName . }  \tOPTIONAL { ?plabel schema:familyName ?familyName . }  OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan .  }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:fennica ?fennica . }  OPTIONAL { ?id nbf:warsampo ?warsampo . }  OPTIONAL { ?id nbf:norssi ?norssi . }  OPTIONAL { ?id nbf:genicom ?genicom . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:genitree ?genitree . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id nbf:kirjasampo ?kirjasampo . }  OPTIONAL { ?id nbf:yo1853 ?yo1853 . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { ?id foaf:focus ?prs .   \t\tOPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:place/skos:prefLabel ?birthPlace }   \t\tOPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:time/skos:prefLabel ?birthDate . }  \t\tOPTIONAL { ?prs ^crm:P100_was_death_of/nbf:time/skos:prefLabel ?deathDate . }  \t\tOPTIONAL { ?prs ^crm:P100_was_death_of/nbf:place/skos:prefLabel ?deathPlace }  \t\tOPTIONAL { ?prs schema:gender ?gender . }  \t\tOPTIONAL { ?prs nbf:image [ schema:image ?images ; dct:source ?imagesources ] }  \t\tOPTIONAL { ?prs ^bioc:inheres_in ?occupation_id .   \t\t\t?occupation_id a nbf:Occupation ; skos:prefLabel ?occupation   \t\t\tOPTIONAL { ?occupation_id nbf:related_company ?company . }\t\t}  \t\tOPTIONAL { ?prs nbf:has_category ?category . }  \t\tOPTIONAL { ?prs nbf:has_biography ?bio .   \t\t   OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?lead_paragraph ; nbf:id "0"^^xsd:integer  ] }  \t\t} } }',prefixes:r,paging:!0,pagesPerQuery:2}),y=new o(k,l)}angular.module("facetApp").service("nbfService",e),e.$inject=["$q","$location","_","facetService","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i){this.getEvents=function(t){/^p[0-9]+$/.test(t)&&(t="http://ldf.fi/nbf/"+t);var a="VALUES ?idorg { <"+t+"> } . ?idorg owl:sameAs* ?pc . ",i=n+s.replace(/<RESULT_SET>/g,a);return o.getObjects(i).then(function(t){return t.length?t:e.reject("Henkilöllä ei ole kartalla näytettäviä tapahtumia.")})};var n=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",s='SELECT DISTINCT ?givenName ?familyName ?relative ?class ?id ?time__start ?time__end ?time__label ?time__span  ?label ?place__uri ?place__latitude ?place__longitude ?place__name   WHERE {   {   { <RESULT_SET> }      ?pc a nbf:PersonConcept ;              foaf:focus ?prs ;   \t\t       skosxl:prefLabel ?ilabel .      { ?id crm:P100_was_death_of ?prs . }   UNION   { ?id crm:P98_brought_into_life ?prs . }   UNION   { ?id bioc:inheres_in ?prs . }     ?id a/skos:prefLabel ?class .    FILTER (lang(?class)="en")      ?id nbf:time ?time . \t\t   OPTIONAL { ?time gvp:estStart ?time__start. }   \t\t   OPTIONAL { ?time gvp:estEnd ?time__end. }   \t\t   OPTIONAL { ?time skos:prefLabel ?time__label. }         BIND ( CONCAT(       IF(bound(?time__start),str(year(?time__start)),""),       "-",       IF(bound(?time__end),str(year(?time__end)),"")     ) AS ?time__span)      OPTIONAL { ?id skos:prefLabel ?label }      OPTIONAL { ?id nbf:place ?place__uri .     \t     ?place__uri geo:lat ?place__latitude ;                             geo:long ?place__longitude  ;    \t\t                 skos:prefLabel ?place__name .  }        OPTIONAL { ?ilabel schema:givenName ?givenName }   OPTIONAL { ?ilabel schema:familyName ?familyName }   } UNION {       { <RESULT_SET> }      ?pc a nbf:PersonConcept ;       bioc:has_family_relation ?id ;       skosxl:prefLabel ?ilabel .         ?id bioc:inheres_in/owl:sameAs* ?relative .   FILTER NOT EXISTS { ?relative owl:sameAs [] }      OPTIONAL { ?ilabel schema:givenName ?givenName }   OPTIONAL { ?ilabel schema:familyName ?familyName }      ?id a/skos:prefLabel ?class .    FILTER (lang(?class)="en")     ?id nbf:time ?time . \t\t   OPTIONAL { ?time gvp:estStart ?time__start. }   \t\t   OPTIONAL { ?time gvp:estEnd ?time__end. }   \t\t   OPTIONAL { ?time skos:prefLabel ?time__label. }   \t       BIND ( CONCAT(       IF(bound(?time__start),str(year(?time__start)),""),       "-",       IF(bound(?time__end),str(year(?time__end)),"")     ) AS ?time__span)     OPTIONAL { ?id skos:prefLabel ?label }     OPTIONAL {     VALUES ?class { "Child"@en "Son"@en "Daughter"@en  }   \t?relative foaf:focus/^crm:P98_brought_into_life/nbf:place ?place__uri .    ?place__uri geo:lat ?place__latitude ;                 geo:long ?place__longitude  ;                 skos:prefLabel ?place__name .  }   } } ORDER BY ?time__start DESC(?time__end) ',o=new a({endpointUrl:t,usePost:!0},i)}angular.module("facetApp").service("mapService",e),e.$inject=["$q","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s){var o=this;o.changed=c,o.clear=function(){o.facet.clear(),r()},o.enableFacet=function(){o.facet.enable()},o.disableFacet=function(){o.facet.disable(),r()},o.isFacetEnabled=function(){if(!o.facet)return!1;return o.facet.isEnabled()};var l=e.$watch("options",function(a){var r;a&&(r=e.$on(n,function(a,i){var n=t.cloneDeep(e.options);n.initial=i.facets,n.update=c,o.facet=new s(n),r()}),e.$emit(i),l())});function r(){var t={id:o.facet.facetId,constraint:o.facet.getConstraint(),value:o.facet.getSelectedValue(),priority:o.facet.getPriority()};e.$emit(a,t)}function c(){r()}}function t(e){return t.prototype.getConstraint=function(){var e=this.slider.minValue,t=this.slider.maxValue,a="?slider_"+this.internalId;return"?id <PREDICATE> <OBJ> . FILTER (<STARTYEAR><=year(<OBJ>) && year(<OBJ>)<=<ENDYEAR>) ".replace(/<OBJ>/g,a).replace(/<PREDICATE>/g,this.predicate).replace("<STARTYEAR>",e).replace("<ENDYEAR>",t)},t.prototype.getPriority=function(){return this.config.priority},t.prototype.getPreferredLang=function(){return this.config.preferredLang},t.prototype.disable=function(){this.selectedValue=void 0,this._isEnabled=!1},t.prototype.enable=function(){this._isEnabled=!0},t.prototype.clear=function(){},t.prototype.isEnabled=function(){return this._isEnabled},t.prototype.getSelectedValue=function(){return{min:this.slider.minValue,max:this.slider.maxValue}},t;function t(t){this.config=angular.extend({},{preferredLang:"fi"},t),this.name=this.config.name,this.facetId=this.config.facetId,this.predicate=this.config.predicate,this.config.enabled?this.enable():this.disable(),this.internalId=e.uniqueId();var a=parseInt(this.config.min)||200,i=parseInt(this.config.max)||(new Date).getFullYear();this.slider={minValue:a,maxValue:i,options:{floor:a,ceil:i,step:10,draggableRange:!0,onEnd:this.config.update}};var n=e.get(t,"initial."+this.facetId+".value");n&&(this._isEnabled=!0,this.slider.minValue=n.min,this.slider.maxValue=n.max)}}angular.module("seco.facetedSearch").factory("SliderFacet",t).controller("SliderFacetController",e).directive("secoSliderFacet",function(){return{restrict:"E",scope:{options:"="},controller:"SliderFacetController",controllerAs:"vm",templateUrl:"views/sliderFacet.directive.html"}}),e.$inject=["$scope","_","EVENT_FACET_CHANGED","EVENT_REQUEST_CONSTRAINTS","EVENT_INITIAL_CONSTRAINTS","SliderFacet"],t.$inject=["_"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){this.getResults=function(e,t,a){var i=(t[0]?"( crm:P98_brought_into_life nbf:Birth 0) ":"")+(t[1]?"( crm:P100_was_death_of nbf:Death 1) ":"")+(t[2]?"( bioc:inheres_in nbf:Career 2 ) ":"")+(t[3]?"( bioc:inheres_in nbf:Product 3 ) ":"")+(t[4]?"( bioc:inheres_in nbf:Honour 4 ) ":""),n=r+c.replace("<RESULT_SET>",e.constraint.join(" ")).replace("<VALUES>",i).replace("<LIMIT>",a);return f.getObjectsNoGrouping(n)},this.getResults2=function(e,t){var a=r+p.replace("<RESULT_SET>",e.constraint.join(" ")).replace("<LIMIT>",t);return f.getObjectsNoGrouping(a)},this.getResults3=function(e,t){var a="SELECT ?evt__lat ?evt__long (COUNT(?prs) AS ?count) ?type WHERE {     <RESULT_SET>            ?id foaf:focus ?prs .   VALUES (?prop ?eclass ?type) { "+(t[0]?"( crm:P98_brought_into_life nbf:Birth 0) ":"")+(t[1]?"( crm:P100_was_death_of nbf:Death 1) ":"")+(t[2]?"( bioc:inheres_in nbf:Career 2 ) ":"")+(t[3]?"( bioc:inheres_in nbf:Product 3 ) ":"")+(t[4]?"( bioc:inheres_in nbf:Honour 4 ) ":"")+"  }   ?evt__id ?prop ?prs ;      a ?eclass ;    \tnbf:place [        \t\tgeo:lat ?evt__lat ;       \t\tgeo:long ?evt__long    ] . } GROUP BY ?evt__lat ?evt__long ?evt__class ?type HAVING(?count>0) LIMIT 500 ",i=r+a.replace("<RESULT_SET>",e.constraint.join(" "));return f.getObjectsNoGrouping(i)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return u};var r=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",c='SELECT * WHERE {   { SELECT ?place__uri (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(DISTINCT ?url; separator=",") AS ?person__ids) ?type WHERE {      { SELECT ?id ?id2 WHERE { <RESULT_SET> ?id owl:sameAs* ?id2 . FILTER NOT EXISTS { ?id2 owl:sameAs [] } } LIMIT <LIMIT> } FILTER(BOUND(?id))      VALUES (?prop ?eclass ?type) { <VALUES> }     ?id foaf:focus ?prs .     ?evt__id ?prop ?prs ;           a ?eclass ;            nbf:place ?place__uri .   BIND (replace(str(?id2),"http://ldf.fi/nbf/","") AS ?url)    } GROUP BY ?place__uri ?type ORDER BY DESC(?count)   }   FILTER (?count>0)   ?place__uri geo:lat ?place__latitude ;         \tgeo:long ?place__longitude ;     \t\tskos:prefLabel ?place__label .   FILTER (lang(?place__label)="fi") }  ',p='SELECT * WHERE {   {   SELECT DISTINCT ?birth__place ?death__place (COUNT(distinct ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?person__ids) WHERE {     <RESULT_SET>     ?id owl:sameAs* ?id2 .     FILTER NOT EXISTS { ?id2 owl:sameAs [] } .     ?id foaf:focus ?prs .      ?birth__id crm:P98_brought_into_life ?prs ;               nbf:place ?birth__place .      ?death__id crm:P100_was_death_of ?prs ;                nbf:place ?death__place .            BIND (replace(str(?id2),"http://ldf.fi/nbf/","") AS ?url)    } GROUP BY ?birth__place ?death__place ORDER BY DESC(?count) LIMIT <LIMIT>  }   FILTER (?count>0)   ?birth__place geo:lat ?birth__latitude ;               geo:long ?birth__longitude ;               skos:prefLabel ?birth__label .   FILTER (LANG(?birth__label)="fi")      ?death__place geo:lat ?death__latitude ;               geo:long ?death__longitude ;               skos:prefLabel ?death__label .   FILTER (LANG(?death__label)="fi") } ORDER BY ?count ',d={endpointUrl:n,usePost:!0},u={endpointUrl:d.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},f=(new i(d,{mapper:l,queryTemplate:c,prefixes:r,paging:!1,pagesPerQuery:1}),new o(d,l))}angular.module("facetApp").service("groupmapService",e),e.$inject=["$q","$location","_","FacetResultHandler","SPARQL_ENDPOINT_URL","mapfacetService","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i){return{link:function(e,i){return t("navbar-fi.html").then(function(e){return i.html(e),t("views/subnavbar.html")}).then(function(t){return angular.element("#subnav").html(t),a(i.contents())(e)})},controller:function(){this.showHelp=function(){i.open({templateUrl:"views/help.html",size:"lg"})}},controllerAs:"vm"}}angular.module("facetApp").directive("wsNavbar",e),e.$inject=["$location","$templateRequest","$compile","$uibModal"]}(),function(){"use strict";function e(e,t,a){var i=this;i.login=function(){return a.login(i.un,i.pw).then(function(a){if(a)return e.transitionTo("portal",t,{reload:!0,inherit:!1,notify:!0});i.error="Kirjautuminen epäonnistui"})}}angular.module("facetApp").controller("LoginController",e),e.$inject=["$state","$stateParams","loginService"]}(),function(){"use strict";function e(e,t,a,i,n,s){var o=this;function l(e){o.isLoadingResults=!1,o.error=e}o.openPage=function(){a.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return o.person}}})},function(){var a=t.personId;/^p[0-9]+$/.test(a)&&(a="http://ldf.fi/nbf/"+a);n.getPerson(a).then(function(t){o.person=t;var i=function(e){var t=e,a=[];t.kansallisbiografia&&(Array.isArray(t.kansallisbiografia)||(t.kansallisbiografia=[t.kansallisbiografia]),t.kansallisbiografia.forEach(function(e,t){0==t?a.push({url:e,label:"Biografiakeskuksen artikkeli",tab:"sks"}):a.push({url:e,label:"Biografiakeskuksen artikkeli "+(t+1),tab:"sks"+(t+1)})}));t.genicom&&a.push({url:t.genicom,label:"Geni.com, kotisivu",tab:"genikotisivu"});t.genitree&&a.push({url:t.genitree,label:"Geni.com, sukupuu",tab:"genisukupuu"});t.norssi&&a.push({url:"https://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F"+t.norssi,label:"Norssit",tab:"norssit"});t.kirjasampo&&a.push({url:t.kirjasampo,label:"Kirjasampo",tab:"kirjasampo"});t.warsampo&&a.push({url:"https://www.sotasampo.fi/fi/persons/?uri="+t.warsampo,label:"Sotasampo",tab:"warsampo"});t.wikipedia&&a.push({url:t.wikipedia,label:"Wikipedia",tab:"wikipedia"});t.yo1853&&a.push({url:"https://ylioppilasmatrikkeli.helsinki.fi/1853-1899/henkilo.php?id="+t.yo1853,label:"Ylioppilasmatrikkeli 1853–1899",tab:"yo1853"});return a=a.map(function(e){return Array.isArray(e.url)&&(e.url=e.url[0]),e.url=e.url.replace(/^http[s]*:/,""),e})}(t);return i.length&&(o.person.externalLinks=i),n.getBios(a).then(function(t){if(t.length){o.person.bios=t;var a=e.search();a&&a.tab?o.setTab(a.tab):o.setTab(0)}}),n.getRelatives(a).then(function(e){e.length&&(o.person.relative=e)}),n.getAuthoredBios(a).then(function(e){e.length&&e[0].people&&(o.authoredBios={people:e[0].people,count:e[0].count})}),n.getSimilar(a).then(function(e){e.length&&e[0].people&&(o.similar={people:e[0].people,count:e[0].count})}),n.getAuthors(a).then(function(e){e.length&&e[0].people&&(o.authors={people:e[0].people,count:e[0].count})}),n.getByAuthor(a).then(function(e){e.length&&e[0].people&&(o.sameAuthor={people:e[0].people,count:e[0].count})}),n.getByReferences(a).then(function(e){e.length&&e[0].people&&(o.references={people:e[0].people,count:e[0].count})}),n.getReferences(a).then(function(e){e.length&&e[0].people&&(o.referenced={people:e[0].people,count:e[0].count})}),t}).catch(l)}(),o.setTab=function(t){o.tab=""+t,"0"!=t&&e.search("tab",t)},o.isSet=function(e){return o.tab===""+e}}angular.module("facetApp").controller("DetailController",e),e.$inject=["$location","$stateParams","$uibModal","_","nbfService","$sce"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.openPage=function(e){a.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return e}}})},c.removeFacetSelections=function(){t.reload()},c.sortBy=function(e){return s.updateSortBy(e),f({constraint:c.previousSelections})},c.getSortClass=s.getSortClass;var p=e.$on("sf-initial-constraints",function(e,t){u(e,t),p()});function d(e){return c.isLoadingResults=!0,c.pager.getPage(e.page()-1,e.count()).then(function(e){return c.pager.getTotalCount().then(function(t){return c.tableParams.total(t),e}).then(function(e){return c.isLoadingResults=!1,e})})}function u(e,t){return r.updateUrlParams(t),c.previousSelections=i.clone(t.constraint),f(t)}function f(e){c.isLoadingResults=!0,s.getResults(e).then(function(e){c.pager=e,c.tableParams?(c.tableParams.page(1),c.tableParams.reload()):c.tableParams=new o({count:n},{getData:d})})}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){var a;c.facets=t,c.facetOptions=((a=s.getFacetOptions()).initialState=r.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=e,c.handler=new l(c.facetOptions)})}angular.module("facetApp").controller("TableController",e),e.$inject=["$scope","$state","$uibModal","_","RESULTS_PER_PAGE","nbfService","NgTableParams","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i){var n=this;n.openPage=function(){t.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return n.person}}})},n.map={center:{latitude:62,longitude:24},zoom:6},n.markers=[],n.focusEvent=function(e){n.currentEvent=e.id+": "+e.label,e.markers.forEach(function(e){e.options.icon.strokeWeight=4,e.options.zIndex+=100})},n.unfocusEvent=function(e){n.currentEvent=".",e.markers.forEach(function(e){e.options.icon.strokeWeight=1,e.options.zIndex-=100})},i.getEvents(e.personId).then(function(e){return n.currentEvent=".",n.events=e,e.length&&(n.person=e[0]),n.events=function(e,t){var a=(new Date).getFullYear(),i=!1,n=0;t.min_time=a,t.max_time=0;var s={},r=new google.maps.LatLngBounds;e.forEach(function(e){e.place&&e.place.uri&&(["uri","latitude","longitude","name"].forEach(function(t){e.place[t]&&e.place[t].constructor!==Array&&(e.place[t]=[e.place[t]])}),e.place.uri.forEach(function(t){s.hasOwnProperty(t)||(s[t]={count:0,latitude:e.place.latitude,longitude:e.place.longitude,type:e.class}),s[t].count+=1}))});var c=[[],[],[],[]];if(e.forEach(function(e){e.y=0,e.r=1,e.markers=[],e.blobs=[],e.time.span.constructor!==Array&&(e.time.span=[e.time.span]),e.time.span.forEach(function(a){var i=a.split("-"),n={};""!=i[0]&&(i[0]=parseInt(i[0]),i[0]<t.min_time&&(t.min_time=i[0]),t.max_time<i[0]&&(t.max_time=i[0]),n.estStart=i[0]),""!=i[1]&&(i[1]=parseInt(i[1]),i[1]<t.min_time&&(t.min_time=i[1]),t.max_time<i[1]&&(t.max_time=i[1]),n.estEnd=i[1]),e.blobs.push(n)}),e.label||(e.label=""),e.class||(e.class="event"),e.class=e.class.toLowerCase();var a=0;switch(e.class){case"death":i=!0,e.label="Kuollut "+e.label,e.r=1.5;break;case"birth":e.label="Syntynyt "+e.label,e.place&&e.place.latitude&&(t.map.center={latitude:e.place.latitude[0],longitude:e.place.longitude[0]}),e.r=1.5,t.min_time<e.blobs[0].estStart&&(t.min_time=e.blobs[0].estStart);break;case"spouse":case"child":e.relative&&(e.relativelink=e.relative),e.label=e.label+", "+e.time.label;break;case"career":e.y=5,a=1;break;case"product":e.y=10,a=2;break;case"honour":e.y=15,a=3;break;default:e.y=5,e.class="event",a=1}if(c[a].push(e),e.id=++n,e.place&&e.place.latitude)for(var l=0;l<e.place.latitude.length;l++){var p=e.place.uri[l]&&s[e.place.uri[l]]&&s[e.place.uri[l]].count?15*Math.sqrt(s[e.place.uri[l]].count):15,d=o(e.place.latitude[l],e.place.longitude[l],e.id,e.class,p,e.place.name[l],e.place.uri[l]);e.markers.push(d),t.markers.push(d),r.extend({lat:parseInt(e.place.latitude[l]),lng:parseInt(e.place.longitude[l])})}}),c.forEach(function(e){(function(e){for(var t={},a=e.length,i=0;i<a;i++)e[i].blobs.forEach(function(e){for(var a=e.estStart?e.estStart:e.estEnd-3,n=e.estEnd?e.estEnd:a+3,s=a;s<=n;s++)t[s]=i});var n=Array(a).fill(!1);for(var s in t)n[t[s]]=!0;for(var o=[],i=0;i<a;i++)n[i]||o.push(i);return o})(e).forEach(function(t){e[t].y+=2.5})}),i||(t.max_time+=15),t.max_time<=t.min_time&&(t.max_time=t.min_time+75),t.max_time>t.min_time+150&&(t.max_time=t.min_time+150),t.max_time>a&&(t.max_time=a),e.forEach(function(e){e.path="";var a=.1*Math.random();e.blobs.forEach(function(i){var n=i.estStart?l(i.estStart,t.min_time,t.max_time)+a:void 0,s=i.estEnd?l(i.estEnd,t.min_time,t.max_time)+a:void 0;n?s?e.path+="M"+n+","+(e.y-e.r)+" a"+e.r+","+e.r+",0,0,0,0,"+2*e.r+" H"+s+" a"+e.r+","+e.r+",0,0,0,0,-"+2*e.r+" Z":(s=n+3,e.path+="M"+s+","+(e.y-e.r)+" H"+n+" a"+e.r+","+e.r+",0,0,0,0,"+2*e.r+" H"+s):(n=s-3,e.path+="M"+n+","+(e.y+e.r)+" H"+s+" a"+e.r+","+e.r+",0,0,0,0,-"+2*e.r+" H"+n)}),e.blobs=[]}),t.markers.length<1)t.map={center:{latitude:64,longitude:18},zoom:4};else try{var p=r.getNorthEast(),d=r.getSouthWest(),u=Math.max(p.lat()-d.lat(),2*(p.lng()-d.lng())),f=2;f=u<75?5:u<100?4:u<125?3:2,t.map.center={latitude:r.getCenter().lat(),longitude:r.getCenter().lng()},t.map.zoom=f}catch(e){t.map={center:{latitude:64,longitude:18},zoom:4}}return e}(e,n),n.viewBox="1930,-10,120,27",function(e){for(var t=e.min_time,a=e.max_time,i=[],n=[{x:-2.5,y:0,content:"Elinkaari"},{x:-2.5,y:5,content:"Ura"},{x:-2.5,y:10,content:"Teokset"},{x:-2.5,y:15,content:"Kunniamaininnat"}],s=10*Math.ceil(t/10);s<a;s+=10){var o=l(s,t,a);i.push({x1:o,x2:o,y1:0,y2:15}),n.push({x:o+1,y:-2,content:""+s})}for(var r=0;r<20;r+=5)i.push({x1:l(t,t,a),x2:l(a,t,a),y1:r,y2:r});e.mainline={lines:i,texts:n}}(n),e}).catch(r);var s=1;function o(e,t,a,i,n,o,l){n||(n=15);return{uri:l,latitude:e,longitude:t,id:s++,options:{icon:{path:"M-"+n+" 0 A "+n+","+n+", 0 ,1, 1,"+n+",0 A"+n+","+n+",0,1,1,-"+n+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:{death:"#ff4141",birth:"#777fff",spouse:"#c3b981",child:"#7f6780",career:"#999999",product:"#83d236",honour:"#ce5c00",event:"#999999"}[i],fillOpacity:.6,strokeOpacity:.5,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},zIndex:a,title:o,optimized:!1,label:{text:""+a,fontSize:"14px",fontFamily:'"Courier New",Courier,Monospace',color:"black"}}}}function l(e,t,a){return e-t}function r(e){n.isLoadingResults=!1,n.error=e}}angular.module("facetApp").controller("MapController",e),e.$inject=["$stateParams","$uibModal","_","mapService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.right=!1,c.map={center:{latitude:62,longitude:24},zoom:6},c.markers=[],c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.EVENTTYPES=[{type:"0",check:!0,color:"hsl(222, 90%, 60%)",label:"Syntymä",label2:"syntyneet",tooltip:"Henkilöiden syntymäpaikat kartalla"},{type:"1",check:!0,color:"hsl(0, 90%, 60%)",label:"Kuolema",label2:"kuolleet",tooltip:"Henkilöiden kuolinpaikat kartalla"},{type:"2",check:!1,color:"hsl(0, 0%, 45%)",label:"Ura",label2:"ura",tooltip:"Henkilöiden opiskelu- ja työpaikat"},{type:"3",check:!1,color:"hsl(120, 90%, 40%)",label:"Teokset",label2:"teokset",tooltip:"Paikat, joissa on henkilöihin liittyviä teoksia"},{type:"4",check:!1,color:"hsl(180, 90%, 40%)",label:"Kunniamaininnat",label2:"kunniamaininnat",tooltip:"Kunniamainintoihin liittyvät paikat"}],c.change=function(){c.EVENTTYPES.every(function(e){return!e.check})&&(c.EVENTTYPES[0].check=!0),t.search(c.right?"limit2":"limit",c.searchlimit.value);var e=c.EVENTTYPES.map(function(e){return e.check?1:0}).join(",");t.search(c.right?"events2":"events",e),f({constraint:c.previousSelections})},c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"events2":"events"]&&e[a].split(",").forEach(function(e,t){c.EVENTTYPES[t].check="0"!=e}),e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}},c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),f(t)}function f(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();t;var a=c.EVENTTYPES.map(function(e){return e.check});return s.getResults(e,a,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",c.events=function(e,t){t.markers=[],e.forEach(function(e,a){var i=function(e,t,a,i,n,s,o,l){var r=5*Math.sqrt(s),c=g(o,n,s);return{count:s,latitude:t,longitude:a,id:i,options:{icon:{path:"M-"+r+" 0 A "+r+","+r+", 0 ,1, 1,"+r+",0 A"+r+","+r+",0,1,1,-"+r+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:e.EVENTTYPES[parseInt(n)].color,fillOpacity:.6,strokeOpacity:.2,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},optimized:!0,title:c},onClick:function(){e.popuptitle=c,e.people=l,e.showForm()}}}(t,e.place.latitude,e.place.longitude,a,e.type,e.count,e.place.label,e.person.ids);t.markers.push(i)});var a=new google.maps.LatLngBounds,i=document.getElementById("ui-gmap-google-map");i&&i.fitBounds&&i.fitBounds(a);return e}(e,c))}).catch(m)}function m(e){c.isLoadingResults=!1,c.error=e}function g(e,t,a){return e+", "+c.EVENTTYPES[parseInt(t)].label2+" ("+a+")"}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=l.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("GroupmapController",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.right=!0,c.map={center:{latitude:62,longitude:24},zoom:6},c.markers=[],c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.EVENTTYPES=[{type:"0",check:!0,color:"hsl(222, 90%, 60%)",label:"Syntymä",label2:"syntyneet",tooltip:"Henkilöiden syntymäpaikat kartalla"},{type:"1",check:!0,color:"hsl(0, 90%, 60%)",label:"Kuolema",label2:"kuolleet",tooltip:"Henkilöiden kuolinpaikat kartalla"},{type:"2",check:!1,color:"hsl(0, 0%, 45%)",label:"Ura",label2:"ura",tooltip:"Henkilöiden opiskelu- ja työpaikat"},{type:"3",check:!1,color:"hsl(120, 90%, 40%)",label:"Teokset",label2:"teokset",tooltip:"Paikat, joissa on henkilöihin liittyviä teoksia"},{type:"4",check:!1,color:"hsl(180, 90%, 40%)",label:"Kunniamaininnat",label2:"kunniamaininnat",tooltip:"Kunniamainintoihin liittyvät paikat"}],c.change=function(){c.EVENTTYPES.every(function(e){return!e.check})&&(c.EVENTTYPES[0].check=!0),t.search(c.right?"limit2":"limit",c.searchlimit.value);var e=c.EVENTTYPES.map(function(e){return e.check?1:0}).join(",");t.search(c.right?"events2":"events",e),f({constraint:c.previousSelections})},c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"events2":"events"]&&e[a].split(",").forEach(function(e,t){c.EVENTTYPES[t].check="0"!=e}),e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}},c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),f(t)}function f(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();t;var a=c.EVENTTYPES.map(function(e){return e.check});return s.getResults(e,a,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",c.events=function(e,t){t.markers=[],e.forEach(function(e,a){var i=function(e,t,a,i,n,s,o,l){var r=5*Math.sqrt(s),c=g(o,n,s);return{count:s,latitude:t,longitude:a,id:i,options:{icon:{path:"M-"+r+" 0 A "+r+","+r+", 0 ,1, 1,"+r+",0 A"+r+","+r+",0,1,1,-"+r+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:e.EVENTTYPES[parseInt(n)].color,fillOpacity:.6,strokeOpacity:.2,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},optimized:!0,title:c},onClick:function(){e.popuptitle=c,e.people=l,e.showForm()}}}(t,e.place.latitude,e.place.longitude,a,e.type,e.count,e.place.label,e.person.ids);t.markers.push(i)});var a=new google.maps.LatLngBounds,i=document.getElementById("ui-gmap-google-map");i&&i.fitBounds&&i.fitBounds(a);return e}(e,c))}).catch(m)}function m(e){c.isLoadingResults=!1,c.error=e}function g(e,t,a){return e+", "+c.EVENTTYPES[parseInt(t)].label2+" ("+a+")"}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=l.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("GroupmapControllerRight",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService2","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.right=!1,c.map={center:{latitude:62,longitude:24},zoom:6},c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.change=function(){t.search(c.right?"limit2":"limit",c.searchlimit.value),f({constraint:c.previousSelections})},c.message="",c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass,c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})};var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),f(t)}function f(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();return t,c.polylines=[],s.getResults2(e,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",function(e,t){var a=1,i=0,n=e[0].count,s=e[e.length-1].count;s!=n&&(i=1-(a=8/(s-n))*n);e.forEach(function(e){e.weight=a*e.count+i});var o=[],l=[];e.forEach(function(e){v(e,o,l)}),t.polylines=o,t.markers=l}(e,c))}).catch(m)}function m(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=l.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)}),c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}};var g=0,h=function(e,t){var a=new google.maps.LatLng(e.latitude,e.longitude),i=new google.maps.LatLng(t.latitude,t.longitude);return google.maps.geometry.spherical.interpolate(a,i,.5)};function v(e,t,a){Math.random();if(e.birth.label!=e.death.label){t.push({id:g++,path:[e.birth,e.death],events:{click:function(t){c.popuptitle="Syntymäpaikka "+e.birth.label+", kuolinpaikka "+e.death.label+" ("+e.count+")",c.people=e.person.ids,c.showForm()},mouseover:function(e){e.setOptions({strokeColor:"blue",strokeOpacity:1})},mouseout:function(e){e.setOptions({strokeColor:"rgb(203,231,226)",strokeOpacity:.03})}},stroke:{color:"rgb(203,231,226)",weight:6,opacity:.03},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:4}}]});var i=h(e.birth,e.death);t.push({id:g++,path:[e.birth,i],stroke:{color:"blue",weight:e.weight}}),t.push({id:g++,path:[i,e.death],stroke:{color:"red",weight:e.weight},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:e.weight}}]})}else{var n=8*Math.sqrt(e.weight);a.push({count:e.weight,latitude:e.birth.latitude,longitude:e.birth.longitude,id:g++,options:{icon:{path:"M-"+n+" 0 A "+n+","+n+", 0 ,1, 1,"+n+",0 A"+n+","+n+",0,1,1,-"+n+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:"red",strokeColor:"blue",fillOpacity:.6},optimized:!0,title:e.birth.label+": "+e.count},click:function(){c.popuptitle="Synnyin- ja kuolinpaikka "+e.birth.label+": "+e.count,c.people=e.person.ids,c.showForm()}})}}}angular.module("facetApp").controller("LifemapController",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.right=!0,c.map={center:{latitude:62,longitude:24},zoom:6},c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.change=function(){t.search(c.right?"limit2":"limit",c.searchlimit.value),f({constraint:c.previousSelections})},c.message="",c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass,c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})};var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),f(t)}function f(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();return t,c.polylines=[],s.getResults2(e,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",function(e,t){var a=1,i=0,n=e[0].count,s=e[e.length-1].count;s!=n&&(i=1-(a=8/(s-n))*n);e.forEach(function(e){e.weight=a*e.count+i});var o=[],l=[];e.forEach(function(e){v(e,o,l)}),t.polylines=o,t.markers=l}(e,c))}).catch(m)}function m(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=l.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)}),c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}};var g=0,h=function(e,t){var a=new google.maps.LatLng(e.latitude,e.longitude),i=new google.maps.LatLng(t.latitude,t.longitude);return google.maps.geometry.spherical.interpolate(a,i,.5)};function v(e,t,a){Math.random();if(e.birth.label!=e.death.label){t.push({id:g++,path:[e.birth,e.death],events:{click:function(t){c.popuptitle="Syntymäpaikka "+e.birth.label+", kuolinpaikka "+e.death.label+" ("+e.count+")",c.people=e.person.ids,c.showForm()},mouseover:function(e){e.setOptions({strokeColor:"blue",strokeOpacity:1})},mouseout:function(e){e.setOptions({strokeColor:"rgb(203,231,226)",strokeOpacity:.03})}},stroke:{color:"rgb(203,231,226)",weight:6,opacity:.03},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:4}}]});var i=h(e.birth,e.death);t.push({id:g++,path:[e.birth,i],stroke:{color:"blue",weight:e.weight}}),t.push({id:g++,path:[i,e.death],stroke:{color:"red",weight:e.weight},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:e.weight}}]})}else{var n=8*Math.sqrt(e.weight);a.push({count:e.weight,latitude:e.birth.latitude,longitude:e.birth.longitude,id:g++,options:{icon:{path:"M-"+n+" 0 A "+n+","+n+", 0 ,1, 1,"+n+",0 A"+n+","+n+",0,1,1,-"+n+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:"red",strokeColor:"blue",fillOpacity:.6},optimized:!0,title:e.birth.label+": "+e.count},click:function(){c.popuptitle="Synnyin- ja kuolinpaikka "+e.birth.label+": "+e.count,c.people=e.person.ids,c.showForm()}})}}}angular.module("facetApp").controller("LifemapControllerRight",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService2","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){var r,c,p=this;p.openPage=function(e){i.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return e}}})},p.nextPage=m,p.isScrollDisabled=function(){return p.isLoadingResults||r>c},p.removeFacetSelections=function(){a.reload()},p.sortBy=function(e){return s.updateSortBy(e),h({constraint:p.previousSelections})},p.getSortClass=s.getSortClass,p.people=[];var d,u,f=e.$on("sf-initial-constraints",function(e,t){g(e,t),f()});function m(){var e=n.uniqueId();d=e,p.isLoadingResults=!0,r++<=c?p.pager.getPage(r-1,24).then(function(t){e===d&&(p.people=p.people.concat(t),p.isLoadingResults=!1)}).catch(v):p.isLoadingResults=!1}function g(e,t){if(!p.previousSelections||!n.isEqual(t.constraint,p.previousSelections))return p.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),h(t)}function h(e){p.isLoadingResults=!0,p.people=[],p.error=void 0;var t=n.uniqueId();u=t,r=0,s.getResults(e).then(function(e){return e.getMaxPageNo().then(function(t){return[e,t]})}).then(function(e){if(u===t)return p.pager=e[0],c=e[1],p.isLoadingResults=!1,m()}).catch(v)}function v(e){p.isLoadingResults=!1,p.error=e}e.$on("sf-facet-constraints",g),s.getFacets().then(function(t){var a;p.facets=t,p.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),p.facetOptions.scope=e,p.handler=new o(p.facetOptions)})}angular.module("facetApp").controller("CardsController",e),e.$inject=["$scope","$location","$state","$uibModal","_","nbfService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getResults=function(a){var i=this,n=r.replace(/<RESULT_SET>/g,a.constraint.join(" "));return w.getObjectsNoGrouping(n).then(function(a){if(a.length>1e4)return e.reject({statusText:"Tulosjoukko on liian suuri. Ole hyvä ja rajaa tuloksia suodattimien avulla."});var n={},s=c.replace(/<DOC>/g,"<"+t.map(a,"id").join("> <")+">");return i.upos.forEach(function(e){n[e.key]=k.getObjectsNoGrouping(s.replace(/<UPOS>/g,e.key))}),e.all(n)})},this.getWordCount=function(e){var t={},a=p.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=w.getObjectsNoGrouping(a),console.log(t),t},this.getResultsTop10=function(e){var t=d.replace(/<RESULT_SET>/g,e.constraint.join(" "));return w.getObjectsNoGrouping(t)},this.getResultsBottom10=function(e){var t=u.replace(/<RESULT_SET>/g,e.constraint.join(" "));return w.getObjectsNoGrouping(t)},this.getResultsBottomCat=function(e){var t={},a=m.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=w.getObjectsNoGrouping(a),console.log(t),t},this.getResultsTopCat=function(e){var t={},a=f.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=w.getObjectsNoGrouping(a),console.log(t),t},this.getStatistics=function(e){var t=h.replace(/<RESULT_SET>/g,e.constraint.join(" "));return w.getObjectsNoGrouping(t)},this.getLenStatistics=function(e){var t=g.replace(/<RESULT_SET>/g,e.constraint.join(" "));return w.getObjectsNoGrouping(t)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return angular.copy(b)},this.upos=[{key:"VERB",label:"Verbi"},{key:"NOUN",label:"Substantiivi"},{key:"ADJ",label:"Adjektiivi"},{key:"PROPN",label:"Erisnimi"}];var l=" PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX conll: <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#>  PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",r=" SELECT DISTINCT ?id WHERE {  {     <RESULT_SET>   }  }",c=l+' SELECT DISTINCT ?lemma (COUNT(?lemma) AS ?count) {   VALUES ?doc { <DOC> }   ?word nif:structure/<http://ldf.fi/nbf/biography/data#docRef> ?doc .   ?word conll:UPOS "<UPOS>" .   ?word conll:LEMMA ?lemma .   FILTER(STRLEN(STR(?lemma))>2)   FILTER (regex(?lemma, "^[^.]*$")) .   FILTER (regex(?lemma, "^[^:]*$")) .   FILTER (regex(?lemma, "^[^;]*$")) .   FILTER (regex(?lemma, "^[^&]*$")) .   FILTER (regex(?lemma, "^[^,]*$")) .   FILTER (regex(?lemma, ".*(?<![.])$")) .  } GROUP BY ?lemma ORDER BY DESC(?count) LIMIT 50',p=l+" SELECT  (SUM(xsd:integer(?cnt)) AS ?count) (SUM(xsd:integer(?verb)) AS ?verbCount) (SUM(xsd:integer(?adj)) AS ?adjCount) (SUM(xsd:integer(?noun)) AS ?nounCount) (SUM(xsd:integer(?pnoun)) AS ?pnounCount) {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .   ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt ;      <http://ldf.fi/nbf/biography/data#verbCount> ?verb ;      <http://ldf.fi/nbf/biography/data#adjCount> ?adj ;      <http://ldf.fi/nbf/biography/data#nounCount> ?noun ;      <http://ldf.fi/nbf/biography/data#propnCount> ?pnoun . } ",d=l+" SELECT DISTINCT ?id ?name ?cnt {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } ORDER BY DESC(xsd:integer(?cnt)) LIMIT 10",u=l+" SELECT DISTINCT ?id ?name ?cnt {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } ORDER BY ASC(xsd:integer(?cnt)) LIMIT 10",f=l+" SELECT DISTINCT ?category (ROUND(SUM(xsd:integer(?cnt)) / COUNT(xsd:integer(?cnt))) AS ?count) (COUNT(xsd:integer(?cnt)) as ?lkm) {  {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?id foaf:focus/nbf:has_category ?cat .  ?cat skos:prefLabel ?category .  ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } GROUP BY ?category ORDER BY DESC(?count) LIMIT 10",m=l+" SELECT DISTINCT ?category (ROUND(SUM(xsd:integer(?cnt)) / COUNT(xsd:integer(?cnt))) AS ?count) (COUNT(xsd:integer(?cnt)) as ?lkm){  {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?id foaf:focus/nbf:has_category ?cat .  ?cat skos:prefLabel ?category .  ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } GROUP BY ?category ORDER BY ASC(?count) LIMIT 10",g=l+" SELECT DISTINCT ?year (ROUND(SUM(xsd:integer(?cnt)) / COUNT(xsd:integer(?cnt))) AS ?count) {   {     <RESULT_SET>   }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .   ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;       <http://ldf.fi/nbf/biography/data#wordCount> ?cnt .   BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ",h=l+" SELECT DISTINCT ?year (COUNT(distinct ?id) AS ?count) {   {     <RESULT_SET>   }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ",v={endpointUrl:n,usePost:!0},b={endpointUrl:v.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},k=new a({endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},o),w=new a(v,o)}angular.module("facetApp").service("nlpService",e),e.$inject=["$q","_","AdvancedSparqlService","FacetResultHandler","SPARQL_ENDPOINT_URL","mapfacetService","objectMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){var r=this;r.admiralFacet='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source4>","constraint":"?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source4>."}}',r.hasResults=function(){return i.keys(r.results).length>0},r.facetParam1='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source5>","constraint":" ?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source5> . "}}',r.facetParam2='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source4>","constraint":" ?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source4> . "}}',r.upos=s.upos,r.removeFacetSelections=function(){a.reload()},s.getFacets().then(function(e){var a;r.facets=e,r.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),r.facetOptions.scope=t,r.handler=new o(r.facetOptions)});var c,p=t.$on("sf-initial-constraints",function(e,t){d(e,t),p()});function d(t,a){if(!r.previousSelections||!i.isEqual(a.constraint,r.previousSelections))return r.previousSelections=i.clone(a.constraint),l.updateUrlParams(a),function(t){r.isLoadingResults=!0,r.isLoadingWordResults=!0,r.results=[],r.error=void 0;var a=i.uniqueId();return c=a,s.getStatistics(t).then(function(e){c===a&&function(e){n.charts.setOnLoadCallback(function(){var t=new n.visualization.DataTable,a=i.map(e,function(e){return parseInt(e.year)}),s=i.map(e,function(e){return[e.year,parseInt(e.count)]}),o={title:"SKS:n Biografiajakauma vuosikymmenittäin",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:a},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},l=new n.visualization.ColumnChart(document.getElementById("biography-chart"));t.addColumn("string","Vuosikymmen"),t.addColumn("number","Biografioita"),t.addRows(s),l.draw(t,o)})}(e)}).then(function(){return s.getLenStatistics(t).then(function(e){c===a&&(console.log(e),function(e){n.charts.setOnLoadCallback(function(){var t=new n.visualization.DataTable,a=i.map(e,function(e){return parseInt(e.year)}),s=i.map(e,function(e){return[e.year,parseInt(e.count)]}),o={title:"SKS:n Biografioiden keskimääräinen sanamääräjakauma vuosikymmenittäin",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:a},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},l=new n.visualization.ColumnChart(document.getElementById("biography-len-chart"));t.addColumn("string","Vuosikymmen"),t.addColumn("number","Biografioiden keskimääräinen sanamäärä"),t.addRows(s),l.draw(t,o)})}(e),r.isLoadingResults=!1)})}).then(function(){return s.getResultsTop10(t).then(function(e){c===a&&(r.resultsTop10=e)})}).then(function(){return s.getResultsBottom10(t).then(function(e){c===a&&(r.resultsBottom10=e)})}).then(function(){return s.getResultsBottomCat(t).then(function(e){c===a&&(r.resultsBotCat=e)})}).then(function(){return s.getResultsTopCat(t).then(function(e){c===a&&(r.resultsTopCat=e)})}).then(function(){return s.getWordCount(t).then(function(e){c===a&&(r.lemmaCount=e[0])})}).then(function(){return s.getResults(t).then(function(e){c===a&&(r.results=function(e){var t,a,i;for(t in console.log(r.lemmaCount.count),e){console.log(t),console.log(e[t]);var n="VERB"==(i=t)?r.lemmaCount.verbCount:"ADJ"==i?r.lemmaCount.adjCount:"NOUN"==i?r.lemmaCount.nounCount:"PROPN"==i?r.lemmaCount.pnounCount:(console.log("Unidentifiable pos-tag",i),r.lemmaCount.count);for(a in e[t])console.log(e[t][a].count),e[t][a].percentage=(e[t][a].count/r.lemmaCount.count*100).toFixed(2),e[t][a].class_percentage=(e[t][a].count/n*100).toFixed(2)}return console.log(e),e}(e),r.isLoadingWordResults=!1)})}).catch(function(t){return function(t,a){a===c&&(r.isLoadingResults=!1,r.error=t,e.error(t))}(t,a)})}(a)}t.$on("sf-facet-constraints",d)}angular.module("facetApp").controller("NlpStatisticsController",e),e.$inject=["$log","$scope","$state","_","google","nlpService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){var l=this;l.hasResults=function(){return i.keys(l.results).length>0},l.facetParam1='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source5>","constraint":" ?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source5> . "}}',l.facetParam1Ex1='{"link":{"value":["yo1853"],"constraint":"?id <http://ldf.fi/nbf/yo1853> [] ."}}',l.facetParam1Ex2='{"slider":{"value":{"min":200,"max":2020},"constraint":"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_89 . FILTER (200<=year(?slider_89) && year(?slider_89)<=2020) "},"category":{"value":"kirjallisuus@fi","constraint":" ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>/<http://www.w3.org/2004/02/skos/core#prefLabel> "kirjallisuus"@fi . "}}',l.facetParam1Ex3='{"slider":{"value":{"min":1800,"max":1900},"constraint":"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_89 . FILTER (1800<=year(?slider_89) && year(?slider_89)<=1900) "},"gender":{"value":""mies"@fi","constraint":" ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli> "mies"@fi . "}}',l.facetParam2Ex3='{"slider":{"value":{"min":1800,"max":1900},"constraint":"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_89 . FILTER (1800<=year(?slider_89) && year(?slider_89)<=1900) "},"gender":{"value":""mies"@fi","constraint":" ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli> "mies"@fi . "}}',l.facetParam1Ex4='{"place":{"value":"<http://ldf.fi/nbf/places/Ruotsi>","constraint":" ?seco_v_place (<http://www.w3.org/2004/02/skos/core#broader>)* <http://ldf.fi/nbf/places/Ruotsi> .  ?id <http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place> ?seco_v_place . "}}',l.facetParam2='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source4>","constraint":" ?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source4> . "}}',l.facetParam2Ex1='{"link":{"value":["norssit"],"constraint":"?id <http://ldf.fi/nbf/norssi> [] ."}}',l.facetParam2Ex2={slider:{value:{min:200,max:2020},constraint:"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_76 . FILTER (200<=year(?slider_76) && year(?slider_76)<=2020) "},category:{value:"kuvataiteet, valokuvaus@fi",constraint:' ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>/<http://www.w3.org/2004/02/skos/core#prefLabel> "kuvataiteet, valokuvaus"@fi . '}},l.facetParam2Ex4='{"place":{"value":"<http://ldf.fi/nbf/places/Ven%C3%A4j%C3%A4>","constraint":" ?seco_v_place (<http://www.w3.org/2004/02/skos/core#broader>)* <http://ldf.fi/nbf/places/Ven%C3%A4j%C3%A4> .  ?id <http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place> ?seco_v_place . "}}',l.removeFacetSelections=function(){a.reload()},l.upos=n.upos,n.getFacets().then(function(e){var a;l.facets=e,l.facetOptions=((a=n.getFacetOptions()).initialState=o.getFacetValuesFromUrlParams(),a),l.facetOptions.scope=t,l.handler=new s(l.facetOptions)});var r,c=t.$on("sf-initial-constraints",function(e,t){p(e,t),c()});function p(e,t){if(!l.previousSelections||!i.isEqual(t.constraint,l.previousSelections))return l.previousSelections=i.clone(t.constraint),u(t)}function d(e,t,a,i,n){return[t,a].join(" - ")}function p(e,t){if(!l.previousSelections||!i.isEqual(t.constraint,l.previousSelections))return l.previousSelections=i.clone(t.constraint),o.updateUrlParams(t),u(t)}function u(t){l.isLoadingResults=!0,l.isLoadingWordResults=!0,l.results=[],l.error=void 0;var a=i.uniqueId();return r=a,n.getWordCount(t).then(function(e){r===a&&(l.lemmaCount=e[0],l.isLoadingResults=!1,console.log(e[0]))}).then(function(){return n.getResults(t).then(function(e){r===a&&(l.results=function(e){var t,a;for(t in console.log("start count",l.lemmaCount.count),e){var i="VERB"==(s=t)?l.lemmaCount.verbCount:"ADJ"==s?l.lemmaCount.adjCount:"NOUN"==s?l.lemmaCount.nounCount:"PROPN"==s?l.lemmaCount.pnounCount:(console.log("Unidentifiable pos-tag",s),l.lemmaCount.count);for(a in e[t]){var n=e[t][a].lemma;console.log("lemma:",n),n.match(/^\d/)&&n.match(/[a-zäöåA-ZÄÖÅ]$/)&&(console.log("check",n.replace(/([^\d]*)([^\w]*)/),d),e[t][a].lemma=n.replace(/([^\d]*)([^\w]*)/,d)),e[t][a].percentage=(e[t][a].count/l.lemmaCount.count*100).toFixed(2),e[t][a].class_percentage=(e[t][a].count/i*100).toFixed(2)}}var s;return console.log(e),e}(e),l.isLoadingWordResults=!1)})}).catch(function(t){return function(t,a){a===r&&(l.isLoadingResults=!1,l.error=t,e.error(t))}(t,a)})}t.$on("sf-facet-constraints",p)}angular.module("facetApp").controller("NlpComparisonController",e),e.$inject=["$log","$scope","$state","_","nlpService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){var l=this;l.hasResults=function(){return i.keys(l.results).length>0},l.facetParam1='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source5>","constraint":" ?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source5> . "}}',l.facetParam1Ex1='{"link":{"value":["yo1853"],"constraint":"?id <http://ldf.fi/nbf/yo1853> [] ."}}',l.facetParam1Ex2='{"slider":{"value":{"min":200,"max":2020},"constraint":"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_89 . FILTER (200<=year(?slider_89) && year(?slider_89)<=2020) "},"category":{"value":"kirjallisuus@fi","constraint":" ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>/<http://www.w3.org/2004/02/skos/core#prefLabel> "kirjallisuus"@fi . "}}',l.facetParam1Ex3='{"slider":{"value":{"min":1800,"max":1900},"constraint":"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_89 . FILTER (1800<=year(?slider_89) && year(?slider_89)<=1900) "},"gender":{"value":""mies"@fi","constraint":" ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli> "mies"@fi . "}}',l.facetParam2Ex3='{"slider":{"value":{"min":1800,"max":1900},"constraint":"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_89 . FILTER (1800<=year(?slider_89) && year(?slider_89)<=1900) "},"gender":{"value":""mies"@fi","constraint":" ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli> "mies"@fi . "}}',l.facetParam1Ex4='{"place":{"value":"<http://ldf.fi/nbf/places/Ruotsi>","constraint":" ?seco_v_place (<http://www.w3.org/2004/02/skos/core#broader>)* <http://ldf.fi/nbf/places/Ruotsi> .  ?id <http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place> ?seco_v_place . "}}',l.facetParam2='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source4>","constraint":" ?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source4> . "}}',l.facetParam2Ex1='{"link":{"value":["norssit"],"constraint":"?id <http://ldf.fi/nbf/norssi> [] ."}}',l.facetParam2Ex2={slider:{value:{min:200,max:2020},constraint:"?id <http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart> ?slider_76 . FILTER (200<=year(?slider_76) && year(?slider_76)<=2020) "},category:{value:"kuvataiteet, valokuvaus@fi",constraint:' ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>/<http://www.w3.org/2004/02/skos/core#prefLabel> "kuvataiteet, valokuvaus"@fi . '}},l.facetParam2Ex4='{"place":{"value":"<http://ldf.fi/nbf/places/Ven%C3%A4j%C3%A4>","constraint":" ?seco_v_place (<http://www.w3.org/2004/02/skos/core#broader>)* <http://ldf.fi/nbf/places/Ven%C3%A4j%C3%A4> .  ?id <http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place> ?seco_v_place . "}}',l.removeFacetSelections=function(){a.reload()},l.upos=n.upos,n.getFacets().then(function(e){var a;l.facets=e,l.facetOptions=((a=n.getFacetOptions()).initialState=o.getFacetValuesFromUrlParams(),a),l.facetOptions.scope=t,l.handler=new s(l.facetOptions)});var r,c=t.$on("sf-initial-constraints",function(e,t){p(e,t),c()});function p(e,t){if(!l.previousSelections||!i.isEqual(t.constraint,l.previousSelections))return l.previousSelections=i.clone(t.constraint),u(t)}function d(e,t,a,i,n){return[t,a].join(" - ")}function p(e,t){if(!l.previousSelections||!i.isEqual(t.constraint,l.previousSelections))return l.previousSelections=i.clone(t.constraint),o.updateUrlParams(t),u(t)}function u(t){l.isLoadingResults=!0,l.isLoadingWordResults=!0,l.results=[],l.error=void 0;var a=i.uniqueId();return r=a,n.getWordCount(t).then(function(e){r===a&&(l.lemmaCount=e[0],l.isLoadingResults=!1,console.log(e[0]))}).then(function(){return n.getResults(t).then(function(e){r===a&&(l.results=function(e){var t,a;for(t in console.log("start count",l.lemmaCount.count),e){var i="VERB"==(s=t)?l.lemmaCount.verbCount:"ADJ"==s?l.lemmaCount.adjCount:"NOUN"==s?l.lemmaCount.nounCount:"PROPN"==s?l.lemmaCount.pnounCount:(console.log("Unidentifiable pos-tag",s),l.lemmaCount.count);for(a in e[t]){var n=e[t][a].lemma;console.log("lemma:",n),n.match(/^\d/)&&n.match(/[a-zäöåA-ZÄÖÅ]$/)&&(console.log("check",n.replace(/([^\d]*)([^\w]*)/),d),e[t][a].lemma=n.replace(/([^\d]*)([^\w]*)/,d)),e[t][a].percentage=(e[t][a].count/l.lemmaCount.count*100).toFixed(2),e[t][a].class_percentage=(e[t][a].count/i*100).toFixed(2)}}var s;return console.log(e),e}(e),l.isLoadingWordResults=!1)})}).catch(function(t){return function(t,a){a===r&&(l.isLoadingResults=!1,l.error=t,e.error(t))}(t,a)})}t.$on("sf-facet-constraints",p)}angular.module("facetApp").controller("NlpComparisonControllerRight",e),e.$inject=["$log","$scope","$state","_","nlpService","FacetHandler","facetUrlStateHandlerService2"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getYears=function(e){return h(e,r)},this.getAge=function(e){return h(e,c)},this.getMarriageAge=function(e){return h(e,p)},this.getFirstChildAge=function(e){return h(e,d)},this.getNumberOfChildren=function(e){return h(e,u)},this.getNumberOfSpouses=function(e){return h(e,f)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return m};var l="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/> PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#> PREFIX schema: <http://schema.org/> PREFIX owl: <http://www.w3.org/2002/07/owl#> PREFIX skos:  <http://www.w3.org/2004/02/skos/core#> PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#> PREFIX\tnbf:\t<http://ldf.fi/nbf/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX\tgvp:\t<http://vocab.getty.edu/ontology#> PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX dcterms: <http://purl.org/dc/terms/> PREFIX foaf: <http://xmlns.com/foaf/0.1/> PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\trelations:\t<http://ldf.fi/nbf/relations/> PREFIX\tsources:\t<http://ldf.fi/nbf/sources/> ",r=l+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   { <RESULT_SET> }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .  BIND (FLOOR(YEAR(?birth)/10)*10 AS ?value)  BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY ?value ',c=l+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   { <RESULT_SET> }   ?id foaf:focus/^crm:P100_was_death_of/nbf:time [ gvp:estStart ?time ; gvp:estEnd ?time2 ; skos:prefLabel [] ] ;        foaf:focus/^crm:P98_brought_into_life/nbf:time [ gvp:estStart ?birth ; gvp:estEnd ?birth2 ; skos:prefLabel [] ] .   BIND (xsd:integer(0.5*(year(?time)+year(?time2)-year(?birth)-year(?birth2))) AS ?value)   FILTER (-1<?value && ?value<120)   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',p=l+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE {      {     SELECT DISTINCT ?id (min(?age) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Spouse relations:Wife relations:Husband }       ?id bioc:has_family_relation [ a ?rel ;  nbf:time/gvp:estStart ?time ] ;                                      foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .       BIND (year(?time)-year(?birth) AS ?age)       FILTER (13<?age && ?age<120)}    GROUP BY ?id }    FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',d=l+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE {      {     SELECT DISTINCT ?id (min(?age) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Child relations:Son relations:Daughter }       ?id bioc:has_family_relation [ a ?rel ;  nbf:time/gvp:estStart ?time ] ;                                      foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .       BIND (year(?time)-year(?birth) AS ?age)       FILTER (13<?age && ?age<120)}     GROUP BY ?id }    FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',u=l+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   {     SELECT DISTINCT ?id (count(DISTINCT ?pc) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Child relations:Son relations:Daughter }       ?id bioc:has_family_relation [     \ta ?rel ;     \tbioc:inheres_in/owl:sameAs* ?pc ]       FILTER NOT EXISTS { ?pc owl:sameAs [] }     }     GROUP BY ?id   }   UNION   {     { <RESULT_SET> }     VALUES ?source { sources:source1 sources:source4 }     ?id <http://purl.org/dc/terms/source> ?source .    FILTER not exists { ?id bioc:has_family_relation/a relations:Child }     FILTER not exists { ?id bioc:has_family_relation/a relations:Son }     FILTER not exists { ?id bioc:has_family_relation/a relations:Daughter }     BIND (0 AS ?value)   }   FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',f=l+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE { \t{     SELECT DISTINCT ?id (count(DISTINCT ?pc) AS ?value) WHERE     {       { <RESULT_SET> }        VALUES ?rel { relations:Spouse relations:Wife relations:Husband }       ?id bioc:has_family_relation [           a ?rel ;           bioc:inheres_in/owl:sameAs* ?pc ]       FILTER NOT EXISTS { ?pc owl:sameAs [] }     }     GROUP BY ?id   }   UNION {     { <RESULT_SET> }      FILTER not exists { ?id owl:sameAs*/bioc:has_family_relation/a relations:Spouse }     FILTER not exists { ?id owl:sameAs*/bioc:has_family_relation/a relations:Husband }     FILTER not exists { ?id owl:sameAs*/bioc:has_family_relation/a relations:Wife }     BIND (0 AS ?value)   }   FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+//([^//]+)$","$1") AS ?url) } GROUP BY ?value ',m={endpointUrl:o,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},g=new i(o,n);function h(e,t){var a=e.constraint.join(" "),i=t.replace(/<RESULT_SET>/g,a);return g.getObjectsNoGrouping(i)}}angular.module("facetApp").service("visuColumnService",e),e.$inject=["$q","_","FacetResultHandler","AdvancedSparqlService","objectMapperService","mapfacetService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){var r=this;r.people=[],r.data={},r.chart_ids=[0,1,2,3,4,5].map(function(e){return a.uniqueId()}),r.showForm=function(){l.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},r.removeFacetSelections=function(){t.reload()};var c=e.$on("sf-initial-constraints",function(e,t){p(e,t),c()});function p(e,t){r.previousSelections&&a.isEqual(t.constraint,r.previousSelections)||(r.previousSelections=a.clone(t.constraint),o.updateUrlParams(t),n.getYears(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){!function(e,t,a,n){var s=e.map(function(e){return[e.value,parseInt(e.count)]}),o=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0);r.data[n]=e.map(function(e){return e.persons});var l=new i.visualization.DataTable,c={title:a+", yhteensä "+o+" henkilöä",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:""},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},p=new i.visualization.ColumnChart(document.getElementById(n));l.addColumn("string","Vuosikymmen"),l.addColumn("number","Henkilöä"),l.addRows(s),p.draw(l,c),i.visualization.events.addListener(p,"select",function(){var e=p.getSelection(),t=e[0].row,a=parseInt(s[t][0]),i=a+9;r.people=r.data[n][t],r.popuptitle="Vuodet "+a+"–"+i+": "+s[t][1]+" henkilöä",r.showForm()})}(e,0,"Henkilöjakauma vuosikymmenittäin",r.chart_ids[0])})}),n.getAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Elinikä",r.chart_ids[1]," vuotta")})}),n.getMarriageAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Naimisiinmenoikä",r.chart_ids[2]," vuotta")})}),n.getFirstChildAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Lapsensaanti-ikä",r.chart_ids[3]," vuotta")})}),n.getNumberOfChildren(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,25],"Lasten lukumäärä",r.chart_ids[4],"")})}),n.getNumberOfSpouses(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,10],"Puolisoiden lukumäärä",r.chart_ids[5],"")})}))}function d(e,t,a,n,s){var o=5;e.forEach(function(e){var a=parseInt(e.value);o<a&&a<=t[1]&&(o=a)}),o<t[1]&&(t[1]=o);for(var l=t[1]-t[0]+1,c=new Array(l),p=new Array(l),d=0;d<l;d++)c[d]=[d,0],p[d]="";e.forEach(function(e){var a=parseInt(e.value);t[0]<=a&&a<=t[1]&&(c[a]=[a,parseInt(e.count)],p[a]=e.persons)}),r.data[n]=p;var u=function(e){var t=0,a=0,i=0;if($.each(e,function(e,n){var s=n[0]*n[1];t+=s,a+=n[0]*s,i+=n[1]}),i>0){var n=t/i;return[i,n,Math.sqrt(a/i-n*n)]}return[0,0,0]}(c),f=a+(0==u[0]?": ei tuloksia":", otos: "+u[0]+", keskiarvo: "+u[1].toFixed(2)+", keskihajonta: "+u[2].toFixed(2)),m=new i.visualization.DataTable,g={title:f,legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:function(e){var t=[],a=10*Math.floor(1+e[0]/10);for(;a<e[1];)t.push(a),a+=10;return t}(t)},vAxis:{maxValue:4,viewWindow:{min:1}},width:"95%",bar:{groupWidth:"88%"},height:500},h=new i.visualization.ColumnChart(document.getElementById(n));m.addColumn("number","Ikä"),m.addColumn("number","Henkilöä"),m.addRows(c),h.draw(m,g),i.visualization.events.addListener(h,"select",function(){var e=h.getSelection()[0].row;r.people=r.data[n][e],r.popuptitle=a+" "+e+s+": "+c[e][1]+(1==c[e][1]?" henkilö":" henkilöä"),r.showForm()})}e.$on("sf-facet-constraints",p),n.getFacets().then(function(t){var a;r.facets=t,r.facetOptions=((a=n.getFacetOptions()).initialState=o.getFacetValuesFromUrlParams(),a),r.facetOptions.scope=e,r.handler=new s(r.facetOptions)})}angular.module("facetApp").controller("VisuColumnController",e),e.$inject=["$scope","$state","_","google","visuColumnService","FacetHandler","facetUrlStateHandlerService","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){var r=this;r.people=[],r.data={},r.chart_ids=[0,1,2,3,4,5].map(function(e){return a.uniqueId()}),r.showForm=function(){l.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},r.removeFacetSelections=function(){t.reload()};var c=e.$on("sf-initial-constraints",function(e,t){p(e,t),c()});function p(e,t){r.previousSelections&&a.isEqual(t.constraint,r.previousSelections)||(r.previousSelections=a.clone(t.constraint),o.updateUrlParams(t),n.getYears(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){!function(e,t,a,n){var s=e.map(function(e){return[e.value,parseInt(e.count)]}),o=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0);r.data[n]=e.map(function(e){return e.persons});var l=new i.visualization.DataTable,c={title:a+", yhteensä "+o+" henkilöä",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:""},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},p=new i.visualization.ColumnChart(document.getElementById(n));l.addColumn("string","Vuosikymmen"),l.addColumn("number","Henkilöä"),l.addRows(s),p.draw(l,c),i.visualization.events.addListener(p,"select",function(){var e=p.getSelection(),t=e[0].row,a=parseInt(s[t][0]),i=a+9;r.people=r.data[n][t],r.popuptitle="Vuodet "+a+"–"+i+": "+s[t][1]+" henkilöä",r.showForm()})}(e,0,"Henkilöjakauma vuosikymmenittäin",r.chart_ids[0])})}),n.getAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Elinikä",r.chart_ids[1]," vuotta")})}),n.getMarriageAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Naimisiinmenoikä",r.chart_ids[2]," vuotta")})}),n.getFirstChildAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Lapsensaanti-ikä",r.chart_ids[3]," vuotta")})}),n.getNumberOfChildren(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,25],"Lasten lukumäärä",r.chart_ids[4],"")})}),n.getNumberOfSpouses(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,10],"Puolisoiden lukumäärä",r.chart_ids[5],"")})}))}function d(e,t,a,n,s){var o=5;e.forEach(function(e){var a=parseInt(e.value);o<a&&a<=t[1]&&(o=a)}),o<t[1]&&(t[1]=o);for(var l=t[1]-t[0]+1,c=new Array(l),p=new Array(l),d=0;d<l;d++)c[d]=[d,0],p[d]="";e.forEach(function(e){var a=parseInt(e.value);t[0]<=a&&a<=t[1]&&(c[a]=[a,parseInt(e.count)],p[a]=e.persons)}),r.data[n]=p;var u=function(e){var t=0,a=0,i=0;if($.each(e,function(e,n){var s=n[0]*n[1];t+=s,a+=n[0]*s,i+=n[1]}),i>0){var n=t/i;return[i,n,Math.sqrt(a/i-n*n)]}return[0,0,0]}(c),f=a+(0==u[0]?": ei tuloksia":", otos: "+u[0]+", keskiarvo: "+u[1].toFixed(2)+", keskihajonta: "+u[2].toFixed(2)),m=new i.visualization.DataTable,g={title:f,legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:function(e){var t=[],a=10*Math.floor(1+e[0]/10);for(;a<e[1];)t.push(a),a+=10;return t}(t)},vAxis:{maxValue:4,viewWindow:{min:1}},width:"95%",bar:{groupWidth:"88%"},height:500},h=new i.visualization.ColumnChart(document.getElementById(n));m.addColumn("number","Ikä"),m.addColumn("number","Henkilöä"),m.addRows(c),h.draw(m,g),i.visualization.events.addListener(h,"select",function(){var e=h.getSelection()[0].row;r.people=r.data[n][e],r.popuptitle=a+" "+e+s+": "+c[e][1]+(1==c[e][1]?" henkilö":" henkilöä"),r.showForm()})}e.$on("sf-facet-constraints",p),n.getFacets().then(function(t){var a;r.facets=t,r.facetOptions=((a=n.getFacetOptions()).initialState=o.getFacetValuesFromUrlParams(),a),r.facetOptions.scope=e,r.handler=new s(r.facetOptions)})}angular.module("facetApp").controller("VisuColumnControllerRight",e),e.$inject=["$scope","$state","_","google","visuColumnService","FacetHandler","facetUrlStateHandlerService2","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getGenders=function(e){return g(e,r)},this.getCategories=function(e){return g(e,c)},this.getTitles=function(e){return g(e,p)},this.getDatabases=function(e){return g(e,d)},this.getCompanies=function(e){return g(e,u)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return f};var l="PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\tnbf: <http://ldf.fi/nbf/>  PREFIX owl: <http://www.w3.org/2002/07/owl#> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX\trelations: <http://ldf.fi/nbf/relations/> PREFIX schema: <http://schema.org/>  PREFIX\tsources: <http://ldf.fi/nbf/sources/> PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",r=l+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)   WHERE {  <RESULT_SET>   ?id foaf:focus ?prs .   { ?prs nbf:sukupuoli ?value }   UNION   { BIND ("ei tiedossa" AS ?value) .     FILTER NOT EXISTS { ?prs nbf:sukupuoli [] }   }   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url)  } GROUP BY ?value ORDER BY DESC(?count) ',c=l+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE { { <RESULT_SET> }   ?id foaf:focus/nbf:has_category/skos:prefLabel ?value   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY DESC(?count)',p=l+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE { { <RESULT_SET> }   ?id foaf:focus/^bioc:inheres_in/nbf:has_title/skos:prefLabel ?value   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY DESC(?count)',d=l+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE { { <RESULT_SET> }   ?id owl:sameAs*|^(owl:sameAs)* ?id2 .   ?id2 dcterms:source ?source .   FILTER (?source!=<http://ldf.fi/nbf/sources/source7>)   ?source skos:prefLabel ?value .   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY DESC(?count)',u=l+'SELECT DISTINCT (SAMPLE(?label) AS ?value) (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE {    { <RESULT_SET> }   ?id foaf:focus/^bioc:inheres_in/nbf:related_company ?cmp .   ?cmp skos:prefLabel ?label .   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?cmp ORDER BY DESC(?count)',f={endpointUrl:o,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},m=new i(o,n);function g(e,t){var a=e.constraint.join(" "),i=t.replace(/<RESULT_SET>/g,a);return m.getObjectsNoGrouping(i)}}angular.module("facetApp").service("visuPieService",e),e.$inject=["$q","_","FacetResultHandler","AdvancedSparqlService","objectMapperService","mapfacetService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.people=[],c.data={},c.chart_ids=[0,1,2,3,4].map(function(e){return i.uniqueId()}),c.showForm=function(){r.open({templateUrl:"views/popup.html",scope:t}).result.then(function(){},function(e){})},c.removeFacetSelections=function(){a.reload()};var p=t.$on("sf-initial-constraints",function(e,t){d(e,t),p()});function d(e,t){c.previousSelections&&i.isEqual(t.constraint,c.previousSelections)||(c.previousSelections=i.clone(t.constraint),l.updateUrlParams(t),s.getGenders(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Sukupuoli tai ryhmä",c.chart_ids[0])})}),s.getCategories(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Toimiala",c.chart_ids[2])})}),s.getTitles(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Arvo, ammatti tai toiminta",c.chart_ids[3])})}),s.getDatabases(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Tietokanta",c.chart_ids[1])})}),s.getCompanies(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Yritys tai yhteisö",c.chart_ids[4])})}))}function u(e,t,a){var i=e.map(function(e){return[e.value,parseInt(e.count)]}),s=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0),o=n.visualization.arrayToDataTable([["Luokka","Arvo"]].concat(i));c.data[a]=e.map(function(e){return e.persons});var l={title:t+(0==s?": ei tuloksia":": "+e.length+(e.length>1?" luokkaa, ":" luokka, ")+"yhteensä "+s+" henkilöä")},r=new n.visualization.PieChart(document.getElementById(a));r.draw(o,l),n.visualization.events.addListener(r,"select",function(){var e;try{e=r.getSelection()[0].row}catch(e){return void console.log("Unhandled click")}c.people=c.data[a][e],c.popuptitle=i[e][0]+": "+i[e][1]+" tulosta",c.showForm()})}t.$on("sf-facet-constraints",d),s.getFacets().then(function(e){var a;c.facets=e,c.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=t,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("VisuPieController",e),e.$inject=["$log","$scope","$state","_","google","visuPieService","FacetHandler","facetUrlStateHandlerService","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.people=[],c.data={},c.chart_ids=[0,1,2,3,4].map(function(e){return i.uniqueId()}),c.showForm=function(){r.open({templateUrl:"views/popup.html",scope:t}).result.then(function(){},function(e){})},c.removeFacetSelections=function(){a.reload()};var p=t.$on("sf-initial-constraints",function(e,t){d(e,t),p()});function d(e,t){c.previousSelections&&i.isEqual(t.constraint,c.previousSelections)||(c.previousSelections=i.clone(t.constraint),l.updateUrlParams(t),s.getGenders(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Sukupuoli tai ryhmä",c.chart_ids[0])})}),s.getCategories(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Toimiala",c.chart_ids[2])})}),s.getTitles(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Arvo, ammatti tai toiminta",c.chart_ids[3])})}),s.getDatabases(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Tietokanta",c.chart_ids[1])})}),s.getCompanies(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Yritys tai yhteisö",c.chart_ids[4])})}))}function u(e,t,a){var i=e.map(function(e){return[e.value,parseInt(e.count)]}),s=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0),o=n.visualization.arrayToDataTable([["Luokka","Arvo"]].concat(i));c.data[a]=e.map(function(e){return e.persons});var l={title:t+(0==s?": ei tuloksia":": "+e.length+(e.length>1?" luokkaa, ":" luokka, ")+"yhteensä "+s+" henkilöä")},r=new n.visualization.PieChart(document.getElementById(a));r.draw(o,l),n.visualization.events.addListener(r,"select",function(){var e;try{e=r.getSelection()[0].row}catch(e){return void console.log("Unhandled click")}c.people=c.data[a][e],c.popuptitle=i[e][0]+": "+i[e][1]+" tulosta",c.showForm()})}t.$on("sf-facet-constraints",d),s.getFacets().then(function(e){var a;c.facets=e,c.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=t,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("VisuPieControllerRight",e),e.$inject=["$log","$scope","$state","_","google","visuPieService","FacetHandler","facetUrlStateHandlerService2","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){var l=this;function r(e){l.isLoadingResults=!1,l.error=e}!function(){l.isLoadingResults=!0;var a=t.placeId;/^[^/]+$/.test(a)&&(a="http://ldf.fi/nbf/places/"+a),o.getPlace(a).then(function(t){l.isLoadingResults=!1,l.place=t[0],o.getHierarchy(a).then(function(t){t.length&&(l.related=t),function(){if(l.place&&l.place.lat){var t=l.place.lat,a=l.place.lng;l.map={center:{latitude:t,longitude:a},zoom:6},l.markers[0]={latitude:t,longitude:a,id:"0",options:{icon:{scaledSize:new google.maps.Size(60,60),url:"https://maps.google.com/mapfiles/ms/icons/red-dot.png"},optimized:!0,title:l.place.label}}}l.related&&(l.related.forEach(function(t,a){t.lat&&parseInt(t.level)<1&&l.markers.push({latitude:t.lat,longitude:t.lng,id:a,options:{icon:{scaledSize:new google.maps.Size(30,30),url:"https://maps.google.com/mapfiles/ms/icons/blue-dot.png"},optimized:!0,title:t.label},onClick:function(){e.go("place",{placeId:t.id.replace(/^.+?([^/]+)$/,"$1")})}})}),s.$watch("vm.currentPage + numPerPage",function(){var e=(l.currentPage-1)*l.numPerPage,t=e+l.numPerPage;l.filteredRelated=l.related.slice(e,t)}))}()}).catch(r),o.getEvents(a).then(function(e){e.forEach(function(e){l[e.class]={people:e.prslist,count:e.count}})}).catch(r)}).catch(r)}(),l.currentPage=1,l.numPerPage=14,l.maxSize=5,l.map={center:{latitude:62,longitude:24},zoom:6},l.markers=[]}angular.module("facetApp").controller("PlaceController",e),e.$inject=["$state","$stateParams","$uibModal","_","$location","$scope","placeService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l){this.getPlace=function(e){var t=r+c.replace("RESULT_SET",e);return f.getObjects(t)},this.getHierarchy=function(e){var t=r+p.replace("RESULT_SET",e);return f.getObjectsNoGrouping(t)},this.getEvents=function(e){var t=r+d.replace("RESULT_SET",e);return f.getObjectsNoGrouping(t)},this.getResults=function(t){var a=[this.getPlace(t)];return e.all(a)},this.getFacets=o.getFacets,this.getFacetOptions=function(){return u};var r="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX\tnbf: <http://ldf.fi/nbf/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX\tgvp: <http://vocab.getty.edu/ontology#>\t PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\trelations: <http://ldf.fi/nbf/relations/> PREFIX\tsources: <http://ldf.fi/nbf/sources/> PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> PREFIX owl: <http://www.w3.org/2002/07/owl#> ",c='SELECT distinct * WHERE {   VALUES ?id { <RESULT_SET> }   ?id a nbf:Place ;       skos:prefLabel ?label .   FILTER (lang(?label)="fi")   OPTIONAL { ?id geo:lat ?lat ; geo:long ?lng }   OPTIONAL { ?id skos:prefLabel|skos:altLabel ?alabel }   OPTIONAL { ?id nbf:yso ?yso }   OPTIONAL { ?id nbf:wikidata ?wikidata } } ',p='SELECT distinct ?id ?level ?label ?lat ?lng WHERE { VALUES ?place { <RESULT_SET> }   { ?place skos:broader+ ?id .    BIND(1 AS ?level)   }   UNION   { ?id skos:broader ?place .    BIND(-1 AS ?level)   \tFILTER EXISTS { [] nbf:place ?id }  }  FILTER NOT EXISTS { ?id owl:sameAs/a nbf:Place }  OPTIONAL { ?id geo:lat ?lat ; geo:long ?lng }  ?id skos:prefLabel ?label  FILTER (lang(?label)="fi") } ORDER BY DESC(?level) ?label ',d='SELECT DISTINCT ?class (GROUP_CONCAT(DISTINCT(?prs); separator=",") as ?prslist) (COUNT(DISTINCT ?prs) AS ?count) WHERE {  VALUES ?id { <RESULT_SET> }   ?evt nbf:place ?id ;       (crm:P100_was_death_of|crm:P98_brought_into_life|bioc:inheres_in)/^foaf:focus ?prs ;       a/skos:prefLabel ?class .  FILTER (lang(?class)="en") } GROUP BY ?class ',u={endpointUrl:l,rdfClass:"<http://ldf.fi/nbf/Place>",preferredLang:"fi"},f=new i(l,s)}angular.module("facetApp").service("placeService",e),e.$inject=["$q","$location","_","AdvancedSparqlService","FacetResultHandler","objectMapperService","mapfacetService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getResults=function(e,t){return k.getObjectsNoGrouping(r.replace("$personId",t)).then(function(e){if(e.length>0){var t=d.replace("$person_formatted_link",e[0].href);return console.log(t),b.getObjectsNoGrouping(t)}return{}})},this.getReferences=function(e,t){var a=p.replace("$personId",t);return b.getObjectsNoGrouping(a)},this.getPersonName=function(e,t){var a=c.replace("$personId",t);return k.getObjectsNoGrouping(a)},this.getWordUsageResults=function(t,a){var i={},n=m.replace("$personId",a);return this.upos.forEach(function(e){i[e.key]=b.getObjectsNoGrouping(n.replace(/<UPOS>/g,e.key))}),e.all(i)},this.getWordCount=function(e){var t=g.replace(/<RESULT_SET>/g,e.constraint.join(" "));return k.getObjectsNoGrouping(t)},this.getReferencesByDecade=function(e,t){return k.getObjectsNoGrouping(r.replace("$personId",t)).then(function(e){if(e.length>0){var t=u.replace("$person_formatted_link",e[0].href),a=b.getObjectsNoGrouping(t);return a}return{}})},this.getReferencingByDecade=function(e,t){var a=f.replace("$personId",t);return b.getObjectsNoGrouping(a)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return angular.copy(v)},this.upos=[{key:"VERB",label:"Verbi"},{key:"NOUN",label:"Substantiivi"},{key:"ADJ",label:"Adjektiivi"},{key:"PROPN",label:"Erisnimi"}];var l=" PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX conll: <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#>  PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX schema: <http://schema.org/>  PREFIX text: <http://jena.apache.org/text#> ",r=l+"SELECT ?href {  BIND( <http://ldf.fi/nbf/$personId> as ?person)  ?person  nbf:formatted_link ?href .}",c=l+'SELECT ?label {  BIND( <http://ldf.fi/nbf/$personId> as ?id)  ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }    OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label) }',p=l+'SELECT * {  BIND( <http://ldf.fi/nbf/$personId> as ?person)  ?source <http://ldf.fi/nbf/biography/data#docRef> ?person .  ?source dct:hasPart/dct:references ?target .  ?target  nif:isString ?target_string .  ?target <http://ldf.fi/nbf/biography/data#anchor_link> ?target_link .  ?target dct:isPartOf ?sentence .  ?word <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#sentence> ?sentence ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#WORD> ?string ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#UPOS> ?upos ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#ID> ?id ;        <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#structure> ?structure ;        <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#sentenceOrder> ?sID .  ?sentence dct:isPartOf ?paragraph .  ?paragraph <http://ldf.fi/nbf/biography/data#order> ?i .  BIND(xsd:integer(?id) as ?x)  BIND(xsd:decimal(STR(?sID)) as ?y)  BIND(xsd:integer(?i) as ?z)  BIND(REPLACE(STR(?target_link), "file:///tmp/data/nlp/", "") AS ?link)  SERVICE <http://ldf.fi/nbf/sparql> {    ?personUri nbf:formatted_link ?link .    ?person <http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://www.w3.org/2004/02/skos/core#prefLabel> ?label_lang .   }     BIND (str(?label_lang) AS ?label)} ORDER BY ASC(?structure) ASC(?z) ASC(?y) ASC(?x)',d=l+"SELECT * {  BIND( <file:///tmp/data/nlp/$person_formatted_link> as ?person)  ?target  <http://ldf.fi/nbf/biography/data#anchor_link> ?person .  ?target  nif:isString ?target_string .  ?target dct:isPartOf ?sentence .  ?word <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#sentence> ?sentence ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#WORD> ?string ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#UPOS> ?upos ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#ID> ?id ;        <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#structure> ?structure ;        <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#sentenceOrder> ?sID .  ?sentence dct:isPartOf ?paragraph .  ?paragraph dct:isPartOf/<http://ldf.fi/nbf/biography/data#docRef> ?personUri .  ?paragraph <http://ldf.fi/nbf/biography/data#order> ?i .  BIND(xsd:integer(?id) as ?x)  BIND(xsd:decimal(STR(?sID)) as ?y)  BIND(xsd:integer(?i) as ?z)  SERVICE <http://ldf.fi/nbf/sparql> {     ?personUri <http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://www.w3.org/2004/02/skos/core#prefLabel> ?label_lang .      BIND (str(?label_lang) AS ?label)  }} ORDER BY ASC(?structure) ASC(?z) ASC(?y) ASC(?x)",u=l+" SELECT DISTINCT ?year (COUNT(distinct ?id) AS ?count) {   BIND( <file:///tmp/data/nlp/$person_formatted_link> as ?person)  ?target  <http://ldf.fi/nbf/biography/data#anchor_link> ?person .  ?target  nif:isString ?target_string .  ?source dct:hasPart/dct:references ?target .  ?source <http://ldf.fi/nbf/biography/data#docRef> ?id .  SERVICE <http://ldf.fi/nbf/sparql> {     ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   }  BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ",f=l+' SELECT DISTINCT ?year (COUNT(distinct ?id) AS ?count) {   BIND( <http://ldf.fi/nbf/$personId> as ?person)  ?source <http://ldf.fi/nbf/biography/data#docRef> ?person .  ?source dct:hasPart/dct:references ?target .  ?target  nif:isString ?target_string .  ?target <http://ldf.fi/nbf/biography/data#anchor_link> ?target_link .  BIND(REPLACE(STR(?target_link), "file:///tmp/data/nlp/", "") AS ?link)  SERVICE <http://ldf.fi/nbf/sparql> {     ?id nbf:formatted_link ?link .    ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   }  BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ',m=l+' SELECT DISTINCT ?lemma (COUNT(?lemma) AS ?count) {   VALUES ?doc { <http://ldf.fi/nbf/$personId> }   ?word nif:structure/<http://ldf.fi/nbf/biography/data#docRef> ?doc .   ?word conll:UPOS "<UPOS>" .   ?word conll:LEMMA ?lemma .   FILTER(STRLEN(STR(?lemma))>2)   FILTER (regex(?lemma, "^[^.]*$")) .   FILTER (regex(?lemma, "^[^:]*$")) .   FILTER (regex(?lemma, "^[^;]*$")) .   FILTER (regex(?lemma, "^[^&]*$")) .   FILTER (regex(?lemma, "^[^,]*$")) .   FILTER (regex(?lemma, ".*(?<![.])$")) .  } GROUP BY ?lemma ORDER BY DESC(?count) LIMIT 50',g=l+" SELECT  (SUM(xsd:integer(?cnt)) AS ?count) (SUM(xsd:integer(?verb)) AS ?verbCount) (SUM(xsd:integer(?adj)) AS ?adjCount) (SUM(xsd:integer(?noun)) AS ?nounCount) (SUM(xsd:integer(?pnoun)) AS ?pnounCount) {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .   ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt ;      <http://ldf.fi/nbf/biography/data#verbCount> ?verb ;      <http://ldf.fi/nbf/biography/data#adjCount> ?adj ;      <http://ldf.fi/nbf/biography/data#nounCount> ?noun ;      <http://ldf.fi/nbf/biography/data#propnCount> ?pnoun . } ",h={endpointUrl:n,usePost:!0},v={endpointUrl:h.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},b=new a({endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},o),k=new a(h,o)}angular.module("facetApp").service("sentenceService",e),e.$inject=["$q","_","AdvancedSparqlService","FacetResultHandler","SPARQL_ENDPOINT_URL","mapfacetService","objectMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r,c){var p=this;p.test="Toimii",p.hasResults=function(){return s.keys(p.results).length>0},p.removeFacetSelections=function(){a.reload()},p.upos=l.upos,l.getFacets().then(function(e){var a;p.facets=e,p.facetOptions=((a=l.getFacetOptions()).initialState=c.getFacetValuesFromUrlParams(),a),p.facetOptions.scope=t,p.handler=new r(p.facetOptions)});var d,u=t.$on("sf-initial-constraints",function(e,t){h(e,t),u()});function f(e,t){var a;if("PUNCT"!=e[t].upos){var i=parseInt(t)+1;0==t?a=e[t].string.trim():t==e.length-1?a=" "+e[t].string.trim():e[t-1].string.contains("(")?"NUM"==e[t].upos&&4==e[t].string.length&&"NUM"==e[i].upos&&4==e[i].string.length&&e[i].word!=e[t].word?(a=e[t].string.trim()+" -",console.log(e[i]+"!="+e[t])):a=e[t].string.trim():"NUM"==e[t].upos&&4==e[t].string.length&&"NUM"==e[i].upos&&4==e[i].string.length&&e[i].word!=e[t].word?(a=e[t].string.trim()+" -",console.log(e[i].word+"!="+e[t].word),console.log(i+"!="+t)):(console.log("test "+e[t].string.trim()),a=" "+e[t].string.trim())}else a=e[t].string.contains("(")?" "+e[t].string.trim():e[t].string.trim();return a}function m(e,t,a){for(var i=0;i<e.length;i++)if(e[i].target_string===t&&e[i].target_link===a)return!0,!0;return!1}function g(e,t){var a;for(a in t){var i=t[a];e=e.replace(i.target_string,'<span class="personlink notranslate" style="font-weight:bold;" url="'+i.target_link+'">'+i.target_string+"</span>")}return e}function h(e,t){if(!p.previousSelections||!s.isEqual(t.constraint,p.previousSelections))return p.previousSelections=s.clone(t.constraint),c.updateUrlParams(t),function(e){p.isLoadingSentences=!0,p.isLoadingReferences=!0,p.isLoadingChart=!0,p.results=[],p.error=void 0;var t=s.uniqueId();d=t;var a=i.personId;return l.getResults(e,a).then(function(e){d===t&&(p.sentenceResults=function(e,t){var a,i,s,o="",l={data:[]},r=0,c=0;if(e.length>0){for(a in e){if(r=i,c=s,i=e[a].sentence,s=e[a].word,i!=r&&0!=r&&o.length>0){var p={sentence:r,words:n.trustAsHtml(o.replace(u,'<b class="notranslate">'+u+"</b>"))};l.data.push(p),console.log("Words: "+o),o=1==t?'<span class="personlink notranslate" url="'+e[a].personUri+'">'+e[a].label+"</span>: "+e[a].string.trim():e[a].string.trim()}else{var d=f(e,a);console.log("str: "+d),0==a&&1==t&&(o='<span class="personlink notranslate" url="'+e[0].personUri+'">'+e[0].label+"</span>: "),s!=c?o+=d:console.log("Else: "+d+" ("+s+" / "+c+")")}var u=e[a].target_string.trim()}p={sentence:r,words:n.trustAsHtml(o.replace(u,'<b class="notranslate">'+u+"</b>"))},l.data.push(p),o=""}return l}(e,1),p.isLoadingSentences=!1)}).then(function(){return l.getReferences(e,a).then(function(e){d===t&&(p.referenceResults=function(e){var t,a,i,s="",o={data:[]},l={data:[]},r=0,c=0;if(e.length>0){for(t in e){if(console.log(a,r),r=a,c=i,a=e[t].sentence,i=e[t].word,a!=r&&0!=r&&s.length>0){var p={sentence:r,words:n.trustAsHtml(g(s,l.data))};console.log("Translate,",e[t].label),o.data.push(p),s=e[t].string.trim(),l={data:[]}}else{var d=f(e,t);0==t&&(console.log("first",e[0]),s=""),i!=c&&(s+=d)}var u=e[t].target_string.trim(),h=e[t].personUri.trim();0==m(l.data,u,h)&&l.data.push({target_string:u,target_link:h})}p={sentence:r,words:n.trustAsHtml(g(s,l.data))},o.data.push(p),s=""}return o}(e),p.isLoadingReferences=!1)})}).then(function(){return l.getPersonName(e,a).then(function(e){d===t&&(p.label=e[0].label,p.isLoadingResults=!1)})}).then(function(){return l.getReferencesByDecade(e,a).then(function(e){d===t&&(1==e.length?0!=e[0].count&&b(e):b(e),p.isLoadingChart=!1)})}).then(function(){return l.getReferencingByDecade(e,a).then(function(e){d===t&&(1==e.length?0!=e[0].count&&v(e):v(e),p.isLoadingChart=!1)})})}(t)}function v(e){o.charts.setOnLoadCallback(function(){var t=new o.visualization.DataTable,a=s.map(e,function(e){return parseInt(e.year)}),i=s.map(e,function(e){return[e.year,parseInt(e.count)]}),n={title:"Viitatut henkilöt syntymävuoden mukaan vuosikymmenittäin",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:a},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},l=new o.visualization.ColumnChart(document.getElementById("referencing-time"));t.addColumn("string","Vuosikymmen"),t.addColumn("number","Henkilöiden lukumäärä"),t.addRows(i),l.draw(t,n)})}function b(e){o.charts.setOnLoadCallback(function(){var t=new o.visualization.DataTable,a=s.map(e,function(e){return parseInt(e.year)}),i=s.map(e,function(e){return[e.year,parseInt(e.count)]}),n={title:"Henkilöön tehdyt viittaukset muista biografioista vuosikymmenittäin (syntymävuoden perusteella)",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:a},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},l=new o.visualization.ColumnChart(document.getElementById("referenced-time"));t.addColumn("string","Vuosikymmen"),t.addColumn("number","Henkilöiden lukumäärä"),t.addRows(i),l.draw(t,n)})}t.$on("sf-facet-constraints",h)}angular.module("facetApp").controller("PersonSentencesController",e),e.$inject=["$log","$scope","$state","$stateParams","$sce","_","google","sentenceService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getResults=function(e,t){return h.getObjectsNoGrouping(r.replace("$personId",t)).then(function(e){if(e.length>0){var t=p.replace("$person_formatted_link",e[0].href);return g.getObjectsNoGrouping(t)}return{}})},this.getPersonName=function(e,t){var a={},i=c.replace("$personId",t);return a=h.getObjectsNoGrouping(i),console.log("person",a),a},this.getWordUsageResults=function(t,a){console.log("getWordUsageResults");var i={},n=d.replace("$personId",a);return this.upos.forEach(function(e){i[e.key]=g.getObjectsNoGrouping(n.replace(/<UPOS>/g,e.key)),console.log("results",i)}),console.log("results",i),e.all(i)},this.getWordCount=function(e,t){var a={},i=u.replace("$personId",t);return a=h.getObjectsNoGrouping(i),console.log("lemmaStats",a),a},this.getFacets=s.getFacets,this.getFacetOptions=function(){return angular.copy(m)},this.upos=[{key:"VERB",label:"Verbi"},{key:"NOUN",label:"Substantiivi"},{key:"ADJ",label:"Adjektiivi"},{key:"PROPN",label:"Erisnimi"}];var l=" PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX conll: <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#>  PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX schema: <http://schema.org/>  PREFIX text: <http://jena.apache.org/text#> ",r=l+"SELECT ?href {  BIND( <http://ldf.fi/nbf/$personId> as ?person)  ?person  nbf:formatted_link ?href .}",c=l+'SELECT ?label {  BIND( <http://ldf.fi/nbf/$personId> as ?id)  ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }    OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label) }',p=l+"SELECT * {  BIND( <file:///tmp/data/nlp/$person_formatted_link> as ?person)  ?target  <http://ldf.fi/nbf/biography/data#anchor_link> ?person .  ?target  nif:isString ?target_string .  ?target dct:isPartOf ?sentence .  ?word <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#sentence> ?sentence ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#WORD> ?string ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#UPOS> ?upos ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#ID> ?id ;        <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#structure> ?structure ;        <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#sentenceOrder> ?sID .  ?sentence dct:isPartOf ?paragraph .  ?paragraph <http://ldf.fi/nbf/biography/data#order> ?i .  BIND(xsd:integer(?id) as ?x)  BIND(xsd:decimal(STR(?sID)) as ?y)  BIND(xsd:integer(?i) as ?z)} ORDER BY ASC(?structure) ASC(?z) ASC(?y) ASC(?x)",d=l+' SELECT DISTINCT ?lemma (COUNT(?lemma) AS ?count) {   VALUES ?doc { <http://ldf.fi/nbf/$personId> }   ?word nif:structure/<http://ldf.fi/nbf/biography/data#docRef> ?doc .   ?word conll:UPOS "<UPOS>" .   ?word conll:LEMMA ?lemma .   FILTER(STRLEN(STR(?lemma))>2)   FILTER (regex(?lemma, "^[^.]*$")) .   FILTER (regex(?lemma, "^[^:]*$")) .   FILTER (regex(?lemma, "^[^;]*$")) .   FILTER (regex(?lemma, "^[^&]*$")) .   FILTER (regex(?lemma, "^[^,]*$")) .   FILTER (regex(?lemma, ".*(?<![.])$")) .  } GROUP BY ?lemma ORDER BY DESC(?count) LIMIT 50',u=l+" SELECT  (SUM(xsd:integer(?cnt)) AS ?count) (SUM(xsd:integer(?verb)) AS ?verbCount) (SUM(xsd:integer(?adj)) AS ?adjCount) (SUM(xsd:integer(?noun)) AS ?nounCount) (SUM(xsd:integer(?pnoun)) AS ?pnounCount) {   BIND(<http://ldf.fi/nbf/$personId> as ?id)  ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .   ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt ;      <http://ldf.fi/nbf/biography/data#verbCount> ?verb ;      <http://ldf.fi/nbf/biography/data#adjCount> ?adj ;      <http://ldf.fi/nbf/biography/data#nounCount> ?noun ;      <http://ldf.fi/nbf/biography/data#propnCount> ?pnoun . } ",f={endpointUrl:n,usePost:!0},m={endpointUrl:f.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},g=new a({endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},o),h=new a(f,o)}angular.module("facetApp").service("linguisticsService",e),e.$inject=["$q","_","AdvancedSparqlService","FacetResultHandler","SPARQL_ENDPOINT_URL","mapfacetService","objectMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r,c){var p=this;p.test="Toimii",p.hasResults=function(){return s.keys(p.results).length>0},p.removeFacetSelections=function(){a.reload()},p.upos=l.upos,l.getFacets().then(function(e){var a;p.facets=e,p.facetOptions=((a=l.getFacetOptions()).initialState=c.getFacetValuesFromUrlParams(),a),p.facetOptions.scope=t,p.handler=new r(p.facetOptions)});var d,u=t.$on("sf-initial-constraints",function(e,t){m(e,t),u()});function f(e,t,a,i,n,s){return console.log(t,"-",a,"-",i),[t,a].join("-")}function m(e,t){if(!p.previousSelections||!s.isEqual(t.constraint,p.previousSelections))return p.previousSelections=s.clone(t.constraint),c.updateUrlParams(t),function(e){p.isLoadingResults=!0,p.isLoadingWordResults=!0,p.results=[],p.error=void 0,p.test="Joo";var t=s.uniqueId();d=t;var a=i.personId;return l.getResults(e,a).then(function(e){d===t&&(p.sentenceResults=function(e){var t,a,i="",s={data:[]},o=0;for(t in e){if(o=a,(a=e[t].sentence)!=o&&0!=o&&i.length>0){var l={sentence:o,words:n.trustAsHtml(i.replace(r,"<b>"+r+"</b>"))};s.data.push(l),i=e[t].string.trim()}else i+="PUNCT"!=e[t].upos?" "+e[t].string.trim():e[t].string.trim();var r=e[t].target_string.trim()}return l={sentence:o,words:n.trustAsHtml(i.replace(r,"<b>"+r+"</b>"))},s.data.push(l),i="",s}(e),p.isLoadingResults=!1)}).then(function(){return l.getWordCount(e,a).then(function(e){d===t&&(p.lemmaCount=e[0])})}).then(function(){return l.getWordUsageResults(e,a).then(function(e){d===t&&(p.results=function(e){var t,a;for(t in console.log("lemmas",p.lemmaCount.count),e){console.log(t),console.log(e[t]);var i="VERB"==(s=t)?p.lemmaCount.verbCount:"ADJ"==s?p.lemmaCount.adjCount:"NOUN"==s?p.lemmaCount.nounCount:"PROPN"==s?p.lemmaCount.pnounCount:(console.log("Unidentifiable pos-tag",s),p.lemmaCount.count);for(a in console.log("lemma in class",i),e[t]){var n=e[t][a].lemma;console.log("lemma:",n),n.match(/^\d/)&&n.match(/[a-zäöåA-ZÄÖÅ]$/)&&(console.log("check",n.replace(/([0-9]+)([a-zäöåA-ZÄÖÅ]+)/),f),e[t][a].lemma=n.replace(/([0-9]+)([a-zäöåA-ZÄÖÅ]+)/,f)),console.log(e[t][a].count),e[t][a].percentage=(e[t][a].count/p.lemmaCount.count*100).toFixed(2),e[t][a].class_percentage=(e[t][a].count/i*100).toFixed(2)}}var s;return console.log(e),e}(e),p.isLoadingWordResults=!1)})}).then(function(){return l.getPersonName(e,a).then(function(e){d===t&&(console.log(e),p.label=e[0].label,p.isLoadingResults=!1)})})}(t)}t.$on("sf-facet-constraints",m)}angular.module("facetApp").controller("PersonLinguisticsController",e),e.$inject=["$log","$scope","$state","$stateParams","$sce","_","google","linguisticsService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i){var n=this;function s(e){n.isLoadingResults=!1,n.error=e}n.openPage=function(){t.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return n.title}}})},i.getTitle(e.titleId).then(function(e){return n.title=e[0],n.title}).catch(s)}angular.module("facetApp").controller("TitleController",e),e.$inject=["$stateParams","$uibModal","_","titleService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getTitle=function(e){var t="VALUES ?id { <"+e+"> } . ",a=l.replace("<RESULT_SET>",t);return console.log(a),r.getObjectsNoGrouping(a)},this.getResults=function(t){var a=[this.getPlace(t)];return e.all(a)};var l="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX\tnbf:\t<http://ldf.fi/nbf/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX\tgvp:\t<http://vocab.getty.edu/ontology#>\t PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\trelations:\t<http://ldf.fi/nbf/relations/> PREFIX\tsources:\t<http://ldf.fi/nbf/sources/>  SELECT distinct ?id ?label   WHERE {  \t { <RESULT_SET> }    ?id a nbf:Title ;    skos:prefLabel ?label .}",r=new i(o,s)}angular.module("facetApp").service("titleService",e),e.$inject=["$q","$location","_","AdvancedSparqlService","FacetResultHandler","objectMapperService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.cy=null,c.elems={},c.message="",c.dict={},c.loading=!1,c.showlegend=!1,c.showWindow=function(){c.window.show=!0},c.closeWindow=function(){c.window.show=!1},c.COLORS=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC","#999"],c.LIMITOPTIONS=[{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:2e3,label:"2000"},{value:5e3,label:"5000"},{value:1e4,label:"10000"},{value:1e6,label:"ei rajaa"}],c.searchlimit=c.LIMITOPTIONS[3],c.changelimit=function(){t.search("limit",c.searchlimit.value),m({constraint:c.previousSelections})},c.SIZEOPTIONS=[{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],c.textsize=c.SIZEOPTIONS[2],c.changetextsize=function(){c&&c.cy&&c.cy.style().selector("node").style("font-size",c.textsize.value).update()},c.POINTSIZEOPTIONS=[{value:5,label:"5"},{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"}],c.pointsize=c.POINTSIZEOPTIONS[2],c.changepointsize=function(){c&&c.cy&&c.cy.style().selector("node").style("width",c.pointsize.value).style("height",c.pointsize.value).update()},c.COLOROPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun väri määräytyy"},{value:"Sukupuoli",tooltip:"Henkilöt väritetään sukupuolen mukaan."},{value:"Toimiala",tooltip:"Henkilöt väritetään tietokannassa ilmoitetun toimialan mukaan."}],c.coloroption=c.COLOROPTIONS[0],c.changecolor=function(){var e,a=c.COLOROPTIONS.indexOf(c.coloroption);switch(a>-1&&t.search("coloroption",a),c.showlegend=!1,c.coloroption){case c.COLOROPTIONS[1]:h(c.elems,"gender","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[2]:h(c.elems,"category","color"),e="data(color)",c.showlegend=!0;break;default:e=c.COLORS[0]}c.cy.style().selector("node").style("background-color",e).update()};var p=t.search();if(p.limit){var d=parseInt(p.limit);c.LIMITOPTIONS.forEach(function(e,t){d==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}p.coloroption&&(c.coloroption=c.COLOROPTIONS[parseInt(p.coloroption)]),c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var u=e.$on("sf-initial-constraints",function(e,t){f(e,t),u()});function f(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),m(t)}function m(e){c.error=void 0,c.cy&&c.cy.elements().remove(),c.cy=null,c.message="",c.loading=!0;var t=n.uniqueId();return t,s.getCloudNodes(e,c.searchlimit.value).then(function(e){if(c.loading=!1,e.length<1)return c.message="Asetuksilla ei löydy näytettävää verkostoa.",void(c.messagecolor="red");c.elems.nodes=e.map(function(e){return{data:e,position:{x:36*parseFloat(e.x),y:36*parseFloat(e.y)}}}),c.elems.edges=[],c.elems.nodes.length,c.searchlimit.value,c.message="Näytetään {} henkilöä".replace("{}",c.elems.nodes.length),function(e){var t=[{selector:"node",style:{shape:"ellipse",height:"20",width:"20","font-size":e.textsize.value,"text-valign":"center","text-halign":"right",content:"data(label)","background-color":e.COLORS[0],color:"#888"}},{selector:":active",style:{"background-color":"#800",color:"#000"}},{selector:"edge",style:{width:1,"line-color":"#999","curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"#999"}}];e.cy=cytoscape({container:document.getElementById("networkcontainer"),elements:e.elems,wheelSensitivity:.2,layout:{name:"preset",fit:!0},style:t}),e.cy.on("click","node",function(e){document.body.style.cursor="auto",a.go("person.network",{personId:this.id().replace(/^.+?(p[0-9]+)$/,"$1")})}),e.cy.on("mouseover","node",function(e){document.body.style.cursor="pointer"}),e.cy.on("mouseout","node",function(e){document.body.style.cursor="auto"}),e.changecolor(),e.changesize(),e.cy.panzoom&&e.cy.panzoom({})}(c)}).catch(g)}function g(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",f),s.getFacets().then(function(t){var a;c.facets=t,c.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)});var h=function(e,t,a){var i={};e.nodes.forEach(function(e){var a=""+e.data[t];i.hasOwnProperty(a)||(i[a]=0),i[a]++});var n=[];for(var s in i)n.push({count:i[s],label:s});n.sort(function(e,t){return t.count-e.count}),i={},n.forEach(function(e,t){i[e.label]=t<c.COLORS.length?c.COLORS[t]:c.COLORS[c.COLORS.length-1]}),c.legend=n.map(function(e,t){return{label:""+e.label=="undefined"?"ei tiedossa":e.label,color:c.COLORS[t]}});var o=c.COLORS.length;c.legend.length>o&&(c.legend=c.legend.slice(0,o),c.legend[o-1].label="muut"),e.nodes.forEach(function(e){var n=e.data[t];e.data[a]=i[n]})}}angular.module("facetApp").controller("PointcloudController",e),e.$inject=["$scope","$location","$state","$uibModal","_","networkService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.cy=null,c.elems={},c.message="",c.dict={},c.loading=!1,c.showlegend=!1,c.showWindow=function(){c.window.show=!0},c.closeWindow=function(){c.window.show=!1},c.COLORS=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC","#999"],c.LIMITOPTIONS=[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:1e6,label:"ei rajaa"}],c.searchlimit=c.LIMITOPTIONS[3],c.changelimit=function(){t.search("limit",c.searchlimit.value),m({constraint:c.previousSelections})},c.CLASSTYPES=[{type:"0",check:!0,value:"nbf:ManualAnnotation",label:"Aineistoon käsin kirjatut linkit",tooltip:"Verkostossa näytetään käsin kirjatut linkit"},{type:"1",check:!0,value:"nbf:AutomaticAnnotation",label:"Automaattisesti tunnistetut linkit",tooltip:"Verkostossa näytetään automaattisesti päätellyt linkit"}],c.linkoptions=c.CLASSTYPES[0],c.changeclass=function(){c.CLASSTYPES.every(function(e){return!e.check})&&(c.CLASSTYPES[0].check=!0),m({constraint:c.previousSelections})},c.SIZEOPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun koko määräytyy"},{value:"Asteluku",tooltip:"Asteluku (degree) tarkoittaa henkilöstä lähtevien ja saapuvien linkkien kokonaismäärää."},{value:"Tuloaste",tooltip:"Tuloaste (indegree) tarkoittaa henkilöön saapuvien linkkien lukumäärää."},{value:"Lähtöaste",tooltip:"Lähtöaste (outdegree) tarkoittaa henkilöstä lähtevien linkkien lukumäärää."},{value:"Pagerank",tooltip:"Pagerank-algoritmi mittaa henkilön keskeisyyttä verkostossa."}],c.sizeoption=c.SIZEOPTIONS[1],c.changesize=function(){var e=c.SIZEOPTIONS.indexOf(c.sizeoption);e>-1&&t.search("sizeoption",e);var a="20 px";switch(c.sizeoption){case c.SIZEOPTIONS[1]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.degree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[2]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.indegree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[3]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.outdegree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[4]:var i=c.cy.elements().pageRank();c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id),a=i.rank(t);e.data.pagerank=a}),v(c.elems,"pagerank","size",10,50),a="data(size)"}c.cy.style().selector("node").style("height",a).style("width",a).update()},c.COLOROPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun väri määräytyy"},{value:"Sukupuoli",tooltip:"Henkilöt väritetään sukupuolen mukaan."},{value:"Toimiala",tooltip:"Henkilöt väritetään tietokannassa ilmoitetun toimialan mukaan."}],c.coloroption=c.COLOROPTIONS[0],c.changecolor=function(){var e,a=c.COLOROPTIONS.indexOf(c.coloroption);switch(a>-1&&t.search("coloroption",a),c.showlegend=!1,c.coloroption){case c.COLOROPTIONS[1]:h(c.elems,"gender","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[2]:h(c.elems,"category","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[3]:var i=c.cy.elements().dijkstra({root:c.cy.getElementById(c.id)});c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.dijkstra=i.distanceTo(t)}),h(c.elems,"dijkstra","color"),e="data(color)";break;default:e=c.COLORS[0]}c.cy.style().selector("node").style("background-color",e).update()};var p=t.search();if(p.limit){var d=parseInt(p.limit);c.LIMITOPTIONS.forEach(function(e,t){d==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}p.coloroption&&(c.coloroption=c.COLOROPTIONS[parseInt(p.coloroption)]),p.sizeoption&&(c.sizeoption=c.SIZEOPTIONS[parseInt(p.sizeoption)]),c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var u=e.$on("sf-initial-constraints",function(e,t){f(e,t),u()});function f(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),m(t)}function m(e){c.error=void 0,c.cy&&c.cy.elements().remove(),c.cy=null,c.message="",c.loading=!0;var t=n.uniqueId();t;var i="";return c.CLASSTYPES[0].check&&(i+=c.CLASSTYPES[0].value+" "),c.CLASSTYPES[1].check&&(i+=c.CLASSTYPES[1].value+" "),s.getGroupLinks(e,c.searchlimit.value,i).then(function(e){if(e.length<1)return c.loading=!1,c.message="Asetuksilla ei löydy näytettävää verkostoa.",void(c.messagecolor="red");e.forEach(function(e){let t=parseInt(e.weight);e.weight=t>5?5:t}),c.elems.edges=e.map(function(e){return{data:e}});var t={},i="";e.forEach(function(e){t[e.source.replace("http://ldf.fi/nbf/","nbf:")]=!0,t[e.target.replace("http://ldf.fi/nbf/","nbf:")]=!0});for(let e in t)i+=e+" ";return s.getNodesForPeople(i).then(function(e){c.elems.nodes=e.map(function(e){return{data:e}}),function(e){var t=[{selector:"node",style:{shape:"ellipse",height:"20",width:"20","text-valign":"center","text-halign":"right",content:"data(label)","background-color":e.COLORS[0],color:"#888"}},{selector:":active",style:{"background-color":"#800",color:"#000"}},{selector:"edge",style:{width:"data(weight)","line-color":"#999","curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"#999"}}];e.cy=cytoscape({container:document.getElementById("networkcontainer"),elements:e.elems,wheelSensitivity:.2,layout:{name:"circle"},style:t}),e.cy.on("click","node",function(e){document.body.style.cursor="auto",a.go("person.network",{personId:this.id().replace(/^.+?(p[0-9]+)$/,"$1")})}),e.cy.on("mouseover","node",function(e){document.body.style.cursor="pointer"}),e.cy.on("mouseout","node",function(e){document.body.style.cursor="auto"}),e.changecolor(),e.changesize(),e.cy.layout({name:"cose",idealEdgeLength:100,nodeOverlap:20,refresh:20,fit:!0,padding:30,randomize:!1,componentSpacing:100,nodeRepulsion:4e5,edgeElasticity:100,nestingFactor:5,gravity:80,numIter:800,initialTemp:200,coolingFactor:.95,minTemp:1}).run(),e.cy.panzoom&&e.cy.panzoom({})}(c),c.loading=!1,c.elems.edges.length==c.searchlimit.value?c.message="Näytetään {} ensimmäistä linkkiä ja {2} henkilöä".replace("{}",c.searchlimit.value).replace("{2}",c.elems.nodes.length):c.message="Näytetään {} linkkiä ja {2} henkilöä".replace("{}",c.elems.edges.length).replace("{2}",c.elems.nodes.length)}).catch(g)}).catch(g)}function g(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",f),s.getFacets().then(function(t){var a;c.facets=t,c.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)});var h=function(e,t,a){var i={};e.nodes.forEach(function(e){var a=""+e.data[t];i.hasOwnProperty(a)||(i[a]=0),i[a]++});var n=[];for(var s in i)n.push({count:i[s],label:s});n.sort(function(e,t){return t.count-e.count}),i={},n.forEach(function(e,t){i[e.label]=t<c.COLORS.length?c.COLORS[t]:c.COLORS[c.COLORS.length-1]}),c.legend=n.map(function(e,t){return{label:""+e.label=="undefined"?"ei tiedossa":e.label,color:c.COLORS[t]}});var o=c.COLORS.length;c.legend.length>o&&(c.legend=c.legend.slice(0,o),c.legend[o-1].label="muut"),e.nodes.forEach(function(e){var n=e.data[t];e.data[a]=i[n]})},v=function(e,t,a,i,n){if(!(e.nodes.length<1)){var s=e.nodes[0].data[t],o=s;e.nodes.forEach(function(e){var a=e.data[t];a<s&&(s=a),o<a&&(o=a)}),s==o&&(o+=1);var l=(n-i)/(o-s),r=i-s/(o-s)*(n-i);e.nodes.forEach(function(e){var i=e.data[t];e.data[a]=i*l+r})}}}angular.module("facetApp").controller("NetworkController",e),e.$inject=["$scope","$location","$state","$uibModal","_","networkService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,l,r){var c=this;c.cy=null,c.elems={},c.message="",c.dict={},c.loading=!1,c.showlegend=!1,c.showWindow=function(){c.window.show=!0},c.closeWindow=function(){c.window.show=!1},c.COLORS=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC","#999"],c.LIMITOPTIONS=[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:1e6,label:"ei rajaa"}],c.searchlimit=c.LIMITOPTIONS[3],c.changelimit=function(){t.search("limit",c.searchlimit.value),m({constraint:c.previousSelections})},c.CLASSTYPES=[{type:"0",check:!0,value:"nbf:ManualAnnotation",label:"Aineistoon käsin kirjatut linkit",tooltip:"Verkostossa näytetään käsin kirjatut linkit"},{type:"1",check:!0,value:"nbf:AutomaticAnnotation",label:"Automaattisesti tunnistetut linkit",tooltip:"Verkostossa näytetään automaattisesti päätellyt linkit"}],c.linkoptions=c.CLASSTYPES[0],c.changeclass=function(){c.CLASSTYPES.every(function(e){return!e.check})&&(c.CLASSTYPES[0].check=!0),m({constraint:c.previousSelections})},c.SIZEOPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun koko määräytyy"},{value:"Asteluku",tooltip:"Asteluku (degree) tarkoittaa henkilöstä lähtevien ja saapuvien linkkien kokonaismäärää."},{value:"Tuloaste",tooltip:"Tuloaste (indegree) tarkoittaa henkilöön saapuvien linkkien lukumäärää."},{value:"Lähtöaste",tooltip:"Lähtöaste (outdegree) tarkoittaa henkilöstä lähtevien linkkien lukumäärää."},{value:"Pagerank",tooltip:"Pagerank-algoritmi mittaa henkilön keskeisyyttä verkostossa."}],c.sizeoption=c.SIZEOPTIONS[1],c.changesize=function(){var e=c.SIZEOPTIONS.indexOf(c.sizeoption);e>-1&&t.search("sizeoption",e);var a="20 px";switch(c.sizeoption){case c.SIZEOPTIONS[1]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.degree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[2]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.indegree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[3]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.outdegree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[4]:var i=c.cy.elements().pageRank();c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id),a=i.rank(t);e.data.pagerank=a}),v(c.elems,"pagerank","size",10,50),a="data(size)"}c.cy.style().selector("node").style("height",a).style("width",a).update()},c.COLOROPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun väri määräytyy"},{value:"Sukupuoli",tooltip:"Henkilöt väritetään sukupuolen mukaan."},{value:"Toimiala",tooltip:"Henkilöt väritetään tietokannassa ilmoitetun toimialan mukaan."}],c.coloroption=c.COLOROPTIONS[0],c.changecolor=function(){var e,a=c.COLOROPTIONS.indexOf(c.coloroption);switch(a>-1&&t.search("coloroption",a),c.showlegend=!1,c.coloroption){case c.COLOROPTIONS[1]:h(c.elems,"gender","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[2]:h(c.elems,"category","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[3]:var i=c.cy.elements().dijkstra({root:c.cy.getElementById(c.id)});c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.dijkstra=i.distanceTo(t)}),h(c.elems,"dijkstra","color"),e="data(color)";break;default:e=c.COLORS[0]}c.cy.style().selector("node").style("background-color",e).update()};var p=t.search();if(p.limit){var d=parseInt(p.limit);c.LIMITOPTIONS.forEach(function(e,t){d==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}p.coloroption&&(c.coloroption=c.COLOROPTIONS[parseInt(p.coloroption)]),p.sizeoption&&(c.sizeoption=c.SIZEOPTIONS[parseInt(p.sizeoption)]),c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var u=e.$on("sf-initial-constraints",function(e,t){f(e,t),u()});function f(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),l.updateUrlParams(t),m(t)}function m(e){c.error=void 0,c.cy&&c.cy.elements().remove(),c.cy=null,c.message="",c.loading=!0;var t=n.uniqueId();t;return c.CLASSTYPES[0].check&&c.CLASSTYPES[0].value+" ",c.CLASSTYPES[1].check&&c.CLASSTYPES[1].value+" ",s.getGroupRelatives(e,c.searchlimit.value).then(function(e){if(e.length<1)return c.loading=!1,c.message="Asetuksilla ei löydy näytettävää verkostoa.",void(c.messagecolor="red");e.forEach(function(e){e.weight=1}),c.elems.edges=e.map(function(e){return{data:e}});var t={},i="";e.forEach(function(e){t[e.source.replace("http://ldf.fi/nbf/","nbf:")]=!0,t[e.target.replace("http://ldf.fi/nbf/","nbf:")]=!0});for(let e in t)i+=e+" ";return s.getNodesForPeople(i).then(function(e){c.elems.nodes=e.map(function(e){return{data:e}}),function(e){var t=[{selector:"node",style:{shape:"ellipse",height:"20",width:"20","text-valign":"center","text-halign":"right",content:"data(label)","background-color":e.COLORS[0],color:"#888"}},{selector:":active",style:{"background-color":"#800",color:"#000"}},{selector:"edge",style:{width:"data(weight)","line-color":"#999","curve-style":"bezier",content:"data(label)","target-arrow-shape":"triangle","target-arrow-color":"#999",color:"#555","font-size":"9","text-valign":"top","text-halign":"center","edge-text-rotation":"autorotate","text-background-opacity":1,"text-background-color":"#FFF","text-background-shape":"roundrectangle"}}];e.cy=cytoscape({container:document.getElementById("networkcontainer"),elements:e.elems,wheelSensitivity:.2,layout:{name:"circle"},style:t}),e.cy.on("click","node",function(e){document.body.style.cursor="auto",a.go("person.network",{personId:this.id().replace(/^.+?(p[0-9]+)$/,"$1")})}),e.cy.on("mouseover","node",function(e){document.body.style.cursor="pointer"}),e.cy.on("mouseout","node",function(e){document.body.style.cursor="auto"}),e.changecolor(),e.changesize(),e.cy.layout({name:"cose",idealEdgeLength:100,nodeOverlap:20,refresh:20,fit:!0,padding:30,randomize:!1,componentSpacing:100,nodeRepulsion:4e5,edgeElasticity:100,nestingFactor:5,gravity:80,numIter:800,initialTemp:200,coolingFactor:.95,minTemp:1}).run(),e.cy.panzoom&&e.cy.panzoom({})}(c),c.loading=!1,c.elems.edges.length==c.searchlimit.value?c.message="Näytetään {} ensimmäistä linkkiä ja {2} henkilöä".replace("{}",c.searchlimit.value).replace("{2}",c.elems.nodes.length):c.message="Näytetään {} linkkiä ja {2} henkilöä".replace("{}",c.elems.edges.length).replace("{2}",c.elems.nodes.length)}).catch(g)}).catch(g)}function g(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",f),s.getFacets().then(function(t){var a;c.facets=t,c.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)});var h=function(e,t,a){var i={};e.nodes.forEach(function(e){var a=""+e.data[t];i.hasOwnProperty(a)||(i[a]=0),i[a]++});var n=[];for(var s in i)n.push({count:i[s],label:s});n.sort(function(e,t){return t.count-e.count}),i={},n.forEach(function(e,t){i[e.label]=t<c.COLORS.length?c.COLORS[t]:c.COLORS[c.COLORS.length-1]}),c.legend=n.map(function(e,t){return{label:""+e.label=="undefined"?"ei tiedossa":e.label,color:c.COLORS[t]}});var o=c.COLORS.length;c.legend.length>o&&(c.legend=c.legend.slice(0,o),c.legend[o-1].label="muut"),e.nodes.forEach(function(e){var n=e.data[t];e.data[a]=i[n]})},v=function(e,t,a,i,n){if(!(e.nodes.length<1)){var s=e.nodes[0].data[t],o=s;e.nodes.forEach(function(e){var a=e.data[t];a<s&&(s=a),o<a&&(o=a)}),s==o&&(o+=1);var l=(n-i)/(o-s),r=i-s/(o-s)*(n-i);e.nodes.forEach(function(e){var i=e.data[t];e.data[a]=i*l+r})}}}angular.module("facetApp").controller("NetworkRelativeController",e),e.$inject=["$scope","$location","$state","$uibModal","_","networkService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getLinks=function(e,t){var a=r+c.replace(/<RESULT_SET>/g,e).replace("<CLASSES>",t);return g.getObjectsNoGrouping(a)},this.getNodes=function(e,t,a){/^p[0-9]+$/.test(e)&&(e="http://ldf.fi/nbf/"+e);var i="<{}>".replace("{}",e),n=r+u.replace(/<RESULT_SET>/g,i).replace("<LIMIT>",""+t).replace("<CLASSES>",a);return g.getObjectsNoGrouping(n)},this.getGroupLinks=function(e,t,a){var i=e.constraint.join(" "),n=i.replace("?id ","?id2 "),s=r+p.replace(/<RESULT_SET>/g,i).replace(/<RESULT_SET2>/g,n).replace("<LIMIT>",t).replace("<CLASSES>",a);return g.getObjectsNoGrouping(s)},this.getNodesForPeople=function(e){var t=r+f.replace(/<RESULT_SET>/g,e);return g.getObjectsNoGrouping(t)},this.getCloudNodes=function(e,t){var a=e.constraint.join(" "),i=r+m.replace(/<RESULT_SET>/g,a).replace("<LIMIT>",t);return g.getObjectsNoGrouping(i)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return l},this.getGroupRelatives=function(e,t){var a=e.constraint.join(" "),i=r+d.replace(/<RESULT_SET>/g,a).replace("<LIMIT>",t);return g.getObjectsNoGrouping(i)};var l={endpointUrl:{endpointUrl:i,usePost:!0}.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},r="PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX nbf: <http://ldf.fi/nbf/> PREFIX owl: <http://www.w3.org/2002/07/owl#> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#> PREFIX skos: <http://www.w3.org/2004/02/skos/core#> PREFIX schema: <http://schema.org/> PREFIX rels: <http://ldf.fi/nbf/relations/> PREFIX bioc:  <http://ldf.fi/schema/bioc/> PREFIX foaf: <http://xmlns.com/foaf/0.1/> ",c="SELECT distinct ?source ?target (SUM(?w) AS ?weight) WHERE {  VALUES ?type { <CLASSES> }  VALUES ?source { <RESULT_SET> }  VALUES ?target { <RESULT_SET> }  ?source  nbf:refers [ nbf:target ?target ;                    nbf:type ?type ;                    nbf:weight ?w ]   FILTER (?source!=?target) . } GROUP BY ?source ?target",p="SELECT distinct (?id AS ?source) (?id2 AS ?target) (SUM(?w) AS ?weight) WHERE {   VALUES ?type { <CLASSES> }   { <RESULT_SET> }  { <RESULT_SET2> }  ?id nbf:refers [ nbf:target ?id2 ;                    nbf:type ?type ;                    nbf:weight ?w ] } GROUP BY ?id ?id2 LIMIT <LIMIT> ",d='SELECT distinct ?source ?target ?label WHERE {   { <RESULT_SET> }   ?id (bioc:has_family_relation/bioc:inheres_in/owl:sameAs*){,2} ?source .    ?source bioc:has_family_relation  [ bioc:inheres_in/owl:sameAs* ?target ;                                   a/skos:prefLabel ?label ]      FILTER NOT EXISTS { ?source owl:sameAs [] . ?target owl:sameAs [] }   FILTER EXISTS { ?target skosxl:prefLabel [] . ?source skosxl:prefLabel [] }   FILTER (?source != ?target)   FILTER (lang(?label)="fi")   } LIMIT <LIMIT> ',u='SELECT distinct ?id ?label ?gender (sample(?cats) AS ?category)  WHERE {    \tVALUES ?type { <CLASSES> }   VALUES ?source { <RESULT_SET> }   GRAPH nbf:links {     {  VALUES ?id { <RESULT_SET> }        BIND (0 AS ?level) }     UNION     { ?source nbf:refers [ nbf:target ?id ; nbf:type ?type ] . BIND (1 AS ?level) }     UNION     { ?id nbf:refers [ nbf:target ?source ; nbf:type ?type ] . BIND (1 AS ?level) }     UNION     { ?source nbf:refers/nbf:target/nbf:refers [ nbf:target ?id ; nbf:type ?type ] . BIND (2 AS ?level)}   }   ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }    OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label)    ?id foaf:focus ?prs .    OPTIONAL { ?prs nbf:sukupuoli ?gender }    OPTIONAL { ?prs nbf:has_category/skos:prefLabel ?cats } } GROUP BY ?level ?id ?label ?gender ORDER BY ?level LIMIT <LIMIT> ',f='SELECT distinct ?id ?label ?gender (sample(?cats) AS ?category)  WHERE {   VALUES ?id { <RESULT_SET> }   ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }    OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label)    ?id foaf:focus ?prs .    OPTIONAL { ?prs nbf:sukupuoli ?gender }    OPTIONAL { ?prs nbf:has_category/skos:prefLabel ?cats } }  GROUP BY ?id ?label ?gender ',m='PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX nbf: <http://ldf.fi/nbf/> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#> PREFIX skos: <http://www.w3.org/2004/02/skos/core#> PREFIX schema: <http://schema.org/> PREFIX foaf: <http://xmlns.com/foaf/0.1/>  SELECT distinct ?id ?x ?y ?label ?gender (sample(?cats) AS ?category) WHERE { \t{ <RESULT_SET> } \t?id skosxl:prefLabel ?id__label ;      nbf:coordinate [ nbf:x ?x ; nbf:y ?y ] . \tOPTIONAL { ?id__label schema:familyName ?id__fname } \tOPTIONAL { ?id__label schema:givenName ?id__gname } \tBIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label) \t?id foaf:focus ?prs . \tOPTIONAL { ?prs nbf:sukupuoli ?gender } \tOPTIONAL { ?prs nbf:has_category/skos:prefLabel ?cats } }  GROUP BY ?id ?x ?y ?label ?gender LIMIT <LIMIT> ',g=new n({endpointUrl:i,usePost:!0})}angular.module("facetApp").service("networkService",e),e.$inject=["$q","$location","_","SPARQL_ENDPOINT_URL","AdvancedSparqlService","mapfacetService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){var l=this;l.cy=null,l.elems={},l.message="",l.dict={},l.loading=!1,l.showlegend=!1,l.popover=!1,l.popx="200px",l.popy="200py",l.COLORS=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC","#999"],l.LIMITOPTIONS=[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:1e6,label:"ei rajaa"}],l.searchlimit=l.LIMITOPTIONS[1],l.changelimit=function(){t.search("limit",l.searchlimit.value),d(l.previousSelections)},l.CLASSTYPES=[{type:"0",check:!0,value:"nbf:ManualAnnotation",label:"Aineistoon käsin kirjatut linkit",tooltip:"Verkostossa näytetään käsin kirjatut linkit"},{type:"1",check:!0,value:"nbf:AutomaticAnnotation",label:"Automaattisesti tunnistetut linkit",tooltip:"Verkostossa näytetään automaattisesti päätellyt linkit"}],l.linkoptions=l.CLASSTYPES[0],l.changeclass=function(){l.CLASSTYPES.every(function(e){return!e.check})&&(l.CLASSTYPES[0].check=!0),d(l.previousSelections)},l.SIZEOPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun koko määräytyy"},{value:"Etäisyys",tooltip:"Solmujen koko määräytyy keskushenkilöön johtavan linkkipolun etäisyyden perusteella."},{value:"Asteluku",tooltip:"Asteluku (degree) tarkoittaa henkilöstä lähtevien ja saapuvien linkkien kokonaismäärää."},{value:"Tuloaste",tooltip:"Tuloaste (indegree) tarkoittaa henkilöön saapuvien linkkien lukumäärää."},{value:"Lähtöaste",tooltip:"Lähtöaste (outdegree) tarkoittaa henkilöstä lähtevien linkkien lukumäärää."},{value:"Pagerank",tooltip:"Pagerank-algoritmi mittaa henkilön keskeisyyttä verkostossa."}],l.sizeoption=l.SIZEOPTIONS[1],l.changesize=function(){var e=l.SIZEOPTIONS.indexOf(l.sizeoption);e>-1&&t.search("sizeoption",e);var a="20 px";switch(l.sizeoption){case l.SIZEOPTIONS[1]:var i=l.cy.getElementById("http://ldf.fi/nbf/"+l.id),n=l.cy.elements().dijkstra({root:i});l.elems.nodes.forEach(function(e){var t=l.cy.getElementById(e.data.id);e.data.dijkstra=-n.distanceTo(t)}),m(l.elems,"dijkstra","size",10,50),a="data(size)";break;case l.SIZEOPTIONS[2]:l.elems.nodes.forEach(function(e){var t=l.cy.getElementById(e.data.id);e.data.degree=t.degree()}),m(l.elems,"degree","size",10,50),a="data(size)";break;case l.SIZEOPTIONS[3]:l.elems.nodes.forEach(function(e){var t=l.cy.getElementById(e.data.id);e.data.degree=t.indegree()}),m(l.elems,"degree","size",10,50),a="data(size)";break;case l.SIZEOPTIONS[4]:l.elems.nodes.forEach(function(e){var t=l.cy.getElementById(e.data.id);e.data.degree=t.outdegree()}),m(l.elems,"degree","size",10,50),a="data(size)";break;case l.SIZEOPTIONS[5]:var s=l.cy.elements().pageRank();l.elems.nodes.forEach(function(e){var t=l.cy.getElementById(e.data.id),a=s.rank(t);e.data.pagerank=a}),m(l.elems,"pagerank","size",10,50),a="data(size)"}l.cy.style().selector("node").style("height",a).style("width",a).update()},l.COLOROPTIONS=[{value:"Vakio",tooltip:"Tästä voit valita miten solmun väri määräytyy"},{value:"Sukupuoli",tooltip:"Henkilöt väritetään sukupuolen mukaan."},{value:"Toimiala",tooltip:"Henkilöt väritetään tietokannassa ilmoitetun toimialan mukaan."},{value:"Etäisyys",tooltip:"Solmujen väri määräytyy keskushenkilöön johtavan linkkipolun etäisyyden perusteella."}],l.coloroption=l.COLOROPTIONS[3],l.changecolor=function(){var e,a=l.COLOROPTIONS.indexOf(l.coloroption);switch(a>-1&&t.search("coloroption",a),l.showlegend=!1,l.coloroption){case l.COLOROPTIONS[1]:f(l.elems,"gender","color"),e="data(color)",l.showlegend=!0;break;case l.COLOROPTIONS[2]:f(l.elems,"category","color"),e="data(color)",l.showlegend=!0;break;case l.COLOROPTIONS[3]:var i=l.cy.elements().dijkstra({root:l.cy.getElementById(l.id)});l.elems.nodes.forEach(function(e){var t=l.cy.getElementById(e.data.id);e.data.dijkstra=i.distanceTo(t)}),f(l.elems,"dijkstra","color"),e="data(color)";break;default:e=l.COLORS[0]}l.cy.style().selector("node").style("background-color",e).update()};var r=t.search();if(r.limit){var c=parseInt(r.limit);l.LIMITOPTIONS.forEach(function(e,t){c==e.value&&(l.searchlimit=l.LIMITOPTIONS[t])})}r.hasOwnProperty("coloroption")&&(l.coloroption=l.COLOROPTIONS[parseInt(r.coloroption)]),r.hasOwnProperty("sizeoption")&&(l.sizeoption=l.SIZEOPTIONS[parseInt(r.sizeoption)]);var p=e.$on("sf-initial-constraints",function(e,t){d(),p()});function d(){l.error=void 0,l.loading=!0,l.cy&&l.cy.elements().remove(),l.message="",l.messagecolor="blue";var e="";return l.CLASSTYPES[0].check&&(e+=l.CLASSTYPES[0].value+" "),l.CLASSTYPES[1].check&&(e+=l.CLASSTYPES[1].value+" "),l.cy=null,l.personId=n.personId,s.getNodes(n.personId,l.searchlimit.value,e).then(function(t){if(t.length<2)return l.loading=!1,l.message="Henkilölle ei löydy näytettävää verkostoa.",void(l.messagecolor="red");l.elems.nodes=t.map(function(e){return{data:e}});var i=t.map(function(e){return e.id.replace("http://ldf.fi/nbf/","nbf:")}).join(" ");return l.label=t[0].label,l.id=n.personId,s.getLinks(i,e).then(function(e){e.forEach(function(e){let t=parseInt(e.weight);e.weight=t>5?5:t}),l.elems.edges=e.map(function(e){return{data:e}}),function(e){var t=[{selector:"node",style:{shape:"ellipse",height:"20",width:"20","text-valign":"center","text-halign":"right",content:"data(label)","background-color":e.COLORS[0],color:"#888"}},{selector:":active",style:{"background-color":"#800",color:"#000"}},{selector:"edge",style:{width:"data(weight)","line-color":"#999","curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"#999"}}];e.cy=cytoscape({container:document.getElementById("networkcontainer"),elements:e.elems,wheelSensitivity:.2,layout:{name:"circle"},style:t}),e.cy.on("click","node",function(e){document.body.style.cursor="auto",a.go("person.network",{personId:this.id().replace(/^.+?(p[0-9]+)$/,"$1")})}),e.cy.on("mouseover","node",function(e){document.body.style.cursor="pointer"}),e.cy.on("mouseout","node",function(e){document.body.style.cursor="auto"}),e.changecolor(),e.changesize(),e.cy.layout({name:"cose",idealEdgeLength:100,nodeOverlap:20,refresh:20,fit:!0,padding:30,randomize:!1,componentSpacing:100,nodeRepulsion:4e5,edgeElasticity:100,nestingFactor:5,gravity:80,numIter:800,initialTemp:200,coolingFactor:.95,minTemp:1}).run(),e.cy.panzoom&&e.cy.panzoom({})}(l),l.loading=!1,l.elems.edges.length==l.searchlimit.value?l.message="Näytetään {} ensimmäistä linkkiä ja {2} henkilöä".replace("{}",l.searchlimit.value).replace("{2}",l.elems.nodes.length):l.message="Näytetään {} linkkiä ja {2} henkilöä".replace("{}",l.elems.edges.length).replace("{2}",l.elems.nodes.length)}).catch(u)}).catch(u)}function u(e){l.isLoadingResults=!1,l.error=e}e.$on("sf-facet-constraints",d),l.handler=new o({scope:e});var f=function(e,t,a){var i={};e.nodes.forEach(function(e){var a=""+e.data[t];i.hasOwnProperty(a)||(i[a]=0),i[a]++});var n=[];for(var s in i)n.push({count:i[s],label:s});n.sort(function(e,t){return t.count-e.count}),i={},n.forEach(function(e,t){i[e.label]=t<l.COLORS.length?l.COLORS[t]:l.COLORS[l.COLORS.length-1]}),l.legend=n.map(function(e,t){return{label:""+e.label=="undefined"?"ei tiedossa":e.label,color:l.COLORS[t]}});var o=l.COLORS.length;l.legend.length>o&&(l.legend=l.legend.slice(0,o),l.legend[o-1].label="muut"),e.nodes.forEach(function(e){var n=e.data[t];e.data[a]=i[n]})},m=function(e,t,a,i,n){if(!(e.nodes.length<1)){var s=e.nodes[0].data[t],o=s;e.nodes.forEach(function(e){var a=e.data[t];a<s&&(s=a),o<a&&(o=a)}),s==o&&(o+=1);var l=(n-i)/(o-s),r=i-s/(o-s)*(n-i);e.nodes.forEach(function(e){var i=e.data[t];e.data[a]=i*l+r})}}}angular.module("facetApp").controller("PersonNetworkController",e),e.$inject=["$scope","$location","$state","_","$stateParams","networkService","FacetHandler"]}(),function(){"use strict";function e(e,t,a,i,n){var s=this;s.admiralFacet='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source4>","constraint":"?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source4>."}}',s.clergyFacet='{"dataset":{"value":"<http://ldf.fi/nbf/sources/source5>","constraint":"?id <http://purl.org/dc/terms/source> <http://ldf.fi/nbf/sources/source5>."}}',s.mapParam='{"center":{"latitude":62.64298263801266,"longitude":19.358826890587807},"zoom":4}',s.mapParam2='{"center":{"latitude":64.02327764081613,"longitude":23.53710973262787},"zoom":5}';var o=function(){new google.translate.TranslateElement({pageLanguage:"fi",layout:google.translate.TranslateElement.InlineLayout.VERTICAL},"google_translate_element")};function l(e){s.isLoadingResults=!1,s.error=e}s.strings={pageTitle:"Biografiasampo",jumboTitle:"Biografiasampo",jumboSubtitle:"Suomalaisten elämäkertojen verkosto semanttisessa webissä",generalDesc:'<a href="http://seco.cs.aalto.fi/projects/biografiasampo/">Biografiasampo</a> mahdollistaa suomalaisten historiallisten henkilöiden elämäkertojen ja henkilöryhmien tutkimisen toisiinsa linkitettyjen laajojen tietoaineistojen avulla.',ins:"Ks. ohje",followFacebook:"Liity avoimeen Semantic Biographies -ryhmään Facebookissa",localeLinkText:"In English",choosePerspective:"Valitse sovellusnäkymä aineistoihin",perspectiveTooltip:"Klikkaa käynnistääksesi sovellus",searchH:"Henkilöt",searchP:"Etsi elämäkertoja joustavasti eri näkökulmista",placesH:"Paikat",placesP:"Hae ja tutustu elämäkertoihin paikkojen kautta",mapsH:"Elämäkartat",mapsP:"Visualisoi useita elämäkertoja kartoilla",statisticsH:"Tilastot",statisticsP:"Ryhmien elämäntarinat tilastojen kautta",networksH:"Verkostot",networksP:"Tutki historiallisten henkilöiden verkostoja",relationsH:"Yhteyshaku",relationsP:"Hae henkilöiden ja paikkojen välisiä yhteyksiä",casultiesH:"Kielianalyysi",casultiesP:"Tutki elämäkerroissa käytettyä kieltä",metaDescription:"Sovelluksen avulla voi hakea, selata, visualisoida ja tutkia laajoja suomalaisiin historiallisiin henkilöihin liittyviä tietoaineistoja."},s.testing="Testing",i.getPortal().then(function(e){return o(),e}).catch(l)}angular.module("facetApp").controller("PortalController",e),e.$inject=["$stateParams","$uibModal","_","nbfService","$sce"]}(),function(){"use strict";function e(e,t){this.getPopover=function(e){var t=a+i,n="VALUES ?id2 { <"+e+"> } . ";return l.getObjectsNoGrouping(t.replace("<RESULT_SET>",n)).then(function(e){return e[0]})},this.getHrefPopover=function(e){var t='VALUES ?href { "'+e+'" } ';return l.getObjectsNoGrouping(a+n.replace("<RESULT_SET>",t)).then(function(e){return e[0]})},this.getPopoverGroup=function(e){var t="VALUES ?id2 { "+e.map(function(e){return e.match(/^p\d+$/)?"nbf:"+e:"<"+e+">"}).join(" ")+" } . ",i=a+s.replace("<RESULT_SET>",t);return l.getObjectsNoGrouping(i).then(function(e){return e})},this.getPlacePopover=function(e){/^[^/]+$/.test(e)&&(e="http://ldf.fi/nbf/places/"+e);var t="VALUES ?id { <"+(e=e.replace("/www.ldf.fi/","/ldf.fi/"))+"> } . ",i=a+o.replace("<RESULT_SET>",t);return l.getObjectsNoGrouping(i).then(function(e){return e[0]})};var a=" PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX sources:\t<http://ldf.fi/nbf/sources/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX rels: <http://ldf.fi/nbf/relations/> ",i='SELECT DISTINCT ?id ?label ?image ?lifespan  WHERE {  <RESULT_SET>   ?id2 owl:sameAs* ?id . FILTER NOT EXISTS {?id owl:sameAs []}   ?id foaf:focus ?prs .   OPTIONAL { ?prs nbf:image [ schema:image ?image1 ; dct:source ?s ] FILTER ISLITERAL(?s) }   OPTIONAL { ?prs nbf:image [ schema:image ?image2 ; dct:source sources:source10 ] }   OPTIONAL { ?prs nbf:image [ schema:image ?image3 ; dct:source/skos:prefLabel ?s ]  }   BIND (COALESCE(?image1, ?image2, ?image3) AS ?image)      OPTIONAL { ?id skosxl:prefLabel/schema:familyName ?fname . }   OPTIONAL { ?id skosxl:prefLabel/schema:givenName ?gname . }   BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)   OPTIONAL { ?id foaf:focus/^crm:P98_brought_into_life/nbf:time ?bir . ?bir gvp:estStart ?btime ; skos:prefLabel [] }   OPTIONAL { ?id foaf:focus/^crm:P100_was_death_of/nbf:time ?dea . ?dea gvp:estStart ?dtime ; skos:prefLabel [] }   BIND (CONCAT("(", COALESCE(STR(YEAR(?btime)), " "), "-", COALESCE(STR(YEAR(?dtime)), " "), ")") AS ?lifespan) } LIMIT 1 ',n='SELECT DISTINCT ?id ?label ?image ?lifespan WHERE {     { <RESULT_SET> }   ?id nbf:formatted_link ?href ;   \t\towl:sameAs*/foaf:focus ?prs .   OPTIONAL { ?prs nbf:image [ schema:image ?image1 ; dct:source ?s ] FILTER ISLITERAL(?s) }   OPTIONAL { ?prs nbf:image [ schema:image ?image2 ; dct:source sources:source10 ] }   OPTIONAL { ?prs nbf:image [ schema:image ?image3 ; dct:source/skos:prefLabel ?s ]  }   BIND (COALESCE(?image1, ?image2, ?image3) AS ?image)      OPTIONAL { ?id skosxl:prefLabel/schema:familyName ?fname . }      OPTIONAL { ?id skosxl:prefLabel/schema:givenName ?gname . }      BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)          OPTIONAL { ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime }      OPTIONAL { ?id foaf:focus/^crm:P100_was_death_of/nbf:time/gvp:estStart ?dtime }      BIND (CONCAT("(", COALESCE(STR(YEAR(?btime)), " "), "-", COALESCE(STR(YEAR(?dtime)), " "), ")") AS ?lifespan)     } LIMIT 1 ',s='SELECT DISTINCT ?id ?label ?lifespan (SAMPLE(?image0) AS ?image) WHERE {   <RESULT_SET>   ?id2 owl:sameAs* ?id .   FILTER NOT EXISTS {?id owl:sameAs []}   ?id foaf:focus ?prs .   OPTIONAL { ?prs nbf:image [ schema:image ?image1 ; dct:source ?s ] FILTER ISLITERAL(?s) }   OPTIONAL { ?prs nbf:image [ schema:image ?image2 ; dct:source sources:source10 ] }   OPTIONAL { ?prs nbf:image [ schema:image ?image3 ; dct:source/skos:prefLabel ?s ]  }   BIND (COALESCE(?image1, ?image2, ?image3) AS ?image0)   OPTIONAL { ?id skosxl:prefLabel/schema:familyName ?fname . }   OPTIONAL { ?id skosxl:prefLabel/schema:givenName ?gname . }   BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)   OPTIONAL { ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime }   OPTIONAL { ?id foaf:focus/^crm:P100_was_death_of/nbf:time/gvp:estStart ?dtime }   BIND (CONCAT("(", COALESCE(STR(YEAR(?btime)), " "), "-", COALESCE(STR(YEAR(?dtime)), " "), ")") AS ?lifespan) } GROUP BY ?id ?label ?lifespan ORDER BY UCASE(?fname) ?gname ',o='SELECT * WHERE {   <RESULT_SET>   ?id skos:prefLabel ?label .   FILTER (lang(?label)="fi")   OPTIONAL {     ?id geo:lat ?latitude .     ?id geo:long ?longitude    } } LIMIT 1 ',l=new t({endpointUrl:e,usePost:!0})}angular.module("facetApp").service("popoverService",e),e.$inject=["SPARQL_ENDPOINT_URL","AdvancedSparqlService"]}(),function(){"use strict";angular.module("facetApp").directive("kblink",function(){return{restrict:"EC",scope:{href:"@"},transclude:!0,controller:["$scope","popoverService",function(e,t){e.href&&(e.image=!1,e.lifespan="",t.getHrefPopover(e.href).then(function(t){t.length&&(t=t[0]),e.label=t.label,e.link="#!/henkilo/"+t.id.replace(/^.+?(p[0-9]+)$/,"$1"),new RegExp(/\d/).test(t.lifespan)&&(t.lifespan=t.lifespan.replace(/(\D)0/g,"$1"),e.lifespan=t.lifespan),t.hasOwnProperty("image")&&(e.image=t.image)}))}],template:'<a uib-popover-template="\'views/personTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ng-href="{{ link }}" ng-transclude></a>'}})}(),function(){"use strict";angular.module("facetApp").directive("personlink",function(){return{restrict:"EC",scope:{url:"@"},transclude:!0,controller:["$scope","popoverService",function(e,t){e.url&&(e.personId={personId:e.url.replace(/^.+?(p[0-9]+)$/,"$1")},e.image=!1,e.lifespan="",t.getPopover(e.url).then(function(t){t.length&&(t=t[0]),e.label=t.label,new RegExp(/\d/).test(t.lifespan)&&(t.lifespan=t.lifespan.replace(/(\D)0/g,"$1"),e.lifespan=t.lifespan),t.hasOwnProperty("image")&&(e.image=t.image)}))}],template:'<a uib-popover-template="\'views/personTooltipTemplate.html\'" class="notranslate" popover-trigger="\'mouseenter\'" ui-sref="person.detail({{ personId }})"><span ng-transclude></span></a>'}})}(),function(){"use strict";angular.module("facetApp").directive("placelink",function(){return{restrict:"EC",scope:{url:"@"},transclude:!0,controller:["$scope","popoverService",function(e,t){if(e.url){var a=e.url.match(/yso.fi.+?Y([^/]+)$/);if(a&&a.length)return e.link="https://finto.fi/yso-paikat/fi/page/p"+a[1],void(e.label="YSO-tietokannan paikka");e.url=e.url.replace(/^.+?([^/]+)$/,"$1"),e.placeid={placeId:e.url},e.image=!1,e.lifespan="",t.getPlacePopover(e.url).then(function(t){t&&(t.length&&(t=t[0]),e.label=t.label)})}}],template:'<a uib-popover-template="\'views/placeTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ui-sref="place({{ placeid }})"><span ng-transclude></span></a>'}})}(),function(){"use strict";angular.module("facetApp").directive("nbfPerson",function(){return{restrict:"AE",scope:{url:"@"},controller:["$scope","popoverService",function(e,t){e.link={personId:e.url.replace(/^.+?(p[0-9]+)$/,"$1")},e.image=!1,e.lifespan="",t.getPopover(e.url).then(function(t){t.length&&(t=t[0]),e.label=t.label,new RegExp(/\d/).test(t.lifespan)&&(t.lifespan=t.lifespan.replace(/(\D)0/g,"$1"),e.lifespan=t.lifespan),t.hasOwnProperty("image")&&(e.image=t.image)})}],template:'<a uib-popover-template="\'views/personTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ui-sref="person.detail({{ link }})">{{ label }}</a>'}})}(),function(){"use strict";angular.module("facetApp").directive("nbfPersonlist",function(){return{restrict:"AE",scope:{url:"@",numPerPage:"@"},controller:["$scope","popoverService",function(e,t){e.data=null,e.numPerPage||(e.numPerPage=16),t.getPopoverGroup(e.url.split(",")).then(function(t){t.forEach(function(e,t){e.link={personId:e.id.replace(/^.+?(p[0-9]+)$/,"$1")},e.lifespan=e.lifespan.replace(/(\D)0/g,"$1"),new RegExp(/\d/).test(e.lifespan)||(e.lifespan=""),e.placement=t>7?"top":"bottom"}),e.data=t,e.currentPage=1,e.maxSize=5,e.show=t.length>e.numPerPage,e.show?e.$watch("currentPage + numPerPage",function(){var t=(e.currentPage-1)*e.numPerPage,a=t+e.numPerPage;e.filteredData=e.data.slice(t,a)}):e.filteredData=e.data})}],templateUrl:"views/directive/nbf-personlist.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nbfPersongroup",function(){return{restrict:"AE",scope:{url:"@"},controller:["$scope","popoverService",function(e,t){e.people=null,t.getPopoverGroup(e.url.split(",")).then(function(t){t.forEach(function(e,t){e.link={personId:e.id.replace(/^.+?(p[0-9]+)$/,"$1")},e.lifespan=e.lifespan.replace(/(\D)0/g,"$1"),new RegExp(/\d/).test(e.lifespan)||(e.lifespan=""),e.placement=t>7?"top":"bottom"}),e.people=t})}],templateUrl:"views/directive/nbf-persongroup.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nbfBiography",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","biographyService",function(e,t){e.loadBio=function(){"false"!=e.active&&t.getBio(e.url).then(function(t){e.bio=t})}}],link:function(e,t,a,i){e.$watch("active",function(t,a){t&&e.loadBio()},!0)},templateUrl:"views/directive/nbf-biography.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nlpBiography",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","biographyService",function(e,t){e.loadBio=function(){"false"!=e.active&&t.getNlpBio(e.url).then(function(t){e.data=t})}}],link:function(e,t,a,i){e.$watch("active",function(t,a){t&&e.loadBio()},!0)},templateUrl:"views/directive/nlp-biography.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nbfIframe",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","$sce",function(e,t){e.loadBio=function(){"false"!=e.active&&(e.src=t.trustAsResourceUrl(e.url))}}],link:function(e,t,a,i){e.$watch("active",function(t,a){e.loadBio()},!0)},templateUrl:"views/directive/nbf-iframe.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("listSentences",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","$sce",function(e,t){console.log("Testing"),e.loadBio=function(){"false"!=e.active&&(e.src=t.trustAsResourceUrl(e.url))}}],link:function(e,t,a,i){e.$watch("active",function(t,a){e.loadBio()},!0)},templateUrl:"views/directive/nbf-sentence-list.directive.html"}})}(),function(){"use strict";function e(e,t){this.updateUrlParams=function(a){a=a.facets||a;var i={};t(a).forOwn(function(e,a){!e||!e.value||t.isObject(e.value)&&t.isEmpty(e.value)||(i[a]={value:e.value,constraint:e.constraint})}),i=t.isEmpty(i)?null:angular.toJson(i);e.search(this.urlparameter,i)},this.getFacetValuesFromUrlParams=function(){var a={},i=(e.search()||{})[this.urlparameter];if(!i)return a;try{i=angular.fromJson(i)}catch(t){return e.search(this.urlparameter,null),console.log("Error handling params: cannot transform to JSON format",i),a}return t.forOwn(i,function(e,t){a[t]=e}),a},this.urlparameter="facets2"}angular.module("seco.facetedSearch").service("facetUrlStateHandlerService2",e),e.$inject=["$location","_"]}(),function(){"use strict";function e(e,t,a,i,n){this.getBio=function(e){var a=s+l,i="VALUES ?bio { <"+e+"> } . ";return c.getObjectsNoGrouping(a.replace("<RESULT_SET>",i)).then(function(e){var a=e[0];return a.description&&(a.description=t.trustAsHtml(a.description)),a.source_paragraph&&(a.source_paragraph=t.trustAsHtml(a.source_paragraph)),a.lead_paragraph&&(a.lead_paragraph=t.trustAsHtml(a.lead_paragraph)),a.spouse_paragraph&&(a.spouse_paragraph=t.trustAsHtml(a.spouse_paragraph)),a})},this.getNlpBio=function(e){var t=" <"+(e=e.replace("nbf/bio","nbf/p"))+"> ",a=o+r.replace("<RESULT_SET>",t),i={PersonName:"personlink",PlaceName:"placelink",OrganizationName:"organizationlink",VocationName:"vocationlink",AnonymEntity:!1,AddressName:!1,CorporationsName:!1,EducationalOrganization:!1,ExpressionTime:!1,GeographicalLocation:!1,PoliticalLocation:!1,PoliticalOrganization:!1,MediaOrganization:!1,CultureOrganization:!1};return p.getObjectsNoGrouping(a).then(function(e){var t=[],a="",n=null,s=!1,o=[],l="";return e.forEach(function(e){var r=parseInt(e.x),c=parseInt(e.y);parseInt(e.z);t[r]||(t[r]=[]),t[r][c]||(t[r][c]=[],a="",n=null,s=!1,l&&o.push(l),l=""),e.space=!0,e.word||(e.word="–",RegExp("[0-9IVXLCDM.]").test(a)&&(e.space=!1)),RegExp("&quot;").test(e.word)&&(e.word=e.word.replace("&quot;",'"'),s=!s,e.space=s),RegExp("[&']").test(e.word)&&(e.word=e.word.replace("&amp;nbsp;"," ").replace("&amp;gt",">").replace("&amp;lt","<")),"–"==a&&RegExp("^[0-9IVXLCDM]").test(e.word)&&(e.space=!1),e.word&&RegExp("^[.,;:=!?/)}%]").test(e.word)?e.space=!1:RegExp('"').test(a)&&(e.space=!s),RegExp("[/({[]").test(a)&&(e.space=!1),e.class=!1,e.ne&&e.ne.type&&e.ne.url&&0!=i[e.ne.type]&&(e[i[e.ne.type]]=e.ne.url,e.class=!0,n&&n[i[e.ne.type]]==e.ne.url&&(n.word+=(e.space?" ":"")+e.word,a=e.word?e.word.slice(-1):"",e=null)),e&&(t[r][c].push(e),l+=(n&&e.space?" ":"")+e.word,a=e.word?e.word.slice(-1):"",n=e)}),t})};var s=" PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX sources:\t<http://ldf.fi/nbf/sources/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",o="PREFIX skos: <http://www.w3.org/2004/02/skos/core#> PREFIX bd: <http://ldf.fi/nbf/biography/data#> PREFIX dct: <http://purl.org/dc/terms/> PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX ufal: <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#> PREFIX nbfbiodata: <http://ldf.fi/nbf/biography/data#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX biog: <http://ldf.fi/nbf/biography/> ",l='SELECT DISTINCT * WHERE { { <RESULT_SET> }  OPTIONAL { ?bio dct:source ?source . ?source skos:prefLabel ?database }  OPTIONAL { ?bio nbf:authors ?author_text }  OPTIONAL { ?bio schema:dateCreated ?created }  OPTIONAL { ?bio schema:dateModified ?modified }  OPTIONAL { ?bio schema:relatedLink ?link }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "0"^^xsd:integer ; nbf:content ?lead_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "1"^^xsd:integer ; nbf:content ?description    ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "2"^^xsd:integer ; nbf:content ?family_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "3"^^xsd:integer ; nbf:content ?parent_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "4"^^xsd:integer ; nbf:content ?spouse_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "5"^^xsd:integer ; nbf:content ?child_paragraph  ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "6"^^xsd:integer ; nbf:content ?medal_paragraph  ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "7"^^xsd:integer ; nbf:content ?source_paragraph ] }} ORDER BY str(?source)',r='SELECT DISTINCT ?x ?y ?z ?word  \t(SAMPLE(?ne__types) AS ?ne__type) (SAMPLE(?ne__urls) AS ?ne__url)  WHERE {    VALUES ?id { <RESULT_SET> }    ?struc nbfbiodata:docRef ?id ;           dct:hasPart ?parag .    ?parag nbfbiodata:order ?parag_str .    BIND (xsd:integer(xsd:decimal(?parag_str)) AS ?x)    ?sent dct:isPartOf ?parag ;          nif:order ?sent_str .    BIND (xsd:integer(xsd:decimal(?sent_str)) AS ?y)    ?w nif:sentence ?sent ;       ufal:ID ?w_str .    BIND (xsd:integer(?w_str) AS ?z)    OPTIONAL { ?sent nbfbiodata:hasNamedEntity ?nes .     ?nes nif:beginIndex ?ne__begin ;          nif:endIndex ?ne__end .     FILTER (?ne__begin<=?z && ?z<=?ne__end )     ?neg <http://ldf.fi/nbf/biography/data#member> ?nes .     ?nes nbfbiodata:namedEntityType ?ne__typeurl ;          skos:relatedMatch ?ne__urls .      BIND (REPLACE(STR(?ne__typeurl), "^.*?([^/]+)$", "$1") AS ?ne__types)   }   OPTIONAL { ?w ufal:WORD ?word } } GROUP BY ?x ?y ?z ?word ORDER BY ?x ?y ?z ',c=new i({endpointUrl:a,usePost:!0},n),p=new i({endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},n)}angular.module("facetApp").service("biographyService",e),e.$inject=["$q","$sce","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),angular.module("facetApp").run(["$templateCache",function(e){"use strict";e.put("views/comparison.html",'<div class="container-fluid"> <div class="row"> \x3c!-- Connecting buttons to a controller to pass configurations  --\x3e <div style="padding: 20px" ui-view="buttons"></div> </div> <div class="row"> <div class="col-sm-6 comparison comparison-left" ui-view="left"></div> <div class="col-sm-6 comparison comparison-right" ui-view="right"></div> </div> </div>'),e.put("views/description.npl.comparison.partial.html",'<div> <div> <h1>Kielianalyysi: vertailu <span class="glyphicon glyphicon-info-sign" tooltip-placement="bottom" uib-tooltip="Näkymässä vertaillaan biografioiden sanamääriä sanaluokittain keskenään. Listalla esitetään yleisimmät sanat biografioista suhteessa kokonaissanamäärään (Kaikki). Sanaluokista esitykseen on valittu verbit, adjektiivit, substantiivit, sekä erillisnimet. Biografiajoukosta on suodatettu pois järjestysnumerot ja joitakin mahdollisia virheellisesti luokiteltuja sanoja. "> </span> </h1> </div> <div class="row comparison-title-setup"> <div></div> <div class="comparison-title-desc"> <p> Aineistosta laskettuja tilastoja. Rajaa vertailtavaa aineistoa tekemällä valintoja vasemmassa ja oikeassa reunassa olevista suodattimista. </p> </div> <div class="comparison-title-space"></div> <div class="comparison-title-examples"> \x3c!-- Adding buttons here with a title  --\x3e <div> <h4>Esimerkkivertailuja:</h4> </div> <div> <a ui-sref-active="active" class="btn btn-primary" ui-sref="nlp.comparison.sides({facets: vm.facetParam1, facets2: vm.facetParam2})">Amiraalit vs. papisto</a> <a ui-sref-active="active" class="btn btn-primary" ui-sref="nlp.comparison.sides({facets: vm.facetParam1Ex1, facets2: vm.facetParam2Ex1})">Ylioppilasmatriikkeli vs. norssit</a> <a ui-sref-active="active" class="btn btn-primary" ui-sref="nlp.comparison.sides({facets: vm.facetParam1Ex4, facets2: vm.facetParam2Ex4})">Ruotsissa syntyneet vs. Venäjällä syntyneet</a> </div> </div> </div> </div>'),e.put("views/description.npl.partial.html","<h1>Kielianalyysi</h1> <p> Aineistosta laskettuja tilastoja. <br>Rajaa aineistoa tekemällä valintoja alla olevista suodattimista. </p>"),e.put("views/description.statistics.partial.html","<h1>Tutki tilastoja</h1> <p> Aineistosta laskettuja tilastoja. <br>Rajaa aineistoa tekemällä valintoja alla olevista suodattimista. <br>Huom. kaikki tietokannat eivät sisällä esimerkiksi tietoa puolisoista tai lapsista. </p>"),e.put("views/directive/nbf-biography.directive.html",'<div class="col-sm-6 col-md-12" ng-if="!!bio"> <div ng-if="bio.database" class="entry-text text-left icon-menu"> <p> <br> <span style="font-size: 100%"> <a ng-if="bio.link" title="Artikkeli Biografiakeskuksen sivulla" ng-href="{{ bio.link }}"> \x3c!-- <span class="glyphicon glyphicon-book" aria-hidden="true"></span>  --\x3e Artikkeli Biografiakeskuksen sivulla</a> </span> </p><p> </p></div> <div ng-if="bio.lead_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="bio.lead_paragraph"></p> </div> <div ng-if="bio.description" class="entry-text text-left"> <hr> <p ng-bind-html="bio.description"></p> </div> <div ng-if="bio.family_paragraph" class="entry-text text-left"> <hr> <p>{{ bio.family_paragraph }}</p> </div> <div ng-if="bio.parent_paragraph" class="entry-text text-left"> <hr> <h4>Vanhemmat</h4> <p>{{ bio.parent_paragraph }}</p> </div> <div ng-if="bio.spouse_paragraph" class="entry-text text-left"> <hr> <h4>Puoliso(t) vanhempineen</h4> <p>{{ bio.spouse_paragraph }}</p> </div> <div ng-if="bio.child_paragraph" class="entry-text text-left"> <hr> <h4>Lapset</h4> <p>{{ bio.child_paragraph }}</p> </div> <div ng-if="bio.medal_paragraph" class="entry-text text-left"> <hr> <h4>Kunniamerkit</h4> <p>{{ bio.medal_paragraph }}</p> </div> <div ng-if="bio.source_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="bio.source_paragraph"></p> </div> <div class="entry-text text-left"> <hr> <span ng-if="bio.author_text">Kirjoittaja(t): {{ bio.author_text }}</span> <span ng-if="bio.created">Julkaistu {{ bio.created | date:\'dd.MM.yyyy\' }}</span> <span ng-if="bio.modified">(päivitetty {{ bio.modified | date:\'dd.MM.yyyy\' }})</span> </div> <hr> </div>'),e.put("views/directive/nbf-iframe.directive.html",'<div class="col-sm-6 col-md-12" ng-if="!!src"> <iframe class="externalcontent" ng-src="{{src}}" onload="loaded=true" onerror="console.log(\'on error\')" error="console.log(\'error\')"> <a href="{{src}}">{{src}}</a> </iframe> </div>'),e.put("views/directive/nbf-persongroup.directive.html",'<ul class="list-group row list-group-persons ng-scope" id="popupcontainer2"> <img ng-if="!people" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <li class="list-group-item col-xs-6 ng-scope" ng-repeat="person in people"> <a uib-popover-template="\'views/persongroupTooltipTemplate.html\'" class="notranslate" popover-trigger="\'mouseenter\'" popover-placement="{{ person.placement }}" ui-sref="person.detail({{ person.link }})">{{ person.label }}</a> </li> </ul>'),e.put("views/directive/nbf-personlist.directive.html",'<img ng-if="!data" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in filteredData"> <a uib-popover-template="\'views/persongroupTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ui-sref="person.detail({{ person.link }})"> <p class="personlist notranslate">{{ person.label }}</p> </a> </div> <ul uib-pagination ng_show="show" ng-model="currentPage" total-items="data.length" items-per-page="numPerPage" max-size="maxSize" boundary-links="true" first-text="<<" previous-text="<" next-text=">" last-text=">>"> </ul> <span ng_show="!show" style="color:white">.</span>'),e.put("views/directive/nbf-sentence-list.directive.html",'<div ng-repeat="sentences in vm.sentenceResults"> <li ng-repeat="sentence in sentences" ng-bind-html="sentence.words"></li> </div>'),e.put("views/directive/nlp-biography.directive.html",'<div class="col-sm-6 col-md-12 mapspinner" ng-show="!data"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div class="col-sm-6 col-md-12" ng-if="!!data"> <p ng-repeat="parag in data track by $index"> <span ng-repeat="sentence in parag track by $index"><span ng-repeat="x in sentence track by $index" class="nlp"><span ng-if="x.space"> </span><span ng-if="x.placelink" class="placelink" url="{{x.placelink}}">{{x.word}}</span><span ng-if="x.organizationlink" class="organizationlink">{{x.word}}</span><span ng-if="x.vocationlink" class="vocationlink">{{x.word}}</span><span ng-if="x.personlink" class="personlink" url="{{x.personlink}}">{{x.word}}</span><span ng-if="!x.class">{{x.word}}</span></span> </span> <hr> </p> </div>'),e.put("views/facets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> <seco-jena-text-facet data-options="vm.facets.entryText"></seco-jena-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <seco-basic-facet data-options="vm.facets.keywords"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.period"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.familyName"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.author"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.title"></seco-basic-facet> <seco-hierarchy-facet data-options="vm.facets.place"></seco-hierarchy-facet> </div> </div>'),e.put("views/footer.html",'<footer class="footer"> <div class="container-fluid text-center"> <hr> \x3c!-- \n\t\t<span id="google_translate_element"></span>\n\t\t --\x3e <a href="https://seco.cs.aalto.fi" style="border:0px"> <img id="seco" alt="Semantic Computing Research Group" src="https://www.ldf.fi/img/seco-logo.png" style="height:50px;padding-right:30px; border:none"></a> <a href="https://www.aalto.fi/en/"> <img id="aalto" alt="Aalto University" src="https://www.ldf.fi/img/aalto-logo.png" style="height:50px; padding-right:30px; padding-bottom:5px; border:none"></a> <a href="http://www.heldig.fi/"> <img id="heldig" alt="HELDIG - Helsinki Centre for Digital Humanities" src="http://www.ldf.fi/img/bio/heldig-text.jpg" style="height:50px; padding-right:30px; border:none"></a> <a href="https://www.helsinki.fi/en/"> <img id="aalto" alt="University of Helsinki" src="https://www.ldf.fi/img/hy-logo.gif" style="height:80px; padding-right:30px; padding-bottom:5px; border:none"></a> <a href="https://www.finlit.fi/"> <img id="sks" alt="Finnish Literature Society" src="https://www.ldf.fi/img/sks-iso.jpg" style="height:50px; padding-right:30px; border:none"></a> </div> </footer>'),e.put("views/groupmap/comparison.left.html",'<div class="row"> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/description.partial.html\'"></div> <div ng-include="\'views/groupmap/controls.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <div ng-include="\'views/groupmap/map.html\'"></div> </div> </div>'),e.put("views/groupmap/comparison.right.html",'<div class="row"> <div class="col-md-8 col-lg-9"> <div ng-include="\'views/groupmap/map.html\'"></div> </div> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/controls.partial.html\'"></div> </div> </div>'),e.put("views/groupmap/comparison2.left.html",'<div class="row"> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/description2.partial.html\'"></div> <div ng-include="\'views/groupmap/controls2.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <div ng-include="\'views/groupmap/map2.html\'"></div> </div> </div>'),e.put("views/groupmap/comparison2.right.html",'<div class="row"> <div class="col-md-8 col-lg-9"> <div ng-include="\'views/groupmap/map2.html\'"></div> </div> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/controls2.partial.html\'"></div> </div> </div>'),e.put("views/groupmap/controls.partial.html",'<span ng-if="vm.message" style="color:blue">{{ vm.message }}<br><br></span> <div class="well well-sm"> <b>Tapahtumatyypit</b> <form name="eventForm" class="eventForm" ng-repeat="type in vm.EVENTTYPES"> <label title="{{ type.tooltip }}" style="color: {{ type.color }}"> <input type="checkbox" ng-model="type.check" ng-change="vm.change()"> <span>{{ type.label }}</span> </label><br> </form> Näytä kartalla korkeintaan <select ng-model="vm.searchlimit" ng-options="item.value for item in vm.LIMITOPTIONS" ng-change="vm.change()"> </select> tulosta. </div> <div ng-include="\'views/mapfacets.partial.html\'"></div>'),e.put("views/groupmap/controls2.partial.html",'Näytä kartalla kor&shy;keintaan <select ng-model="vm.searchlimit" ng-options="item.value for item in vm.LIMITOPTIONS" ng-change="vm.change()"> </select> tulosta. <br> <span ng-if="vm.message" style="color:blue">{{ vm.message }}<br><br></span> <div ng-include="\'views/mapfacets.partial.html\'"></div>'),e.put("views/groupmap/description.partial.html",'<div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <h1>Tutki elämä&shy;ker&shy;to&shy;ja kar&shy;toilla</h1> <p> Kartalla näytetään henki&shy;löiden elin&shy;aikai&shy;sia tapah&shy;tumia. Ala&shy;puo&shy;lei&shy;silla suodat&shy;ti&shy;milla voi&shy;daan valita halu&shy;tut tapah&shy;tuma&shy;tyypit ja henkilö&shy;ryhmä. </p> <p> Klikkaamalla ympyrää kartalla auke&shy;aa ikkuna, jossa näytetään lista hen&shy;ki&shy;löistä, joilla on paikkaan liit&shy;tyviä tapahtumia. </p>'),e.put("views/groupmap/description2.partial.html",'<div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <h1>Tutki elämä&shy;ker&shy;toja kar&shy;toilla</h1> <p> Kartalla yhdistetään henki&shy;löiden <span style="color:blue">synnyin-</span> ja <span style="color:red">kuolin</span>paikat nuolilla. Jos paikka on sama, esite&shy;tään se ympy&shy;ränä. Ala&shy;puolei&shy;silla suodat&shy;ti&shy;milla voidaan rajata haluttu henkilö&shy;ryhmä. </p> <p> Klikkaamalla nuolia ja ympyröitä kar&shy;tal&shy;la aukeaa ikkuna, jossa näy&shy;te&shy;tään lista henkilöistä, joilla on paik&shy;kaan liittyviä tapahtumia. </p>'),e.put("views/groupmap/map.html",'<div class="col-sm-12 mapspinner" ng-show="vm.isLoadingResults"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom" events="vm.mapevents"> <ui-gmap-window id="ui-gmap-window" show="vm.window.show" options="vm.window" templateurl="\'views/groupmap/popup.html\'" templateparameter="vm" closeclick="vm.closeWindow"> <span></span> </ui-gmap-window> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options" click="marker.onClick()"> </ui-gmap-marker> </ui-gmap-google-map>'),e.put("views/groupmap/map2.html",'<div class="col-sm-12 mapspinner" ng-show="vm.isLoadingResults && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom" events="vm.mapevents"> <ui-gmap-window id="ui-gmap-window" show="vm.window.show" options="vm.window" templateurl="\'views/groupmap/popup.html\'" templateparameter="vm" closeclick="vm.closeWindow"> <span></span> </ui-gmap-window> <ui-gmap-polyline static="true" visible geodesic="true" ng-repeat="p in vm.polylines" path="p.path" stroke="p.stroke" icons="p.icons" events="p.events"> </ui-gmap-polyline> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options" click="marker.click()"> </ui-gmap-marker> </ui-gmap-google-map>'),e.put("views/groupmap/singleview.html",'<div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <div ng-include="\'views/groupmap/description.partial.html\'"></div> <div ng-include="\'views/groupmap/controls.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 mapcontent"> <div ng-include="\'views/groupmap/map.html\'"></div> </div>'),e.put("views/groupmap/singleview2.html",'<div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <div ng-include="\'views/groupmap/description2.partial.html\'"></div> <div ng-include="\'views/groupmap/controls2.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 mapcontent"> <div ng-include="\'views/groupmap/map2.html\'"></div> </div>'),e.put("views/groupmap/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="maps.singleview" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Tapahtumakartta</a> </li> <li ui-sref="maps.comparison.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>Tapahtumakarttojen vertailu</a> </li> <li ui-sref="maps.singleview2" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Elämäkartta</a> </li> <li ui-sref="maps.comparison2.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> <span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Elämäkarttojen vertailu</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/help.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10 text-left"> <h3 class="modal-title">Kansallisbiografia</h3> </div> <div class="col-xs-2"> <a href="#" ng-click="$close()" class="no-decoration btn-lg pull-right glyphicon glyphicon-remove"></a> </div> </div> </div> <div class="modal-body"> <p>Matrikkelin tietoja voi selata käyttöliittymässä käyttämällä vasemmalla olevia suodattimia. </p> <p>Hakeaksesi rekisteristä tekstihaulla, kirjoita hakutermit ylimpänä olevaan \'Haku\'-kenttään. <br>Poistaaksesi hakurajauksen, paina X-nappia hakukentän oikealla puolella.</p> <p>Jokaisella suodattimella on oma hakukenttä sekä lista suodattimen vaihtoehdoista, josta voi valita haluamansa ehdon. Valitun ehdon antamien tulosten määrä näkyy suluissa valinnan nimen perässä. Rajauksen voi poistaa valitsemalla vaihtoehdon \'-- Ei valintaa --\'.</p> <p>Kustakin suodattimesta voi valita vain yhden vaihtoehdon, jolloin henkilölistausta suodatetaan tämän vaihtoehdon perusteella. Useita eri suodattimia voi käyttää samanaikaisesti. </p> <p> <h4>Suodattimien valinta:</h4> <ol> <li>Valitse joku suodattimista ja avaa suodatin painamalla \'+\'-nappia suodattimen otsikon oikealla puolella.</li> <li>Valitse suodattimeen arvo listalta tai hae kirjoittamalla listan yllä olevaan tekstikenttään. Jos suodatinehtoa haetaan tekstikentän avulla alla oleva lista suodattimista päivittyy kirjoittaessa.</li> <li>Suodatinehdon voi valita klikkaamalla sitä listalta, tai poistaa valitsemalla \'-- Ei valintaa --\' listan alusta. </li> <li>Henkilöiden lista päivittyy suodattimien oikealla puolella.</li> <li>Tuloksia voi nyt suodattaa tarvittaessa lisää toistamalla toisella suodattimella edelliset askeleet 1-4.</li> </ol> </p> </div>'),e.put("views/index.html",'<!DOCTYPE html> <html ng-app="facetApp"> <head> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1maximum-scale=1"> <title>Yhteyshaku</title> <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"> <link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css"> <link rel="stylesheet" href="bower_components/sparql-faceter/dist/semantic-faceted-search.css"> \x3c!--<link rel="stylesheet" href="styles.css"> --\x3e <link rel="stylesheet" href="/css/front-page.css"> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"><\/script> <script src="bower_components/bootstrap/dist/js/bootstrap.min.js"><\/script> \x3c!--<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"><\/script>--\x3e \x3c!--<script src="js/front-page.js"><\/script>--\x3e <script>$(document).ready(function(){\n  \t\t$("#nav").load("views/navbar-fi.html.partial");\n    \t$("#footer").load("views/footer.html.partial") \n\t\t})<\/script> </head> <body> \x3c!--<ws-navbar></ws-navbar>--\x3e <div id="nav"></div> <div ui-view></div> <div id="footer"></div> \x3c!--<script src="bower_components/jquery/dist/jquery.min.js"><\/script>--\x3e <script src="bower_components/lodash/dist/lodash.min.js"><\/script> <script src="bower_components/angular/angular.js"><\/script> <script src="bower_components/angular-bootstrap/ui-bootstrap-tpls.min.js"><\/script> <script src="bower_components/angular-ui-router/release/angular-ui-router.js"><\/script> <script src="bower_components/angular-spinner/dist/angular-spinner.min.js"><\/script> <script src="bower_components/checklist-model/checklist-model.js"><\/script> <script src="bower_components/angular-paging-sparql-service/dist/sparql-service.js"><\/script> <script src="bower_components/sparql-faceter/dist/semantic-faceted-search.js"><\/script> <script src="bower_components/chart.js/dist/Chart.js"><\/script> <script src="bower_components/angular-chart.js/dist/angular-chart.js"><\/script> <script src="facet-app.module.js"><\/script> <script src="pahe-service.js"><\/script> <script src="authStorage.service.js"><\/script> <script src="login.service.js"><\/script> <script src="login.controller.js"><\/script> <script src="scripts/navbar.directive.js"><\/script> \x3c!--<script src="google-map-service.js"><\/script>--\x3e \x3c!--<script src="fha-google-map.directive.js"><\/script>--\x3e <script src="pahe-controller.js"><\/script> \x3c!--<script src="finds-map-controller.js"><\/script>--\x3e <script src="pahe-facet-controller.js"><\/script> <script src="filters.js"><\/script> </body> </html>'),e.put("views/login.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>Kirjaudu</h1> <div ng-show="vm.error" class="alert alert-danger" role="alert">{{ vm.error }}</div> <form> <div class="form-group"> <label for="un">Käyttäjätunnus</label> <input ng-model="vm.un" type="text" class="form-control" id="un" placeholder="Username"> </div> <div class="form-group"> <label for="pw">Salasana</label> <input ng-model="vm.pw" type="password" class="form-control" id="pw" placeholder="Password"> </div> <button ng-click="vm.login()" type="submit" class="btn btn-default">Submit</button> </form> </div> </div> </div>'),e.put("views/mapfacets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> \x3c!-- <seco-jena-text-facet data-options="vm.facets.entryText"></seco-jena-text-facet>  --\x3e <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-slider-facet data-options="vm.facets.slider"></seco-slider-facet> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.keywords"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.author"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.title"></seco-basic-facet> <seco-hierarchy-facet data-options="vm.facets.place"></seco-hierarchy-facet> <seco-hierarchy-facet data-options="vm.facets.deathplace"></seco-hierarchy-facet> </div> </div>'),e.put("views/navbar-fi.html",'<nav id="nav" class="navbar navbar-inverse"> <div class="container-fluid"> \x3c!--  HEADER --\x3e <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" ui-sref="portal" style="padding:0px 0px 10px 0px"> <span> <img width="100" height="55" src="images/bs-books-logo.a59ccdef.png"> </span> </a> \x3c!--\n      <a class="navbar-brand" href="http://www.aalto.fi/fi/" target="_self" style="padding:0px 0px 10px 0px">\n        <span>\n          <img src="images/aalto_uni_logo.9c7e54fe.png" class="logo" >\n        </span>\n      </a>\n\n      <a class="navbar-brand" href="https://www.finlit.fi/" target="_self" style="padding:0px 0px 10px 0px">\n        <span>\n          <img src="images/sks_logo.d09519b6.png" class="logo" >\n        </span>\n      </a>\n\n      <a class="navbar-brand" href="https://semanticcomputing.github.io/nbf" target="_self" style="padding:14px 0px 10px 0px">\n        <span>\n        Semanttinen kansallisbiografia\n        </span>\n      </a>\n       --\x3e </div> \x3c!--  NAVBAR CONTENT --\x3e <div class="collapse navbar-collapse" id="navbar-collapse-1"> <div ng-include="\'views/subnavbar.html\'"></div> \x3c!--\n      <ul class="nav navbar-nav">\n      \t<li><a><span class=\'glyphicon glyphicon-globe\' aria-hidden=\'true\'></span> Suomeksi</a></li>\n        <li><a onclick = "alert(\'English not upported yet\')"><span class=\'glyphicon glyphicon-globe\' aria-hidden=\'true\'></span> In English</a></li>\n\t  </ul>\n       --\x3e <ul class="nav navbar-nav navbar-right"> <li> <a ui-sref="feedback"><span class="koli-color"> <span class="glyphicon glyphicon-pencil koli-color" aria-hidden="true"> </span> Palaute</span></a> </li> <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#"><span class="koli-color"> <span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Tietoja<span class="caret"></span></span></a> <ul class="dropdown-menu"> <li><a href="https://seco.cs.aalto.fi/projects/biografiasampo#aineistot">Aineistot</a></li> <li><a href="https://www.ldf.fi/">Datapalvelu LDF.fi</a></li> <li><a href="https://seco.cs.aalto.fi/projects/biografiasampo/">Biografiasampo-projektin kotisivu</a></li> <li><a href="https://seco.cs.aalto.fi/projects/biografiasampo#yhteystiedot">Yhteystiedot</a></li> <li><a href="https://www.facebook.com/groups/514385075640669/"><img src="images/FB-f-Logo__blue_29.cec1afed.png"> Facebook-ryhmä </a></li> <li><a href="pdf/biografiasampo-rekisteriseloste.pdf" target="_self">Rekisteriseloste</a></li> </ul> </li> <li><a data-toggle="modal" data-target="#myModal" href="#"><span class="koli-color"> <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Ohje</span></a> </li> <li> <span style="text-align:right; text-height:10px" id="google_translate_element"> </span> </li> </ul> </div> </div>  </nav> <div id="myModal" class="modal fade" role="dialog"> <div class="modal-dialog"> \x3c!-- Modal content--\x3e <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal">&times;</button> <h1 class="modal-title">Biografiasammon käyttöohje</h1> </div> <div class="modal-body"> <p>Biografiasammon käyttäjiä ovat 1) ihmiset ja 2) tietokoneet.</p> <h2>Käyttö elämäkertojen tutkimiseen</h2> <p> Semanttinen kansallisbiografia tarjoaa sisältöjään loppukäyttäjälle erilaisten sovellusnäkymien kautta, joita ovat: </p> <ol class="demo-desc"> <li> <div> <span><b>Haku</b>-näkymän kautta voit hakea joustavasti elämäkertoja fasettihaun avulla.</span> </div> </li> <li> <div> <span><b>Kartat</b>-näkymän kautta voit tarkastella ja vertailla ryhmien elämäkertoja kartoilla.</span> </div> </li> <li> <div> <span><b>Paikat</b>-näkymässä voit hakea ja katsoa biografioiden tapahtumia zoomautuvilla kartoilla ml. historialliset kartat. Paikan markkeria klikkaamalla aukeaa paikan kotisivu, josta löytyy kaikki paikkaan liittyvä informaatio.</span> </div> </li> <li> <div> <span><b>Tilastot</b>-näkymän avulla voi rajata henkilöryhmiä ja tutkia ja vertailla niitä proposopografisesti tilastojen avulla.</span> </div> </li> <li> <div> <span><b>Verkostot</b>-näkymä tarjoaa työkaluja henkilöiden välisten verkostojen tutkimiseen.</span> </div> </li> <li> <div> <span><b>Yhteyshaussa</b> voi etsiä henkilöiden ja paikkojen välisiä yhteyksiä.</span> </div> </li> <li> <div> <span><b>Kielialanalyysi</b>-näkymän avulla voi rajata elämäkertoja ja tutkia niissä käytettyä kieltä.</span> </div> </li> </ol> <p> Sovellusnäkymän voi valita portaalin aloitussivulta ja aina eri näkymien sovellussivujen yläpalkista. </p> <p>Biografiasammon sisältöjä on esitelty hankken <a href="http://seco.cs.aalto.fi/projects/biografiasampo#aineistot">kotisivulla</a>. </p> <h2>Käyttö datapalveluna</h2> <p> Elämäkertoihin liittyvää metadataa on toistaiseksi saatavilla linkitettynä avoimena datana (Linked Open Data) tekijänoikeuksista johtuen vain erikseen sopimalla. Lisätietoja saa hankkeen <a href="http://seco.cs.aalto.fi/projects/biografiasampo#yhteystiedot">yhteyshenkilöiltä</a>. Dataa voidaan periaatteessa ottaa käyttöön sovelluksissa joko lähdedataa lataamalla, toiminnallisen SPARQL-rajapinnan kautta tai viittaamalla suoraan sisältökohteiden kotisivuihin. </p> <p>Aineistot on muunnettu ja harmonisoitu semanttisesti yhteentoimivaksi tietämysverkoksi (knowledge graph) semanttisen webin teknologioiden avulla Aalto-yliopiston johtamassa <a href="https://seco.cs.aalto.fi/projects/severi/">Severi-projektissa</a> osana laajempaa <a href="https://seco.cs.aalto.fi/projects/biographies/">semanttisiin elämäkertoihin</a> liittyvää tutkimustyötä. </p> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">Sulje</button> </div> </div> </div></div>'),e.put("views/network/description.network.partial.html",'<h1>Tutki ryhmiin liit&shy;tyvää verkostoa</h1> <p> Sivulla näytetään havainnekuva henkilöön liittyvästä ver&shy;kos&shy;tosta. Linkitys on luotu biografiakuvausten viittausten perusteella. Huom: osa tietokannoista kuten <em>Kenraalit ja amiraalit</em> tai <em>Suomen papisto 1800–1920</em> eivät sisällä tällaisia viittauksia. </p> <p> Verkoston solmuja voidaan siirtää hiirellä. Solmuja klikkaamalla pääset tarkastelemaan verkostoa valitun henkilön ympärillä. Alapuoleisilla valikoilla voidaan säätää verkoston laajuutta ja ulkoasua. </p> <div class="well well-sm"> <p style="color:{{vm.messagecolor}}">{{ vm.message }}</p> <br> <p>Verkostossa näytetään <form name="eventForm" class="eventForm" ng-repeat="type in vm.CLASSTYPES"> <label title="{{ type.tooltip }}"> <input type="checkbox" ng-model="type.check" ng-change="vm.changeclass()"> <span>{{ type.label }}</span> </label><br> </form> </p> <p> Näytä verkostossa korkeintaan <select ng-model="vm.searchlimit" ng-options="item.label for item in vm.LIMITOPTIONS" ng-change="vm.changelimit()"> </select> linkkiä. </p> <p> Solmujen koko: <select ng-model="vm.sizeoption" ng-options="item.value for item in vm.SIZEOPTIONS" ng-change="vm.changesize()"> </select> <span ng-if="vm.sizeoption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.sizeoption.tooltip}}" tooltip-placement="right"></span> </p> <p> Solmujen väri: <select ng-model="vm.coloroption" ng-options="item.value for item in vm.COLOROPTIONS" ng-change="vm.changecolor()"> </select> <span ng-if="vm.coloroption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.coloroption.tooltip}}" tooltip-placement="right"></span> </p> </div>'),e.put("views/network/description.pointcloud.partial.html",'<h1>Tutki ryhmiä piste&shy;pil&shy;venä</h1> <p> Sivulla näytetään havainnekuva henkilöistä pistepilvenä. Sijoittuminen on laskettu biografioiden laskennallisen samankaltaisuuden perusteella ja henkilöistä muodostuu selviä ryhmiä. </p> <p> Pisteitä voidaan siirtää hiirellä. Pistettä klikkaamalla pääset tarkastelemaan valittua henkilöä. Alapuoleisilla valikoilla voidaan säätää pistepilven laajuutta ja ulkoasua. </p> <div class="well well-sm"> <p style="color:{{vm.messagecolor}}">{{ vm.message }}</p> <p> Näytä korkeintaan <select ng-model="vm.searchlimit" ng-options="item.label for item in vm.LIMITOPTIONS" ng-change="vm.changelimit()"> </select> tulosta. </p> <p> Solmujen väri: <select ng-model="vm.coloroption" ng-options="item.value for item in vm.COLOROPTIONS" ng-change="vm.changecolor()"> </select> <span ng-if="vm.coloroption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.coloroption.tooltip}}" tooltip-placement="right"> </span> </p> <p> Pisteiden koko <select ng-model="vm.pointsize" ng-options="item.label for item in vm.POINTSIZEOPTIONS" ng-change="vm.changepointsize()"> </select> </p> <p> Tekstikoko <select ng-model="vm.textsize" ng-options="item.label for item in vm.SIZEOPTIONS" ng-change="vm.changetextsize()"> </select> </p> </div>'),e.put("views/network/network.html",'\x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <br> <div ng-include="\'views/network/description.network.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail mapcontent"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="networkcontainer" class="container fill"></div> <div class="cytolegend"> <div class="well well-sm" ng-if="vm.showlegend"> <br> <p ng-if="vm.legend" ng-repeat="item in vm.legend"> <span class="legenddot" style="background-color: {{item.color}}"></span> {{item.label}} </p> </div> </div> \x3c!-- popover not used here because it prevents the nodes of being dragged\n\t\t\t<span class="pop-availability personlink" ng-if="vm.popover" ng-style="{\'top\': vm.popy,\'left\': vm.popx}"  url="{{ vm.current }}">\n\t\t\t\t<img src="images/empty80.png"></img>\n\t\t\t</span>\n\t\t\t --\x3e </div>'),e.put("views/network/pointcloud.html",'\x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <br> <div ng-include="\'views/network/description.pointcloud.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail mapcontent"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="networkcontainer" class="container fill"></div> <div class="cytolegend"> <div class="well well-sm" ng-if="vm.showlegend"> <br> <p ng-if="vm.legend" ng-repeat="item in vm.legend"> <span class="legenddot" style="background-color: {{item.color}}"></span> {{item.label}} </p> </div> </div> </div>'),e.put("views/network/relativeNetwork.html",'\x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <br> <div ng-include="\'views/network/description.network.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail mapcontent"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="networkcontainer" class="container fill"></div> <div class="cytolegend"> <div class="well well-sm" ng-if="vm.showlegend"> <br> <p ng-if="vm.legend" ng-repeat="item in vm.legend"> <span class="legenddot" style="background-color: {{item.color}}"></span> {{item.label}} </p> </div> </div> \x3c!-- popover not used here because it prevents the nodes of being dragged\n\t\t\t<span class="pop-availability personlink" ng-if="vm.popover" ng-style="{\'top\': vm.popy,\'left\': vm.popx}"  url="{{ vm.current }}">\n\t\t\t\t<img src="images/empty80.png"></img>\n\t\t\t</span>\n\t\t\t --\x3e </div>'),e.put("views/network/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="network.net" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Verkostot</a> </li> <li ui-sref="network.pointcloud" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-cloud" aria-hidden="true"></span> Pistepilvi</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/nlp/comparison.html",'<div class="row"> <div style="padding: 20px" ui-view="buttons"></div> </div> <div class="row"> <div class="col-sm-6 comparison comparison-left" ui-view="left"></div> <div class="col-sm-6 comparison comparison-right" ui-view="right"></div> </div>'),e.put("views/nlp/comparison.left.html",'<div class="row"> <div class="col-sm-4"> \x3c!--<span><b>Näkymä:</b>\n        <a ui-sref-active="active" ui-sref="nlp.statistics">Tilastoja</a> |\n        <a ui-sref-active="active" ui-sref="nlp.comparison.sides">Vertailu</a>\n      </span>--\x3e <br><br> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-sm-8" min-height="500"> <div class="col-sm-12 wordpinner" class="col-md-3 col-sm-2" ng-show="vm.isLoadingWordResults && !vm.error" style="width: 95%"> <div class="comparison-result-info alert alert-warning" role="alert"> HUOM! Tulosten latautuminen voi kestää hetken. </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div ng-include="\'views/nlp/results.partial.comparison.html\'"></div> </div> </div>'),e.put("views/nlp/comparison.right.html",'<div class="row"> <div class="col-sm-8" min-height="500"> <div class="col-sm-12 wordpinner" class="col-md-3 col-sm-2" ng-show="vm.isLoadingWordResults && !vm.error"> <div class="comparison-result-info alert alert-warning" role="alert"> HUOM! Tulosten latautuminen voi kestää hetken. </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div ng-include="\'views/nlp/results.partial.comparison.html\'"></div> </div> <div class="col-sm-4"> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> </div>'),e.put("views/nlp/nlp.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>'),e.put("views/nlp/results.bottom.category.partial.html",'<div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption>Lyhyimmät tekstit: keskimääräinen sanamäärä toimialan mukaan <span class="glyphicon glyphicon-info-sign" uib-tooltip="Listalla esitetään toimialoittain keskimääräisesti lyhyimmät tekstit, jotka on laskettu keskimääräisen sanamäärän perusteella. Keskimääräinen sanamäärä esitetään Sanamäärä-sarakkeessa ja ryhmään kuuluvien biografioiden määrä on LKM-sarakkeessa."> </span></caption> <colgroup> <col class="name"> <col class="count"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <th>LKM</th> <tr ng-repeat="obj in vm.resultsBotCat"> <td>{{ obj.category }}</td> <td>{{ obj.count }}</td> <td>{{ obj.lkm }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.bottom.partial.html",'<div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption style="margin-top: 20px">Lyhyimmät biografiset tekstit <span class="glyphicon glyphicon-info-sign" uib-tooltip="Listalla esitetään sanamäärällisesti lyhyimmät biografiset tekstit."> </span></caption> <colgroup> <col class="name"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <tr ng-repeat="obj in vm.resultsBottom10"> <td><span class="personlink" url="{{ obj.id }}">{{ obj.name }}</span></td> <td>{{ obj.cnt }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.partial.comparison.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> {{ vm.error.statusText }} </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" ng-repeat="upos in vm.upos"> <table class="comparison-results" style="padding: 0; font-family:11px"> <colgroup> <col class="word-mini"> <col class="count-mini"> </colgroup> <th>{{ upos.label }}</th> <th>Kaikki </th> <tr ng-repeat="word in vm.results[upos.key]"> <td>{{ word.lemma }}</td> <td>{{ word.percentage }} % </td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.partial.html",'<div class="col-sm-12 wordpinner" class="col-md-3 col-sm-2" ng-show="vm.isLoadingWordResults && !vm.error"> <div class="comparison-result-info alert alert-warning" role="alert"> HUOM! Tulosten latautuminen voi kestää hetken. </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> {{ vm.error.statusText }} </div> <h3>Sanamäärät sanaluokittain <span class="glyphicon glyphicon-info-sign" uib-tooltip="Listalla esitetään yleisimmät sanat, niiden lukumäärä biografioista sekä suhteessa kokonaissanamäärään (Kaikki) ja kyseisen sanaluokan sanamäärään (Sanaluokka). Sanaluokista esitykseen on valittu verbit, adjektiivit, substantiivit, sekä erisnimet. Biografiajoukosta on filtteröity pois järjestysnumerot ja joitakin mahdollisia virheellisesti luokiteltuja sanoja."> </span></h3> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" ng-repeat="upos in vm.upos"> <table class="comparison-results" style="font-size: 14px; text-align:left"> <colgroup> <col class="word"> <col class="count"> <col class="pos_count"> <col class="count"> </colgroup> <th>{{ upos.label }}</th> <th>Määrä </th> <th>Sanaluokka </th> <th>Kaikki </th> <tr ng-repeat="word in vm.results[upos.key]"> <td>{{ word.lemma }}</td> <td>{{ word.count }}</td> <td>{{ word.class_percentage }} %</td> <td>{{ word.percentage }} %</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.top.category.partial.html",'<div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption>Pisimmät tekstit: keskimääräinen sanamäärä toimialan mukaan <span class="glyphicon glyphicon-info-sign" uib-tooltip="Listalla esitetään toimialoittain keskimääräisesti pisimmät tekstit, jotka on laskettu keskimääräisen sanamäärän perusteella. Keskimääräinen sanamäärä esitetään Sanamäärä-sarakkeessa ja ryhmään kuuluvien biografioiden määrä on LKM-sarakkeessa."> </span> </caption> <colgroup> <col class="name"> <col class="count"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <th>Lkm</th> <tr ng-repeat="obj in vm.resultsTopCat"> <td>{{ obj.category }}</td> <td>{{ obj.count }}</td> <td>{{ obj.lkm }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.top.partial.html",'<div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption style="margin-top: 20px">Pisimmät biografiset tekstit <span class="glyphicon glyphicon-info-sign" uib-tooltip="Listalla esitetään sanamäärällisesti pisimmät biografiset tekstit."> </span></caption> <colgroup> <col class="name"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <tr ng-repeat="obj in vm.resultsTop10"> <td><span class="personlink" url="{{ obj.id }}">{{ obj.name }}</span></td> <td>{{ obj.cnt }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/statistics.html",'<div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/description.npl.partial.html\'"></div> <div> \x3c!--<span><b>Näkymä:</b>\n        <a ui-sref-active="active" ui-sref="nlp.statistics">Tilastoja</a> |\n        <a ui-sref-active="active" ui-sref="nlp.comparison.sides({facets: vm.facetParam1, facets2: vm.facetParam2})">Vertailu</a>\n      </span>--\x3e </div> <br><br> \x3c!--div ng-include="\'views/facets.partial.html\'"></div--\x3e <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="biography-chart"></div> <div id="biography-len-chart"></div> <div class="row list-row"> <div id="biography-top-best" ng-include="\'views/nlp/results.top.partial.html\'"></div> <div id="biography-top-bottom" ng-include="\'views/nlp/results.bottom.partial.html\'"></div> </div><div class="row list-row"> <div id="biography-cat-best" ng-include="\'views/nlp/results.top.category.partial.html\'"></div> <div id="biography-cat-bottom" ng-include="\'views/nlp/results.bottom.category.partial.html\'"></div> </div> <div class="row" style="margin-top: 20px"> <div class="row mt-3"><div ng-include="\'views/nlp/results.partial.html\'"></div></div> </div>'),e.put("views/nlp/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="nlp.statistics({ facets: vm.admiralFacet })" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Kielellisiä tilastoja</a> </li> <li ui-sref="nlp.comparison.sides({facets: vm.facetParam1, facets2: vm.facetParam2})" ui-sref-active="active" data-test="{{vm.facetParam2}}"> <a href=""><span class="glyphicon glyphicon-book" aria-hidden="true"></span> <span class="glyphicon glyphicon-book" aria-hidden="true"></span> Vertailu</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/palaute.html",'<div class="feedback-wrapper"> <iframe frameborder="0" src="https://www.webropolsurveys.com/S/F349E7F897987B86.par"></iframe> </div> \x3c!--   FOOTER     --\x3e <div ng-include="\'views/footer.html\'"></div>'),e.put("views/person/detail.html",'<div class="col-sm-12 col-md-8 text-center"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <h1 class="notranslate">{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="thumbnail" ng-show="vm.person"> <div class="person-profile-img"> <div class="row"> <div class="col-sm-12 text-center"> <img ng-repeat="img in vm.person.images" class="person-img img img-responsive" ng-src="{{ img }}" uib-tooltip="Kuvalähde: {{ vm.person.imagesources[$index] }}" tooltip-enable="{{ !!vm.person.imagesources[$index] }}" tooltip-placement="bottom"> </div> </div> </div> <div class="caption" ng-show="vm.person"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12"> <p ng-if="(vm.person.birth || vm.person.birthDate || vm.person.death || vm.person.deathDate)"> <span ng-if="(vm.person.birth || vm.person.birthDate)">&#8727;&nbsp; <span ng-repeat="p in vm.person.birth"><span ng-if="!$first">, </span><span class="placelink notranslate" url="{{ ::p.id }}">{{ ::p.label }}</span></span> <span ng-if="vm.person.birthDate">{{ vm.person.birthDate }}</span> </span> <span ng-if="(vm.person.death || vm.person.deathDate)">&dagger;&nbsp; <span ng-repeat="p in vm.person.death"><span ng-if="!$first">, </span><span class="placelink notranslate" url="{{ ::p.id }}">{{ ::p.label }}</span></span> <span ng-if="vm.person.deathDate">{{ vm.person.deathDate }}</span> </span> </p> </div> <div ng-if="vm.person.occupation" class="col-xs-12"> <p>{{ vm.person.occupation | castArray | join:\', \' }}</p> </div> <div ng-if="vm.person.source" class="col-xs-12"> <p>Lähteet: {{ vm.person.source | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> </div> </div> \x3c!-- \n            <div class="row">\n\t           \t<a title="Data ldf.fi-palvelussa" class="" ng-href="http://ldf.fi/nbf/{{ vm.person.id }}">\n\t            \t<span class="glyphicon glyphicon-hdd" aria-hidden="true"> </span>\n\t            </a>\n            </div>\n            <br />\n             --\x3e <div class="btn-group" role="group" ng-if="vm.person.id"> <a ng-if="vm.person.blf" ng-href="{{ vm.person.blf }}" class="btn btn-default btn-sm"> Biografiskt lexikon för Finland</a> <a ng-if="vm.person.eduskunta" ng-href="{{ vm.person.eduskunta }}" class="btn btn-default btn-sm"> Eduskunta</a> <a ng-if="vm.person.fennica.length>1" ng-href="{{ vm.person.fennica[0] }}" class="btn btn-default btn-sm"> Fennica 1 </a> <a ng-if="vm.person.fennica.length>1" ng-href="{{ vm.person.fennica[1] }}" class="btn btn-default btn-sm"> 2 </a> <a ng-if="vm.person.fennica.length<2" ng-href="{{ vm.person.fennica[0] }}" class="btn btn-default btn-sm"> Fennica </a> <a ng-if="vm.person.genicom" ng-href="{{ vm.person.genicom }}" class="btn btn-default btn-sm"> Geni.com: Kotisivu</a> <a ng-if="vm.person.genitree" ng-href="{{ vm.person.genitree }}" class="btn btn-default btn-sm"> Geni.com: Sukupuu</a> <a ng-if="vm.person.kirjasampo" ng-href="{{ vm.person.kirjasampo }}" class="btn btn-default btn-sm"> Kirjasampo</a> <a ng-if="vm.person.website" ng-href="{{ vm.person.website }}" class="btn btn-default btn-sm"> Kotisivu</a> <a ng-if="vm.person.kulttuurisampo" ng-href="{{ vm.person.kulttuurisampo }}" class="btn btn-default btn-sm"> Kulttuurisampo</a> <a ng-if="vm.person.norssi" ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ vm.person.norssi }}" class="btn btn-default btn-sm"> Norssit</a> <a ng-if="vm.person.warsampo" ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ vm.person.warsampo }}" class="btn btn-default btn-sm"> Sotasampo</a> <a ng-if="vm.person.ulan" ng-href="{{ vm.person.ulan }}" class="btn btn-default btn-sm"> ULAN</a> <a ng-if="vm.person.viaf" ng-href="{{ vm.person.viaf }}" class="btn btn-default btn-sm"> VIAF</a> <a ng-if="vm.person.wikipedia" ng-href="{{ vm.person.wikipedia }}" class="btn btn-default btn-sm">Wikipedia </a> <a ng-if="vm.person.wikidata" ng-href="{{ vm.person.wikidata }}" class="btn btn-default btn-sm">Wikidata </a> <a ng-if="vm.person.yo1853" ng-href="https://ylioppilasmatrikkeli.helsinki.fi/1853-1899/henkilo.php?id={{ vm.person.yo1853 }}" class="btn btn-default btn-sm"> Ylioppilasmatrikkeli 1853–1899 </a> \x3c!-- \n\t\t\t  <a ng-href="http://ldf.fi/nbf/{{ vm.person.id }}"\n\t\t\t  \tclass="btn btn-default btn-sm">\n\t\t\t  \tData ldf.fi-palvelussa\n\t          </a>\n               --\x3e </div> </div> </div> </div> <div class="col-sm-6 col-md-12 text-left" ng-if="(vm.person) && !vm.person.bios && !vm.person.externalLinks"> <br> <h4>Henkilöllä ei ole biografiakuvauksia</h4> <hr> </div> <div class="col-sm-6 col-md-12 text-left thumbnail" ng-if="(vm.person.bios && vm.person.bios.length) || vm.person.externalLinks"> <ul class="nav nav-tabs"> <li ng-repeat="bio in vm.person.bios | castArray" ng-class="{ active: vm.isSet($index) }"> <a href ng-click="vm.setTab($index)"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span> <span style="font-size: 120%"> {{ bio.database }}</span> </a> </li> <li ng-repeat="link in vm.person.externalLinks | castArray" ng-class="{ active: vm.isSet(link.tab) }"> <a href ng-click="vm.setTab(link.tab)">{{ link.label }}</a> </li> </ul> <nlp-biography ng-repeat="bio in vm.person.bios | castArray" ng-show="vm.isSet($index)" url="{{bio.bio}}" active="{{vm.isSet($index)}}"> </nlp-biography> <nbf-iframe ng-repeat="link in vm.person.externalLinks | castArray" ng-show="vm.isSet(link.tab)" url="{{link.url}}" active="{{vm.isSet(link.tab)}}"> </nbf-iframe> </div> </div> <br> <br> <div class="col-md-4 text-left well nbfwell" ng-if="vm.person.relative && vm.person.relative.length"> <div class="relativeblock"> <h3>Lähisukulaiset</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilön sukulaisissa näytetään vanhemmat, puolisot ja lapset, ei kaukaisempia sukulaisia."> </span> </div> <div class="col-sm-6" ng-repeat="relative in vm.person.relative"> {{ relative.type }} <personlink url="{{ relative.id2 }}">{{ relative.name }}</personlink> </div> </div> <div class="col-md-4 text-left well nbfwell" ng-if="vm.similar"> <div class="relativeblock"> <h3>Samankaltaisia biografioita</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöt on määritelty samankaltaisiksi vertaamalla laskennallisesti heidän biografiakuvauksien sanastoa."> </span> </div> <nbf-personlist num="18" url="{{ vm.similar.people }}"></nbf-personlist> </div> <div class="col-md-4 text-left well nbfwell" ng-if="vm.referenced"> <div class="relativeblock"> <h3>T&auml;nne viittaavat sivut ({{ ::vm.referenced.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöitä joiden biografioista viitataan tälle sivulle."> </span> </div> <nbf-personlist url="{{ vm.referenced.people }}"></nbf-personlist> </div> <div class="col-md-4 text-left well nbfwell" ng-if="vm.references"> <div class="relativeblock"> <h3>Täältä viitatut sivut ({{ ::vm.references.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöt joiden biografioihin viitataan tältä sivulta."> </span> </div> <nbf-personlist url="{{ vm.references.people }}"></nbf-personlist> </div> <div class="col-md-4 text-left well nbfwell" ng-if="vm.authors"> <div class="relativeblock"> <h3>{{ vm.authors.count==1 ? \'Kirjoittaja\' : \'Kirjoittajat\' }}</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tutustu biografiakuvauksen laatijoihin."> </span> </div> <nbf-personlist url="{{ vm.authors.people }}"></nbf-personlist> </div> <div class="col-md-4 text-left well nbfwell" ng-if="vm.sameAuthor"> <div class="relativeblock"> <h3>Samoilta kirjoittajilta ({{ ::vm.sameAuthor.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Lue muita biografia-artikkeleja samoilta kirjoittajilta."> </span> </div> <nbf-personlist url="{{ vm.sameAuthor.people }}"></nbf-personlist> </div> <div class="col-md-4 text-left well nbfwell" ng-if="vm.authoredBios"> <div class="relativeblock"> <h3>Kirjoitettuja artikkeleja ({{ ::vm.authoredBios.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Lue tämän henkilön laatimia biografia-artikkeleja."> </span> </div> <nbf-personlist url="{{ vm.authoredBios.people }}"></nbf-personlist> </div>  '),e.put("views/person/linguistics.html",'<div class="container-fluid"> <div class="row"> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center"> <h1 class="notranslate">{{vm.label}}</h1> <div class="container-fluid thumbnail"> <div> <div class="col-md-4 pull-md-4 col-lg-3 text-left" style="width:15%"> <h1>Tutki henki&shy;lön elämäkerran sanastoa.</h1> <p> Sivulla esitetään listoja sanoista, joita ilmenee henkilön elämäkerrassa. Sanat on luokiteltu sanaluokkiin käyttäen automaattista tekstin luokittelijaa. </p> </div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail" style="width:85%"> \x3c!--div class="row" style="margin-top: 20px;"/--\x3e <div class="row mt-3"><div ng-include="\'views/nlp/results.partial.html\'"></div> </div> </div> </div> </div> </div></div>'),e.put("views/person/map.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div class="container-fluid text-center"> <div id="labelcontainer" class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <br> <h1>Tutki henki&shy;löön liit&shy;tyviä tapah&shy;tumia</h1> <span> Sivulla näytetään lista henkilöön liittyvistä tapahtumista, niihin liit&shy;ty&shy;vät pai&shy;kat kartalla sekä tapahtumasarja aikajanalla. Tapahtumat on poi&shy;mittu bio&shy;grafia&shy;kuvausten teksti&shy;kentistä. </span> <br> <span> (Jos henkilöllä on useampi biografiakuvaus, saattaa listalla toistua sama tapahtuma eri lähteistä poimittuna.) </span> <br><br> <div uib-alert ng-if="vm.error" style="color:red">{{ vm.error }}</div> <div ng-if="vm.events.length">Henkilöllä on {{ vm.events.length }} tapahtumaa:</div> <br> <p ng-show="vm.person" ng-repeat="event in ::vm.events" class="{{event.class}}" ng-mouseenter="vm.focusEvent(event)" ng-mouseleave="vm.unfocusEvent(event)"> {{$index+1}}: <span ng-if="::event.relative" class="personlink" url="{{ ::event.relative }}">{{ ::event.label }}</span> <span ng-if="::!event.relative">{{ ::event.label }}</span> <span ng-if="::event.markers.length" class="placelink" url="{{ ::event.markers[0].uri }}"> <span style="color:darkblue" class="glyphicon glyphicon-globe"></span> </span> </p> <br><br><br><br> </div> <div ng-show="vm.person" class="col-md-8 col-lg-9 text-center personmapcontent"> <h1 class="notranslate">{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <ui-gmap-google-map id="personmap" class="personmap" center="vm.map.center" zoom="vm.map.zoom"> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options"></ui-gmap-marker> </ui-gmap-google-map> <svg id="timelinecontainer" viewbox="-15,-7,120,27" preserveaspectratio="none" version="1.0" x="0" y="0" width="900" height="180" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <line ng-repeat="line in ::vm.mainline.lines" ng-attr-x1="{{ line.x1 }}" ng-attr-x2="{{ line.x2 }}" ng-attr-y1="{{ line.y1 }}" ng-attr-y2="{{ line.y2 }}"> </line> <text ng-repeat="text in ::vm.mainline.texts" ng-attr-x="{{ text.x }}" ng-attr-y="{{ text.y }}"> {{ text.content }} </text> <path ng-repeat="event in vm.events" ng-mouseenter="vm.focusEvent(event)" ng-mouseleave="vm.unfocusEvent(event)" class="{{ ::event.class }}" ng-attr-d="{{ ::event.path }}"> </path> </svg> <p> <span>{{ vm.currentEvent }}</span> </p> </div> </div> </div> </div>'),e.put("views/person/network.html",'<div class="container-fluid"> <div class="row"> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center"> <h1 class="notranslate">{{ vm.label ? vm.label : \'.\' }}</h1> <div class="container-fluid thumbnail" style="height: 900px"> <div> <div class="col-md-4 pull-md-4 col-lg-3 text-left"> <h1>Tutki henki&shy;löön liit&shy;tyvää verkostoa</h1> <p> Sivulla näytetään havainnekuva henkilöön liittyvästä verkostosta. Linkitys on luotu biografiakuvausten viittausten perusteella. </p> <p> Verkoston solmuja voidaan siirtää hiirellä. Solmuja klikkaamalla pääset tarkastelemaan verkostoa valitun henkilön ympärillä. Alapuoleisilla valikoilla voidaan säätää verkoston laajuutta ja ulkoasua. </p> <div class="well well-sm"> <p style="color:{{vm.messagecolor}}">{{ vm.message }}</p> <p>Näytä verkostossa korkeintaan <select ng-model="vm.searchlimit" ng-options="item.label for item in vm.LIMITOPTIONS" ng-change="vm.changelimit()"> </select> henkilöä. </p> <br> <p>Verkostossa näytetään <form name="eventForm" class="eventForm" ng-repeat="type in vm.CLASSTYPES"> <label title="{{ type.tooltip }}"> <input type="checkbox" ng-model="type.check" ng-change="vm.changeclass()"> <span>{{ type.label }}</span> </label><br> </form> </p> <p> Solmujen koko: <select ng-model="vm.sizeoption" ng-options="item.value for item in vm.SIZEOPTIONS" ng-change="vm.changesize()"> </select> <span ng-if="vm.sizeoption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.sizeoption.tooltip}}" tooltip-placement="right"></span> </p> <p> Solmujen väri: <select ng-model="vm.coloroption" ng-options="item.value for item in vm.COLOROPTIONS" ng-change="vm.changecolor()"> </select> <span ng-if="vm.coloroption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.coloroption.tooltip}}" tooltip-placement="right"></span> </p> </div> </div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail" style="height: 900px"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="networkcontainer" class="container fill"></div> <div class="cytolegend"> <div class="well well-sm" ng-if="vm.showlegend"> <br> <p ng-if="vm.legend" ng-repeat="item in vm.legend"> <span class="legenddot" style="background-color: {{item.color}}"></span> {{item.label}} </p> </div> </div> \x3c!-- popover not used here because it prevents the nodes of being dragged\n\t\t\t<span class="pop-availability personlink" ng-if="vm.popover" ng-style="{\'top\': vm.popy,\'left\': vm.popx}"  url="{{ vm.current }}">\n\t\t\t\t<img src="images/empty80.png"></img>\n\t\t\t</span>\n\t\t\t --\x3e </div> </div> </div> </div> </div>'),e.put("views/person/sentences.html",'<div class="container-fluid"> <div class="row"> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center"> <h1 class="notranslate">{{vm.label}}</h1> <div class="container-fluid thumbnail"> <div> <div class="col-md-4 pull-md-4 col-lg-3 text-left"> <h1>Tutki henki&shy;löön liit&shy;tyviä lauseita</h1> <p> Sivulla näytetään havainnekuva henkilöön liittyvistä lauseista. Toistaiseksi esitetään vain lauseet, joihin on manuaalisesti lisätty alkuperäisessä biografiassa linkki. </p> </div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail" style="text-align:left"> <div> <h4> Viittaukset muista biografioista henkilöön <span class="glyphicon glyphicon-info-sign" tooltip-placement="bottom" uib-tooltip="Listassa näkyy alla lauseet, joihin on alun perin manuaalisesti mennyt linkki Kansallisbiografian sivustolle. Lauseet eivät kata kaikkia joissa henkilö on mainittu vaan usein biografian ensimmäinen lause, jossa henkilö on mainittu."> </span></h4> <div class="col-sm-12" ng-show="vm.isLoadingSentences"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div> <ul style="padding: 0; display: inline-table; vertical-align: middle; list-style-position: inside; text-align: left" ng-include="\'views/directive/nbf-sentence-list.directive.html\'"> <list-sentences> \x3c!--<div ng-repeat="sentences in vm.sentenceResults">\n\t\t\t\t\n\t\t\t\t<li  ng-repeat="sentence in sentences" ng-bind-html="sentence.words">\n\t\t\t\t\n\t\t\t\t    {{ sentence.words }}\n\t\t\t\t</li>\n\t\t\t    </div>--\x3e</list-sentences></ul> </div> <div> <div class="col-sm-12" ng-show="vm.isLoadingChart"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="referenced-time"> </div> </div> </div> <div> <h4> Viittaukset muihin biografioihin <span class="glyphicon glyphicon-info-sign" tooltip-placement="bottom" uib-tooltip="Listassa on lauseet henkilön biografiasta, joissa viitataan muihin henkilöihin. Linkit ovat manuaalisesti tuotettuja alkuperäisaineistoon ja koneellisesti irroitettu ja sijoitettu takaisin ensimmäiseen mainintaan henkilöstä tekstissä."> </span></h4> <div class="col-sm-12" ng-show="vm.isLoadingReferences"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div> <ul style="padding: 0; display: inline-table; vertical-align: middle; list-style-position: inside; text-align: left"> <div ng-repeat="sentences in vm.referenceResults"> <li ng-repeat="sentence in sentences" ng-bind-html="sentence.words"> \x3c!--{{word.upos!="PUNCT" ? word.string+" " : word.string }}--\x3e {{ sentence.words }} </li> </div></ul> </div> <div> <div class="col-sm-12" ng-show="vm.isLoadingChart"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="referencing-time"> </div> </div> </div> <div class="col-sm-12" ng-show="vm.loading"> \x3c!--<img class="loading-img" src="images/loading-lg.7ba320e0.gif"></img>--\x3e </div> </div> </div> </div> </div> </div>'),e.put("views/person/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="person.detail" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Henkilön tiedot</a> </li> <li ui-sref="person.map" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Kartta ja aikajana</a> </li> <li ui-sref="person.network" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Verkosto</a> </li> <li ui-sref="person.sentence" ui-sref-active="active"> <a href="" style="display:flex"><i class="material-icons md-18" style="font-size: 18px">forum</i> Viittaukset</a> </li> <li ui-sref="person.linguistics" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Kielianalyysi</a> </li> </ul> </div> </div> <div class="row"> <div ui-view></div> </div> </div>'),e.put("views/personTooltipTemplate.html",'<div> <p>{{ label }}<br>{{ lifespan }}</p> <img ng-if="!image" height="120" class="person-img img" src="images/person_placeholder.cd371769.svg"> <img ng-if="!!image" height="120" class="person-img img" src="{{ image }}"> </div>'),e.put("views/persongroupTooltipTemplate.html",'<div style="z-index: 9"> <p>{{ person.label }}<br>{{ person.lifespan }}</p> <img ng-if="!person.image" height="120" class="person-img img" src="images/person_placeholder.cd371769.svg"> <img ng-if="!!person.image" height="120" class="person-img img" src="{{ person.image }}"> </div>'),e.put("views/place.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-4"> <h1>{{ vm.place.label }}</h1> <p> Sivulla näytetään yksittäisen paikan tietoja, kuten listat siellä eläneistä ja vaikuttaneista henkilöistä. </p> <div ng-if="!vm.isLoadingResults && !vm.place;" style="color:red">Haettua paikkaa ei löydy tietokannasta.</div> <div class="well nbfwell" ng-if="vm.place"> <div class="relativeblock"> <h3>Paikan tiedot</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tässä näytetään paikan muita nimiä, sekä linkkejä muihin tietokantoihin." tooltip-placement="bottom"> </span> </div> <div ng-if="vm.place.alabel">{{ vm.place.alabel | join:\', \' }}</div> <div ng-if="vm.place.yso"> <a ng-href="{{ vm.place.yso }}">kohde Finton tietokannassa YSO-paikat</a> </div> <div ng-if="vm.place.wikidata"> <a ng-href="{{ vm.place.wikidata }}">kohde Wikidata-tietokannassa</a> </div> </div> <div class="well nbfwell" ng-if="vm.related"> <div class="relativeblock"> <h3>Liittyviä paikkoja ({{vm.related.length}})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tässä listassa näytetään hierarkiassa ylempiä (maakunta, valtio, maanosa) sekä alempia (kylä, kaupunginosa) paikkoja."> </span> </div> <div class="col-sm-6" ng-repeat="place in vm.filteredRelated"> <span class="placelink" url="{{place.id}}">{{place.label}}</span> </div> <ul uib-pagination ng-if="vm.related.length>vm.numPerPage" ng-model="vm.currentPage" total-items="vm.related.length" max-size="vm.maxSize" items-per-page="vm.numPerPage" boundary-links="true" first-text="<<" previous-text="<" next-text=">" last-text=">>"> </ul> <span ng-if="vm.related.length<=vm.numPerPage" style="color:white">.</span> </div> <div class="well nbfwell" ng-if="vm.Birth"> <div class="relativeblock"> <h3>Syntyneet ({{ ::vm.Birth.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tässä näytetään lista paikassa syntyneistä henkilöistä."> </span> </div> <nbf-personlist url="{{ vm.Birth.people }}"></nbf-personlist> </div> <div class="well nbfwell" ng-if="vm.Death"> <div class="relativeblock"> <h3>Kuolleet ({{ ::vm.Death.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tässä näytetään lista paikassa kuolleista henkilöistä."> </span> </div> <nbf-personlist url="{{ vm.Death.people }}"></nbf-personlist> </div> <div class="well nbfwell" ng-if="vm.Career"> <div class="relativeblock"> <h3>Ura ({{ ::vm.Career.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tässä näytetään henkilöt, jotka ovat opiskelleet tai olleet työssä paikkakunnalla."> </span> </div> <nbf-personlist url="{{ vm.Career.people }}"></nbf-personlist> </div> <div class="well nbfwell" ng-if="vm.Product"> <div class="relativeblock"> <h3>Teokset ({{ ::vm.Product.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöillä on paikkaan liittyviä teoksia."> </span> </div> <nbf-personlist url="{{ vm.Product.people }}"></nbf-personlist> </div> <div class="well nbfwell" ng-if="vm.Honour"> <div class="relativeblock"> <h3>Kunniamaininnat ({{ ::vm.Honour.count }})</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöillä on paikkaan liittyviä kunniamainintoja."> </span> </div> <nbf-personlist url="{{ vm.Honour.people }}"></nbf-personlist> </div> </div> <div class="col-sm-8"> <div class="col-sm-12 mapspinner" ng-show="vm.isLoadingResults"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <ui-gmap-google-map id="ui-gmap-google-map" class="placeInfoPageMap" center="vm.map.center" zoom="vm.map.zoom" events="vm.mapevents"> <ui-gmap-window id="ui-gmap-window" show="vm.window.show" options="vm.window" templateurl="\'views/groupmap/popup.html\'" templateparameter="vm" closeclick="vm.closeWindow"> <span></span> </ui-gmap-window> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options" click="marker.onClick()"> </ui-gmap-marker> </ui-gmap-google-map> </div> </div> </div>'),e.put("views/placeTooltipTemplate.html",'<div> <p>{{ label }}</p> <span ng-if="!image" class="glyphicon glyphicon-map-marker" style="&quot;font-size:120px"></span> <img ng-if="image" height="120" class="person-img img" src="{{ image }}"> </div>'),e.put("views/popup.html",'<div class="modal-header"> <h3>{{ ::vm.popuptitle }}</h3> <nbf-persongroup url="{{ vm.people }}"></nbf-persongroup> </div>'),e.put("views/portal.html",'<div class="wrapper"> <noscript><div class="alert alert-danger text-center"> <h3>Sovellus vaatii toimiakseen JavaScriptin. The application requires JavaScript to function.</h3> </div></noscript> <div class="container"> <div id="jumbo" class="jumbotron"> <div class="row"> <div class="col-md-10"> <noscript><h1>Biografiasampo</h1> <p>Suomalaisten elämäkertojen verkosto semanttisessa webissä</p></noscript> <br> <h1 id="jumboTitle">{{ ::vm.strings["jumboTitle"] }}</h1> <p id="jumboSubtitle">{{ ::vm.strings["jumboSubtitle"] }}</p> </div> </div> </div> \x3c!-- Jumbotron --\x3e <div class="row"> <div class="col-md-12"> <p><a href="http://seco.cs.aalto.fi/projects/biografiasampo/">Biografiasampo</a> mahdollistaa suomalaisten elämäkertojen, henkilöiden ja henkilöryhmien tutkimisen digitaalisten ihmistieteiden menetelmillä. Palvelun ydinaineistona on Suomalaisen Kirjallisuuden Seuran Kansallisbiografia ja muut tietokannat, yhteensä n. 13 000 elämäkertaa, joita on rikastettu muilla ulkoisilla aineistoilla. Valitse alta sovellusnäkymä aineistoihin. Lisätietoa <a data-toggle="modal" data-target="#myModal" href="#"> ohjeessa</a>.</p> <noscript><p>Portaalilla voi hakea, selata ja visualisoida laajoja tietoaineistoja Suomen historiallisista henkilöistä.</p> <p><b>Salli JavaScript käyttääksesi Suomen sukua. Please enable JavaScript to use Semantic Biography of Finland.</b></p></noscript> </div> </div> <div class="row"> <div class="col-md-12"> <hr> <h3 id="choosePerspective">{{ ::vm.strings["choosePerspective"] }}</h3> \x3c!-- PERSPECTIVES --\x3e <div class="row"> <a id="events" class="col-md-4 pers-link" ui-sref="search.cards"> <div class="persbox" id="nav-events"> <h4 id="searchH">{{ ::vm.strings["searchH"] }}</h4> <p id="searchP">{{ ::vm.strings["searchP"] }}</p> </div> </a> <a id="places" class="col-md-4 pers-link" target="_self" href="http://biografiasampo.fi/paikat/"> <div class="persbox" id="nav-places"> <h4 id="placesH">{{ ::vm.strings["placesH"] }}</h4> <p id="placesP">{{ ::vm.strings["placesP"] }}</p> </div> </a> <a id="maps" class="col-md-4 pers-link" ui-sref="maps.singleview"> <div class="persbox" id="nav-maps"> <h4 id="mapsH">{{ ::vm.strings["mapsH"] }}</h4> <p id="mapsP">{{ ::vm.strings["mapsP"] }}</p> </div> </a> <a id="statistics" class="col-md-4 pers-link" ui-sref="visu.statistics"> <div class="persbox" id="nav-statistics"> <h4 id="statisticsH">{{ ::vm.strings["statisticsH"] }}</h4> <p id="statisticsP">{{ ::vm.strings["statisticsP"] }}</p> </div> </a> <a id="networks" class="col-md-4 pers-link" ui-sref="network.net"> <div class="persbox" id="nav-networks"> <h4 id="networksH">{{ ::vm.strings["networksH"] }}</h4> <p id="networksP">{{ ::vm.strings["networksP"] }}</p> </div> </a> <a id="relations" class="col-md-4 pers-link" target="_self" href="http://biografiasampo.fi/yhteyshaku/"> <div class="persbox" id="nav-relations"> <h4 id="relationsH">{{ ::vm.strings["relationsH"] }}</h4> <p id="relationsP">{{ ::vm.strings["relationsP"] }}</p> </div> </a> <a id="language" class="col-md-4 pers-link" ui-sref="nlp.statistics({ facets: vm.admiralFacet })"> <div class="persbox" id="nav-language"> <h4 id="casultiesH">{{ ::vm.strings["casultiesH"] }}</h4> <p id="casultiesP">{{ ::vm.strings["casultiesP"] }}</p> </div> </a> </div> </div> <div class="push"></div> </div> \x3c!-- container --\x3e <hr> <h4>Linkkejä esimerkkisivuille Biografiasammon käytöstä</h4> <div style="line-height:38px"> <a class="btn btn-primary" role="button" ui-sref="person.detail({ personId: \'p992\'})"> Elämäkerta: Jean Sibeliuksen kotisivu ja Kansallisbiografia</a> <a class="btn btn-primary" role="button" ui-sref="person.detail({ personId: \'p828\', tab:\'genisukupuu\'})"> Suku ja verkosto: Minna Canthin kotisivu ja sukupuunäkymä</a> <a class="btn btn-primary" role="button" ui-sref="person.map({ personId: \'p987\'})"> Elämä kartalla ja aikajanalla: Eliel Saarisen kansainvälinen ura</a> <a class="btn btn-primary" role="button" ui-sref="person.network({ personId: \'p522\', coloroption: 3, sizeoption: 1 })"> Verkostot: Tapio Rautavaaran egosentrinen verkosto</a> <a class="btn btn-primary" role="button" href="kartat/vertaaelamat?facets=%7B%22dataset%22%3A%7B%22value%22%3A%22%3Chttp%3A%2F%2Fldf.fi%2Fnbf%2Fsources%2Fsource4%3E%22%2C%22constraint%22%3A%22%3Fid%20%3Chttp%3A%2F%2Fpurl.org%2Fdc%2Fterms%2Fsource%3E%20%3Chttp%3A%2F%2Fldf.fi%2Fnbf%2Fsources%2Fsource4%3E.%22%7D%7D&facets2=%7B%22dataset%22%3A%7B%22value%22%3A%22%3Chttp%3A%2F%2Fldf.fi%2Fnbf%2Fsources%2Fsource5%3E%22%2C%22constraint%22%3A%22%3Fid%20%3Chttp%3A%2F%2Fpurl.org%2Fdc%2Fterms%2Fsource%3E%20%3Chttp%3A%2F%2Fldf.fi%2Fnbf%2Fsources%2Fsource5%3E.%22%7D%7D&map=%7B%22center%22%3A%7B%22latitude%22%3A62.64298263801266%2C%22longitude%22%3A19.358826890587807%7D%2C%22zoom%22%3A4%7D"> Ryhmät: Suomen suuriruhtinaskunnan kenraalien ja amiraalien (1809-1917) ja papiston (1800-1920) elämäkarttojen vertailu</a> <a class="btn btn-primary" role="button" ui-sref="place({ placeId: \'Turku\'})"> Paikka: Turku</a> <a class="btn btn-primary" role="button" ui-sref="nlp.statistics({ facets: vm.clergyFacet })"> Kielianalyysi Papiston biografioiden kielenkäytöstä</a> <a class="btn btn-primary" role="button" ui-sref="person.sentence({ personId: \'p874\'})"> Lauseiden sisältämät viittaukset Ida Aalbergiin ja lauseissa mainitut henkilöt joihin hän viittaa.</a> </div> <p></p> <p> <a href="https://www.facebook.com/groups/514385075640669/"> <img src="images/FB-f-Logo__blue_29.cec1afed.png"> <span id="followFacebook">{{ ::vm.strings["followFacebook"] }}</span> </a> </p> </div> \x3c!--   FOOTER     --\x3e <div ng-include="\'views/footer.html\'"></div></div>'),e.put("views/profile-image-popover.html",'<div> <img class="img img-responsive" ng-src="{{ img }}"> </div>'),e.put("views/search/cards.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/search/description.partial.html\'"></div> <br> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <br><b>Järjestä:</b> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/search/cards.partial.html\'"></div> </div> </div> </div>'),e.put("views/search/cards.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div infinite-scroll="vm.nextPage()" infinite-scroll-disabled="vm.isScrollDisabled()" infinite-scroll-distance="0"> <div class="row"> <div ng-repeat="person in vm.people" class="person-container"> <div class="col-xs-12 col-sm-12 person-panel col-md-4 col-lg-3"> <div class="thumbnail"> <a ui-sref="person.detail({ personId: person.id })"> <div class="person-profile-img vertical-center"> <img class="img img-responsive center-block media-middle" ng-src="{{ ::person.images | first }}"> </div> </a> <div class="caption"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12 col-sm-3 col-md-12"> <b><a class="notranslate" ui-sref="person.detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b> </div> <div class="col-xs-12 col-sm-9 col-md-12"> <p ng-if="::(person.birthPlace || person.birthDate || person.deathDate)"> &#8727;&nbsp;<span class="notranslate" ng-if="::person.birthPlace">{{ ::person.birthPlace | castArray | join:\', \' }}</span> {{ ::person.birthDate }} <span class="notranslate" ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace | castArray | join:\', \' }}&nbsp;{{ ::person.deathDate }}</span> </p> </div> <div ng-if="::person.occupation" class="col-xs-12"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a title="Näytä matrikkeliteksti" ng-attr-title="{{ showText ? \'Piilota matrikkeliteksti\' : \'Näytä matrikkeliteksti\' }}" href="" ng-click="showText = !showText"><span class="glyphicon" ng-class="{ \'glyphicon-collapse-down\': !showText, \'glyphicon-collapse-up\': showText }" aria-hidden="true"></span></a> <a title="Artikkeli Kansallisbiografian sivustolla" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data ldf.fi-palvelussa" class="" ng-href="http://ldf.fi/nbf/{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="::person.hasAchievements" class="col-xs-6"> <a href="" class="link" ng-click="vm.getAchievements(person)" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto right">Saavutukset</a> </div> <div ng-if="::person.wikipedia" class="col-xs-6"> <a ng-href="{{ ::person.wikipedia }}">Wikipedia</a> </div> <div ng-if="::person.wikidata" class="col-xs-6"> <a ng-href="{{ ::person.wikidata }}">Wikidata</a> </div> <div ng-if="::person.fennica[0]" class="col-xs-6"> <a ng-href="{{ ::person.fennica[0] }}">Fennica</a> </div> <div ng-if="::person.fennica[1]" class="col-xs-6"> <a ng-href="{{ ::person.fennica[1] }}">Fennica (2)</a> </div> <div ng-if="::person.warsampo" class="col-xs-6"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsampo }}">Sotasampo</a> </div> <div ng-if="::person.norssi" class="col-xs-6"> <a ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ ::person.norssi }}">Norssi</a> </div> <div ng-if="::person.kirjasampo" class="col-xs-6"> <a ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="::person.blf" class="col-xs-6"> <a ng-href="{{ ::person.blf }}">BLF</a> </div> <div ng-if="::person.ulan" class="col-xs-6"> <a ng-href="{{ ::person.ulan }}">ULAN</a> </div> <div ng-if="::person.viaf" class="col-xs-6"> <a ng-href="{{ ::person.viaf }}">VIAF</a> </div> <div ng-if="::person.norssit" class="col-xs-6"> <a ng-href="{{ ::person.norssit }}">Norssit</a> </div> <div ng-if="::person.eduskunta" class="col-xs-6"> <a ng-href="{{ ::person.eduskunta }}">Eduskunta</a> </div> <div ng-if="::person.website" class="col-xs-6"> <a ng-href="{{ ::person.website }}">Kotisivu</a> </div> <div ng-if="::person.genicom" class="col-xs-6"> <a ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> </div> <div ng-if="::person.genitree" class="col-xs-6"> <a ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </div> </div> <div ng-if="::person.relative" class="row"> <div class="col-xs-12">Sukulaiset:</div> <div class="col-sm-6 col-md-12" ng-repeat="relative in person.relative | castArray"> {{ ::relative.type }} <a ui-sref="person.detail({ personId: relative.id })">{{ ::relative.name }}</a> </div> </div> <div ng-if="::person.hobby" class="row"> <div class="col-md-12"> <p>Harrastukset: {{ ::person.hobby | castArray | join: \', \' }}</p> </div> </div> <div uib-collapse="!showText"> <hr> <p ng-bind-html="::person.lead_paragraph"></p> </div> </div> </div> </div> </div> <div class="clearfix visible-lg-block" ng-if="($index + 1) % 4 == 0"></div> <div class="clearfix visible-md-block" ng-if="($index + 1) % 3 == 0"></div> <div class="clearfix visible-sm-block" ng-if="($index + 1) % 1 == 0"></div> <div class="clearfix visible-xs-block" ng-if="($index + 1) % 1 == 0"></div> </div> </div> </div>'),e.put("views/search/description.partial.html","<h1>Hae ja selaa</h1> <p> Rajaa elämäkertoja tekemällä valintoja alla olevista suodattimista. Valitse sitten elämäkerta luettavaksi. </p>"),e.put("views/search/table.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/search/description.partial.html\'"></div> <br> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <br><b>Järjestä:</b> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/search/table.partial.html\'"></div> </div> </div> </div>'),e.put("views/search/table.partial.html",'<table class="table table-striped norssi-table ng-table-responsive" ng-table="vm.tableParams"> <thead> <tr> <th class="col-xs-4">Nimi</th> <th class="col-xs-1">Henkilö</th> <th class="col-xs-1">Linkit</th> <th class="col-xs-3 hidden-xs hidden-sm">Matrikkeliteksti</th> </tr> </thead> <tbody> <tr ng-show="!vm.isLoadingResults" ng-repeat="person in $data"> <td class="person-image-container" data-title="\'Nimi\'"> <div ng-class="::{ \'name-col col-md-12 col-lg-7\': person.images }"> <b><a class="notranslate" ui-sref="person.detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b><br> <span class="notranslate" ng-if="::person.birthDate">&#8727;&nbsp;{{ ::person.birthPlace }} {{ ::person.birthDate }}</span> <span class="notranslate" ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace }} {{ ::person.deathDate }}</span> <br> <span class="icon-menu"> <a title="Kansallisbiografia" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="http://ldf.fi/nbf/{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </span> </div> <div ng-if="::person.images" class="name-col col-md-12 col-lg-5"> <div ng-repeat="img in ::person.images" ng-class="{ \'col-md-12\': ($first && $last), \'col-sm-6\': !($first && $last) }" class="person-img-col vcenter"> <img uib-popover-template="\'views/profile-image-popover.html\'" popover-trigger="\'mouseenter\'" popover-placement="auto right" popover-append-to-body="true" class="person-image img img-responsive" ng-src="{{ img  }}"> </div> </div> </td> <td class="links" data-title="\'Henkilö\'"> <div ng-if="::person.occupation" class="hidden-xs hidden-sm"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> </td> <td class="links" data-title="\'Linkit\'"> <div ng-if="::person.achievement"> <a href="" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto top">Saavutukset</a> </div> <a class="link" ng-if="::person.wikipedia" ng-href="{{ ::person.wikipedia }}">Wikipedia</a> <a class="link" ng-if="::person.warsa" ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsa }}">Sotasampo</a> <a class="link" ng-if="::person.fennica[0]" ng-href="{{ ::person.fennica[0] }}">Fennica</a> <a class="link" ng-if="::person.fennica[1]" ng-href="{{ ::person.fennica[1] }}">Fennica (2)</a> <a class="link" ng-if="::person.kirjasampo" ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> <a class="link" ng-if="::person.kulttuurisampo" ng-href="{{ ::person.kulttuurisampo }}">Kulttuurisampo</a> <a class="link" ng-if="::person.blf" ng-href="{{ ::person.blf }}">BLF</a> <a class="link" ng-if="::person.ulan" ng-href="{{ ::person.ulan }}">ULAN</a> <a class="link" ng-if="::person.viaf" ng-href="{{ ::person.viaf }}">VIAF</a> <a class="link" ng-if="::person.norssi" ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ ::person.norssi }}">Norssi</a> <a class="link" ng-if="::person.eduskunta" ng-href="{{ ::person.eduskunta }}">Eduskunta</a> <a class="link" ng-if="::person.website" ng-href="{{ ::person.website }}">Kotisivu</a> <a class="link" ng-if="::person.genicom" ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> <a class="link" ng-if="::person.genitree" ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </td> \x3c!-- \n    <td data-title="\'Muuta\'">\n      <div ng-if="::person.relative">\n      \t<span>Sukulaiset: </span><br>\n      \t<span ng-repeat="relative in person.relative | castArray">\n          {{ ::relative.type }} <a ui-sref="person.detail({ personId: relative.id })">{{ ::relative.name }}</a>\n      \t</span>\n      </div>\n      <div ng-if="::person.hobby"><span>Harrastukset: </span><br>{{ ::person.hobby | join:\', \' }}</div>\n    </td>\n     --\x3e <td data-title="\'Matrikkeliteksti\'" class="hidden-xs hidden-sm"><p ng-bind-html="::person.lead_paragraph"></p></td> </tr> </tbody> </table> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/search/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="search.cards" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-th" aria-hidden="true"></span> Ruudukko</a> </li> <li ui-sref="search.table" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span> Lista</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/sliderFacet.directive.html",'<seco-facet-wrapper> <rzslider rz-slider-model="vm.facet.slider.minValue" rz-slider-high="vm.facet.slider.maxValue" rz-slider-options="vm.facet.slider.options"></rzslider> </seco-facet-wrapper>'),e.put("views/subnavbar.html",'<ul class="nav navbar-nav"> <li ui-sref-active="{ active: \'search.**\' }"><a ui-sref="search.cards"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Henkilöt</a></li> <li ui-sref-active="active"><a target="_self" href="http://biografiasampo.fi/paikat/"> <span class="glyphicon glyphicon-search" aria-hidden="true"></span> Paikat</a></li> <li ui-sref-active="{ active: \'maps.**\' }"><a ui-sref="maps.singleview"> <span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Elämäkartat</a></li> <li ui-sref-active="{ active: \'visu.**\' }"><a ui-sref="visu.statistics"> <span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Tilastot</a></li> <li ui-sref-active="{ active: \'network.**\' }"><a ui-sref="network.net"> <span class="glyphicon glyphicon-link" aria-hidden="true"></span> Verkostot</a></li> <li ui-sref-active="active"><a target="_self" href="http://biografiasampo.fi/yhteyshaku/"> <span class="glyphicon glyphicon-resize-small" aria-hidden="true"></span> Yhteyshaku</a></li> <li ui-sref-active="{ active: \'nlp.**\' }"><a ui-sref="nlp.statistics"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span> Kielianalyysi</a></li> </ul>'),e.put("views/testing.html",'<img src="https://maps.googleapis.com/maps/api/staticmap?center=Pohja,Finland&zoom=5&size=400x300&key=AIzaSyCS7M4hXwmBzV1FwE1p9lIDh1QSPhGqhUU"> <nlp-biography url="http://ldf.fi/nbf/bio4068" active="true"></nlp-biography> <p>kun <span class="kblink" href="kb/artikkeli/4064/">Tarja Halonen</span> valittiin toiselle kaudelle. </p> \x3c!-- \n<p>Hän tuli ylioppilaaksi 1951 Kallion yhteiskoulusta, jota kävivät myös taiteilijaveljekset <span class="kblink" href="kb/artikkeli/1504/">Seppo</span> \nja <span class="kblink" href="kb/artikkeli/4830/">Lassi Nummi</span> sekä kirjailija <span class="kblink" href="kb/artikkeli/4932/">Anu Kaipainen</span>. </p>\n<span class="personlink" url="{{ obj.id }}">{{ obj.name }}</span>\n<span class="personlink" url="http://ldf.fi/nbf/p4901">Sauli Niinistön</span>\n<nbf-biography url="http://ldf.fi/nbf/bio3271"></nbf-biography>\n<nbf-person url="http://ldf.fi/nbf/p6428"></nbf-person>\n\n<br />\n\n<nbf-persongroup url="p6184,p4901,p4902,p4903,p4904,p4905,p4906,p4907,p4908,p4909,p4910"></nbf-persongroup>\nkokeneen kokoomuspoliitikon <span class="personlink" url="http://ldf.fi/nbf/p4901">Sauli Niinistön</span> kanssa\n<br/>\n--\x3e <span class="personlink" url="http://ldf.fi/nbf/p6440">Olli Rehn</span> XXX <nbf-person url="http://ldf.fi/nbf/p4901"></nbf-person> XXX <nbf-persongroup url="http://ldf.fi/nbf/p6184,http://ldf.fi/nbf/p4901,http://ldf.fi/nbf/p4902,http://ldf.fi/nbf/p4903,http://ldf.fi/nbf/p4904,http://ldf.fi/nbf/p4905,http://ldf.fi/nbf/p4906,http://ldf.fi/nbf/p4907,http://ldf.fi/nbf/p4908,http://ldf.fi/nbf/p4909,http://ldf.fi/nbf/p4910"></nbf-persongroup>'),e.put("views/title.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>{{ vm.title.label }}</h1> Under Construction </div> </div> <div class="row"> <div ui-view></div> </div> </div>'),e.put("views/visu/comparison.left.html",'<div class="row"> <div class="col-sm-4"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu/results.partial.html\'"></div> </div> </div>'),e.put("views/visu/comparison.right.html",'<div class="row"> {{ vm.setRightSide() }} <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu/results.partial.html\'"></div> </div> <div class="col-sm-4"> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> </div>'),e.put("views/visu/results.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div ng-if="!vm.isLoadingResults"> <div class="chartcontainer" ng-repeat="id in vm.chart_ids" ng-attr-id="{{ id }}"></div> </div>'),e.put("views/visu/statistics.html",'<div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 chartcontent"> <div ng-include="\'views/visu/results.partial.html\'"></div> </div>'),e.put("views/visu/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="visu.statistics" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Pylväsdiagrammit</a> </li> <li ui-sref="visu.comparison.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> <span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Pylväsdiagrammien vertailu</a> </li> <li ui-sref="visu.statistics2" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Piirakkadiagrammit</a> </li> <li ui-sref="visu.comparison2.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Piirakkadiagrammien vertailu</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/visu/visu.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>'),e.put("views/visu2/comparison.left.html",'<div class="row"> <div class="col-sm-4"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu2/results.partial.html\'"></div> </div> </div>'),e.put("views/visu2/comparison.right.html",'<div class="row"> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu2/results.partial.html\'"></div> </div> <div class="col-sm-4"> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> </div>'),e.put("views/visu2/results.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div ng-if="!vm.isLoadingResults"> <div class="piecontainer" ng-repeat="id in vm.chart_ids" ng-attr-id="{{ id }}"></div> </div>'),e.put("views/visu2/statistics.html",'<div class="col-md-4 pull-md-4 col-lg-3 facetsidebar"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 chartcontent"> <div ng-include="\'views/visu2/results.partial.html\'"></div> </div>'),e.put("views/visu2/visu.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>')}]);