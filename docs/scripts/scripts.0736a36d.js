!function(){"use strict";angular.module("facetApp",["ui.router","seco.facetedSearch","ngTable","angular.filter","ngAnimate","ui.bootstrap","infinite-scroll","uiGmapgoogle-maps","rzModule"]).constant("_",_).constant("google",google).constant("RESULTS_PER_PAGE",25).constant("PAGES_PER_QUERY",1).value("SPARQL_ENDPOINT_URL","https://ldf.fi/nbf/sparql").run(["authStorage",function(e){e.init()}]).run(["google",function(e){e.charts.load("current",{packages:["corechart","line"]})}]).config(["$urlMatcherFactoryProvider",function(e){e.strictMode(!1)}]).config(["$urlRouterProvider",function(e){e.when("","/portal")}]).service("authInterceptor",["$q","$state",function(e,t){this.responseError=function(a){return 401==a.status&&t.go("login"),e.reject(a)}}]).config(["$httpProvider",function(e){e.interceptors.push("authInterceptor")}]).config(["$stateProvider",function(e){e.state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginController",controllerAs:"vm"}).state("portal",{url:"/portal",templateUrl:"views/portal.html",controller:"PortalController",controllerAs:"vm"}).state("person",{abstract:!0,url:"/:personId",templateUrl:"views/person/tabs.html"}).state("person.detail",{url:"",templateUrl:"views/person/detail.html",controller:"DetailController",controllerAs:"vm"}).state("person.map",{url:"/kartta",templateUrl:"views/person/map.html",controller:"MapController",controllerAs:"vm"}).state("person.network",{url:"/verkosto",templateUrl:"views/person/network.html",controller:"PersonNetworkController",controllerAs:"vm"}).state("person.sentence",{url:"/lauseet",templateUrl:"views/person.sentences.html",controller:"PersonSentencesController",controllerAs:"vm"}).state("search",{url:"/haku",templateUrl:"views/search/tabs.html"}).state("search.table",{url:"/lista",templateUrl:"views/search/table.html",controller:"TableController",controllerAs:"vm"}).state("search.cards",{url:"/ruudukko",templateUrl:"views/search/cards.html",controller:"CardsController",controllerAs:"vm"}).state("maps",{url:"/kartta",templateUrl:"views/groupmap/tabs.html"}).state("maps.singleview",{url:"/tapahtumat",templateUrl:"views/groupmap/singleview.html",controller:"GroupmapController",controllerAs:"vm"}).state("maps.comparison",{url:"/vertaatapahtumat",abstract:!0,templateUrl:"views/comparison.html"}).state("maps.comparison.sides",{url:"",views:{"left@maps.comparison":{templateUrl:"views/groupmap/comparison.left.html",controller:"GroupmapController",controllerAs:"vm"},"right@maps.comparison":{templateUrl:"views/groupmap/comparison.right.html",controller:"GroupmapControllerRight",controllerAs:"vm"}}}).state("maps.singleview2",{url:"/elamat",templateUrl:"views/groupmap/singleview2.html",controller:"LifemapController",controllerAs:"vm"}).state("maps.comparison2",{url:"/vertaaelamat",abstract:!0,templateUrl:"views/comparison.html"}).state("maps.comparison2.sides",{url:"",views:{"left@maps.comparison2":{templateUrl:"views/groupmap/comparison2.left.html",controller:"LifemapController",controllerAs:"vm"},"right@maps.comparison2":{templateUrl:"views/groupmap/comparison2.right.html",controller:"LifemapControllerRight",controllerAs:"vm"}}}).state("network",{url:"/verkosto",templateUrl:"views/network.html",controller:"NetworkController",controllerAs:"vm"}).state("nlp",{url:"/nlp",abstract:!0,templateUrl:"views/nlp/nlp.html"}).state("nlp.statistics",{url:"",templateUrl:"views/nlp/statistics.html",controller:"NlpStatisticsController",controllerAs:"vm"}).state("nlp.comparison",{url:"/vertaa",abstract:!0,templateUrl:"views/nlp/comparison.html"}).state("nlp.comparison.sides",{url:"",views:{"left@nlp.comparison":{templateUrl:"views/nlp/comparison.left.html",controller:"NlpComparisonController",controllerAs:"vm"},"right@nlp.comparison":{templateUrl:"views/nlp/comparison.right.html",controller:"NlpComparisonController",controllerAs:"vm"}}}).state("visu",{url:"/visu",templateUrl:"views/visu/tabs.html"}).state("visu.statistics",{url:"/palkit",templateUrl:"views/visu/statistics.html",controller:"VisuColumnController",controllerAs:"vm"}).state("visu.comparison",{url:"/vertaapalkit",abstract:!0,templateUrl:"views/comparison.html"}).state("visu.comparison.sides",{url:"",views:{"left@visu.comparison":{templateUrl:"views/visu/comparison.left.html",controller:"VisuColumnController",controllerAs:"vm"},"right@visu.comparison":{templateUrl:"views/visu/comparison.right.html",controller:"VisuColumnControllerRight",controllerAs:"vm"}}}).state("visu2",{url:"/visu2",abstract:!0,templateUrl:"views/visu2/visu.html"}).state("visu.statistics2",{url:"/piiraat",templateUrl:"views/visu2/statistics.html",controller:"VisuPieController",controllerAs:"vm"}).state("visu.comparison2",{url:"/vertaapiiraat",abstract:!0,templateUrl:"views/comparison.html"}).state("visu.comparison2.sides",{url:"",views:{"left@visu.comparison2":{templateUrl:"views/visu2/comparison.left.html",controller:"VisuPieController",controllerAs:"vm"},"right@visu.comparison2":{templateUrl:"views/visu2/comparison.right.html",controller:"VisuPieControllerRight",controllerAs:"vm"}}}).state("testing",{url:"/testing",templateUrl:"views/testing.html",controller:"CardsController",controllerAs:"vm"})}])}(),function(){"use strict";angular.module("facetApp").service("authStorage",["$window","$http",function(e,t){function a(a){return t.defaults.headers.common.Authorization="Basic "+a,e.sessionStorage.setItem("sparqlAuthToken",a)}function i(){return e.sessionStorage.getItem("sparqlAuthToken")}this.init=function(){var e=i();e&&a(e)},this.setToken=a,this.getToken=i,this.clearToken=function(){e.sessionStorage.removeItem("sparqlAuthToken")}}])}(),function(){"use strict";function e(e,t,a,i){this.login=function(e,n){a.clearToken();var s=btoa(e+":"+n),o={headers:{Authorization:"Basic "+s}};return t.get(i+"?query=ASK{}",o).then(function(){return a.setToken(s),!0}).catch(function(){return!1})}}angular.module("facetApp").service("loginService",e),e.$inject=["$q","$http","authStorage","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";angular.module("facetApp").filter("castArray",["_",function(e){return function(t){return e.castArray(t)}}])}(),function(){"use strict";function e(e,t,a){n.prototype.postProcess=function(a){return a.forEach(function(a){if(a.images=a.images?t.castArray(a.images):["images/person_placeholder.cd371769.svg"],a.imagesources=a.imagesources?t.castArray(a.imagesources):[!1],a.description&&(a.description=e.trustAsHtml(a.description)),a.source_paragraph&&(a.source_paragraph=e.trustAsHtml(a.source_paragraph)),a.lead_paragraph&&(a.lead_paragraph=e.trustAsHtml(a.lead_paragraph)),a.norssi&&(a.norssi=a.norssi.replace("http://ldf.fi/norssit/","")),a.kirjasampo&&(a.kirjasampo=a.kirjasampo.replace("http://","https://")),a.fennica){a.fennica.constructor!==Array&&(a.fennica=[a.fennica]);for(var i=0;i<a.fennica.length;i++)a.fennica[i]="http://data.nationallibrary.fi/"+a.fennica[i].replace("http://urn.fi/URN:NBN:fi:","").replace(/:/g,"/")}a.givenName||(a.givenName=""),a.familyName||(a.familyName=""),a.givenName.constructor===Array&&2==a.givenName.length&&(a.givenName=a.givenName[0]+" ja "+a.givenName[1])}),a};var i=Object.getPrototypeOf(a);return n.prototype=angular.extend({},i,n.prototype),new n;function n(){this.objectClass=Object}}angular.module("facetApp").factory("personMapperService",e),e.$inject=["$sce","_","objectMapperService"]}(),function(){"use strict";function e(e,t){this.getFacets=function(){var t=angular.copy(a);return e.when(t)},this.getFacetOptions=function(){return angular.copy(i)};var a={entryText:{facetId:"entryText",graph:"<http://ldf.fi/nbf/people>",name:"Haku nimen perusteella",enabled:!0},dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source>",name:"Tietokanta",chart:!0,enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"fennica",pattern:"?id <http://ldf.fi/nbf/fennica> [] .",label:"Fennica - Suomen kansallisbibliografia"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsampo> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssi> [] .",label:"Norssit"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] . ",label:"Kirjasampo"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"Biografiskt lexikon för Finland"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"},{id:"yo1853",pattern:"?id <http://ldf.fi/nbf/yo1853> [] .",label:"Ylioppilasmatrikkeli 1853–1899"}],chart:!0,enabled:!0,name:"Linkitetyt tietokannat"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",chart:!0,enabled:!0},familyName:{facetId:"familyName",predicate:"<http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://schema.org/familyName>",chart:!0,name:"Sukunimi"},author:{facetId:"author",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://schema.org/author>",chart:!0,name:"Kirjoittaja"},place:{facetId:"place",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place>",name:"Synnyinpaikka",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:5,enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/has_title>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Arvo, ammatti tai toiminta",chart:!0,enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/related_company>",name:"Yritys tai yhteisö",chart:!0,enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>",name:"Toimiala",chart:!0,enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli tai ryhmä",chart:!0,enabled:!0},keywords:{facetId:"keywords",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://purl.org/dc/elements/1.1/subject>",name:"Avainsanat",chart:!0,enabled:!0}},i={endpointUrl:{endpointUrl:t,usePost:!0}.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://www.w3.org/2004/02/skos/core#prefLabel> ?familyName . ?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"}}angular.module("facetApp").service("facetService",e),e.$inject=["$q","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t){this.getFacets=function(){var t=angular.copy(a);return e.when(t)},this.getFacetOptions=function(){return angular.copy(i)};var a={dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source>",name:"Tietokanta",enabled:!0},slider:{facetId:"slider",name:"Rajaa henkilöiden syntymäaika",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart>",enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"fennica",pattern:"?id <http://ldf.fi/nbf/fennica> [] .",label:"Fennica - Suomen kansallisbibliografia"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsampo> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssi> [] .",label:"Norssit"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] . ",label:"Kirjasampo"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"Biografiskt lexikon för Finland"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"},{id:"yo1853",pattern:"?id <http://ldf.fi/nbf/yo1853> [] .",label:"Ylioppilasmatrikkeli 1853–1899"}],enabled:!0,chart:!0,name:"Linkitetyt tietokannat"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",enabled:!0},author:{facetId:"author",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://schema.org/author>",name:"Kirjoittaja"},birthYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>",name:"Synnyinaika",enabled:!0},place:{facetId:"place",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>)/<http://ldf.fi/nbf/place>",name:"Syntymäpaikka",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:5,enabled:!0},deathplace:{facetId:"deathplace",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>)/<http://ldf.fi/nbf/place>",name:"Kuolinpaikka",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:5,enabled:!0},deathYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>/<http://ldf.fi/nbf/time>",name:"Kuolinaika",enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/has_title>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Arvo, ammatti tai toiminta",chart:!0,enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/related_company>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Yritys tai yhteisö",enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Toimiala",enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli tai ryhmä",chart:!0,enabled:!0},keywords:{facetId:"keywords",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://purl.org/dc/elements/1.1/subject>",name:"Avainsanat",chart:!0,enabled:!0}},i={endpointUrl:{endpointUrl:t,usePost:!0}.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"}}angular.module("facetApp").service("mapfacetService",e),e.$inject=["$q","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r){this.getResults=function(e){return w.getResults(e,function(){var e,i=t.search().sortBy;a.isString(i)||(i="?ordinal");e="?ordinal"===i?t.search().desc?i:"DESC("+i+")":t.search().desc?"DESC("+i+")":i;return"?ordinal"===i?e:e+" ?ordinal"}())},this.getFacets=i.getFacets,this.getFacetOptions=i.getFacetOptions,this.updateSortBy=function(e){(t.search().sortBy||"?ordinal")===e&&t.search("desc",!t.search().desc||null);t.search("sortBy",e)},this.getSortClass=function(e,a){var i=t.search().sortBy||"?ordinal",n=a?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";if("?ordinal"===e){if(i===e)return t.search().desc?n:n+"-alt"}else if(i===e)return t.search().desc?n+"-alt":n},this.getPerson=function(t){var a=l+c,i="VALUES ?idorg { <"+t+"> } . ?idorg owl:sameAs* ?id . FILTER NOT EXISTS { ?id owl:sameAs [] } ";return k.getObjects(a.replace("<RESULT_SET>",i)).then(function(t){return t.length?t[t.length-1]:e.reject("Not found")})},this.getRelatives=function(e){var t=l+p,a="VALUES ?idorg { <"+e+"> } . ?idorg owl:sameAs* ?id . FILTER NOT EXISTS { ?id owl:sameAs [] } ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a)).then(function(e){return e})},this.getSimilar=function(e){var t=l+u,a="VALUES ?id { <"+e+"> } . ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a)).then(function(e){return e})},this.getAuthors=function(e){var t=l+m,a="VALUES ?id { <"+e+"> } . ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a))},this.getByAuthor=function(e){var t=l+f,a="VALUES ?id2 { <"+e+"> } . ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a))},this.getAuthoredBios=function(e){var t=l+g,a="VALUES ?prs { <"+e+"> } . ?prs (owl:sameAs*|^owl:sameAs*) ?author . ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a))},this.getByReferences=function(e){var t=l+h,a="VALUES ?id2 { <"+e+"> } . ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a)).then(function(e){return e})},this.getBios=function(e){var t=l+d,a="VALUES ?id { <"+e+"> } . ";return k.getObjectsNoGrouping(t.replace("<RESULT_SET>",a)).then(function(e){return e})},this.getPortal=function(){return k.getObjectsNoGrouping(l+v).then(function(e){return e})};var l=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX sources:\t<http://ldf.fi/nbf/sources/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX rels: <http://ldf.fi/nbf/relations/> ",c=" SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   ?id skosxl:prefLabel ?plabel .   \t  OPTIONAL { ?plabel schema:givenName ?givenName . }  \t  OPTIONAL { ?plabel schema:familyName ?familyName . }   OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:fennica ?fennica . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id nbf:warsampo ?warsampo . }  OPTIONAL { ?id nbf:norssi ?norssi . }  OPTIONAL { ?id nbf:kirjasampo ?kirjasampo . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:genicom ?genicom . }  OPTIONAL { ?id nbf:genitree ?genitree . }  OPTIONAL { ?id nbf:yo1853 ?yo1853 . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { ?idorg (owl:sameAs*|^owl:sameAs+)/dct:source/skos:prefLabel ?source . }  OPTIONAL { ?id foaf:focus ?prs .   \t\tOPTIONAL { ?prs ^crm:P98_brought_into_life ?bir .   \t\t\tOPTIONAL { ?bir nbf:place/skos:prefLabel ?birthPlace }   \t\t\tOPTIONAL { ?bir nbf:time/skos:prefLabel ?birthDate }\t\t}   \t\tOPTIONAL { ?prs ^crm:P100_was_death_of ?dea . \t\t\tOPTIONAL { ?dea nbf:time/skos:prefLabel ?deathDate }  \t\t\tOPTIONAL { ?dea nbf:place/skos:prefLabel ?deathPlace }\t\t}   \t\tOPTIONAL { ?prs nbf:image [ schema:image ?images ; dct:source/skos:prefLabel ?imagesources ] }  \t\tOPTIONAL { ?prs ^bioc:inheres_in ?occupation_id .   \t\t\t?occupation_id a nbf:Occupation ; skos:prefLabel ?occupation }  \t\tOPTIONAL { ?prs nbf:has_category ?category . }  } }",p='SELECT DISTINCT ?type (?relative__id AS ?id2) ?name  WHERE { <RESULT_SET>    VALUES (?class ?order) {     ( rels:Father 0)     ( rels:Mother 1)     ( rels:Parent 2)     ( rels:Spouse 3)     ( rels:Child 4)     ( rels:Daughter 4)     ( rels:Son 4 ) }    { ?id bioc:has_family_relation [          bioc:inheres_in ?rel ;         a ?class ;         a/skos:prefLabel ?type ] .    } UNION    { ?rel bioc:has_family_relation [          bioc:inheres_in ?id ;          a ?class ;         bioc:inverse_role/skos:prefLabel ?type ] .    }    FILTER (LANG(?type)="fi")    ?rel owl:sameAs* ?relative__id .    FILTER NOT EXISTS { ?relative__id owl:sameAs [] }    ?relative__id skosxl:prefLabel ?relative__label .    OPTIONAL { ?relative__label schema:familyName ?relative__familyName }    OPTIONAL { ?relative__label schema:givenName ?relative__givenName }    BIND (REPLACE(CONCAT( COALESCE(?relative__givenName,"") ," ", COALESCE(?relative__familyName,"")),"[(][^)]+[)]\\\\s*","") AS ?name)    OPTIONAL { ?relative__id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime } } ORDER BY ?order ?btime ',d="SELECT DISTINCT * WHERE { { <RESULT_SET> } ?id owl:sameAs*|^owl:sameAs ?prs . ?prs foaf:focus/nbf:has_biography ?bio .  OPTIONAL { ?bio dct:source ?source . ?source skos:prefLabel ?database }} ORDER BY str(?source)",u="SELECT DISTINCT ?prs ?label WHERE {   { <RESULT_SET> }   ?dst a nbf:Distance ;         bioc:relates_to ?id, ?prs ;         nbf:value ?value .   FILTER (?prs!=?id)  } ORDER BY DESC(?value) LIMIT 16 ",m='SELECT DISTINCT (?author AS ?author__url) ?author__name WHERE {   { <RESULT_SET> }   ?id owl:sameAs*|^owl:sameAs ?prs .   ?prs foaf:focus/nbf:has_biography/schema:author ?author .   ?author skosxl:prefLabel ?author__label .   OPTIONAL { ?author__label schema:familyName ?author__fname }   OPTIONAL { ?author__label schema:givenName ?author__gname }   BIND (CONCAT(COALESCE(?author__gname, "")," ",COALESCE(?author__fname, "")) AS ?author__name) } ORDER BY ?author__fname ?author__gname ',f='SELECT DISTINCT (?id as ?id__url) ?id__name WHERE {   {   SELECT DISTINCT ?author ?id2 ?prs2     WHERE {         <RESULT_SET>         ?id2 owl:sameAs*|^owl:sameAs ?prs2 .         ?prs2 foaf:focus/nbf:has_biography/nbf:authors ?author .     }   }   ?prs foaf:focus/nbf:has_biography/nbf:authors ?author .   ?prs owl:sameAs* ?id .   FILTER NOT EXISTS {?id owl:sameAs []}   FILTER (?id != ?prs2 && ?id != ?id2)   ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }   OPTIONAL { ?id__label schema:givenName ?id__gname }   BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY UCASE(?id__fname) ?id__gname ',g='SELECT DISTINCT  (?id as ?id__url) ?id__name WHERE {   { <RESULT_SET> }   ?id foaf:focus/nbf:has_biography/schema:author ?author .      ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }   OPTIONAL { ?id__label schema:givenName ?id__gname }   BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY UCASE(?id__fname) ?id__gname ',h='SELECT distinct (?id as ?id__url) ?id__name WHERE {  <RESULT_SET>    ?id2 nbf:formatted_link ?target .   BIND (URI(CONCAT("file:///tmp/data/",?target)) AS ?target_link)   SERVICE <http://ldf.fi/nbf-nlp/sparql> {    ?par <http://purl.org/dc/elements/1.1/source>/<http://ldf.fi/nbf/biography/data#link> ?target_link ;         dct:isPartOf/<http://ldf.fi/nbf/biography/data#bioId> ?id .  }   ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }   OPTIONAL { ?id__label schema:givenName ?id__gname }   BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY UCASE(?id__fname) ?id__gname ',v="SELECT * WHERE { ?x ?y ?z } LIMIT 1 ",b={endpointUrl:s,usePost:!0},w=new n(b,{mapper:r,queryTemplate:' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }  FILTER not exists { ?id owl:sameAs [] }  ?id skosxl:prefLabel ?plabel .   \t\tOPTIONAL { ?plabel schema:givenName ?givenName . }  \t\tOPTIONAL { ?plabel schema:familyName ?familyName . }  OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:fennica ?fennica . }  OPTIONAL { ?id nbf:warsampo ?warsampo . }  OPTIONAL { ?id nbf:norssi ?norssi . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:genicom ?genicom . }  OPTIONAL { ?id nbf:genitree ?genitree . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id nbf:kirjasampo ?kirjasampo . }  OPTIONAL { ?id nbf:yo1853 ?yo1853 . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { ?id foaf:focus ?prs .   \t\tOPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:place/skos:prefLabel ?birthPlace }   \t\tOPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:time/skos:prefLabel ?birthDate . }  \t\tOPTIONAL { ?prs ^crm:P100_was_death_of/nbf:time/skos:prefLabel ?deathDate . }  \t\tOPTIONAL { ?prs ^crm:P100_was_death_of/nbf:place/skos:prefLabel ?deathPlace }  \t\tOPTIONAL { ?prs schema:gender ?gender . }  \t\tOPTIONAL { ?prs nbf:image [ schema:image ?images ] }  \t\tOPTIONAL { ?prs ^bioc:inheres_in ?occupation_id .   \t\t\t?occupation_id a nbf:Occupation ; skos:prefLabel ?occupation   \t\t\tOPTIONAL { ?occupation_id nbf:related_company ?company . }\t\t}  \t\tOPTIONAL { ?prs nbf:has_category ?category . }  \t\tOPTIONAL { ?prs nbf:has_biography ?bio .   \t\t\tOPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?lead_paragraph ; nbf:id "0"^^xsd:integer  ] }  \t\t} } }',prefixes:l,paging:!0,pagesPerQuery:2}),k=new o(b,r)}angular.module("facetApp").service("nbfService",e),e.$inject=["$q","$location","_","facetService","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i){this.getEvents=function(t){var a="VALUES ?idorg { <"+t+"> } . ?idorg owl:sameAs* ?pc . ";return o.getObjects(n+s.replace(/<RESULT_SET>/g,a)).then(function(t){return t.length?t:e.reject("Henkilölle ei ole kartalla näytettäviä tapahtumia.")})};var n=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",s='SELECT DISTINCT ?givenName ?familyName ?relative ?class ?id ?time__start ?time__end ?time__label ?time__span  ?label ?place__uri ?place__latitude ?place__longitude ?place__name   WHERE {   {   { <RESULT_SET> }      ?pc a nbf:PersonConcept ;              foaf:focus ?prs ;   \t\t       skosxl:prefLabel ?ilabel .      { ?id crm:P100_was_death_of ?prs . }   UNION   { ?id crm:P98_brought_into_life ?prs . }   UNION   { ?id bioc:inheres_in ?prs . }     ?id a/skos:prefLabel ?class .    FILTER (lang(?class)="en")      ?id nbf:time ?time . \t\t   OPTIONAL { ?time gvp:estStart ?time__start. }   \t\t   OPTIONAL { ?time gvp:estEnd ?time__end. }   \t\t   OPTIONAL { ?time skos:prefLabel ?time__label. }         BIND ( CONCAT(       IF(bound(?time__start),str(year(?time__start)),""),       "-",       IF(bound(?time__end),str(year(?time__end)),"")     ) AS ?time__span)      OPTIONAL { ?id skos:prefLabel ?label }      OPTIONAL { ?id nbf:place ?place__uri .     \t     ?place__uri geo:lat ?place__latitude ;                             geo:long ?place__longitude  ;    \t\t                 skos:prefLabel ?place__name .  }        OPTIONAL { ?ilabel schema:givenName ?givenName }   OPTIONAL { ?ilabel schema:familyName ?familyName }   } UNION {       { <RESULT_SET> }      ?pc a nbf:PersonConcept ;       bioc:has_family_relation ?id ;       skosxl:prefLabel ?ilabel .         ?id bioc:inheres_in/owl:sameAs* ?relative .   FILTER NOT EXISTS { ?relative owl:sameAs [] }      OPTIONAL { ?ilabel schema:givenName ?givenName }   OPTIONAL { ?ilabel schema:familyName ?familyName }      ?id a/skos:prefLabel ?class .    FILTER (lang(?class)="en")      ?id nbf:time ?time . \t\t   OPTIONAL { ?time gvp:estStart ?time__start. }   \t\t   OPTIONAL { ?time gvp:estEnd ?time__end. }   \t\t   OPTIONAL { ?time skos:prefLabel ?time__label. }   \t       BIND ( CONCAT(       IF(bound(?time__start),str(year(?time__start)),""),       "-",       IF(bound(?time__end),str(year(?time__end)),"")     ) AS ?time__span)      OPTIONAL { ?id skos:prefLabel ?label }      OPTIONAL {     VALUES ?class { "Child"@en "Son"@en "Daughter"@en  }   \t?relative foaf:focus/^crm:P98_brought_into_life/nbf:place ?place__uri .    \t     ?place__uri geo:lat ?place__latitude ;                             geo:long ?place__longitude  ;    \t\t                 skos:prefLabel ?place__name .  }   } } ORDER BY ?time__start DESC(?time__end) ',o=new a({endpointUrl:t,usePost:!0},i)}angular.module("facetApp").service("mapService",e),e.$inject=["$q","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s){var o=this;o.changed=c,o.clear=function(){o.facet.clear(),l()},o.enableFacet=function(){o.facet.enable()},o.disableFacet=function(){o.facet.disable(),l()},o.isFacetEnabled=function(){if(!o.facet)return!1;return o.facet.isEnabled()};var r=e.$watch("options",function(a){var l;a&&(l=e.$on(n,function(a,i){var n=t.cloneDeep(e.options);n.initial=i.facets,n.update=c,o.facet=new s(n),l()}),e.$emit(i),r())});function l(){var t={id:o.facet.facetId,constraint:o.facet.getConstraint(),value:o.facet.getSelectedValue(),priority:o.facet.getPriority()};e.$emit(a,t)}function c(){l()}}function t(e){return t.prototype.getConstraint=function(){var e=this.slider.minValue,t=this.slider.maxValue,a="?slider_"+this.internalId;return"?id <PREDICATE> <OBJ> . FILTER (<STARTYEAR><=year(<OBJ>) && year(<OBJ>)<=<ENDYEAR>) ".replace(/<OBJ>/g,a).replace(/<PREDICATE>/g,this.predicate).replace("<STARTYEAR>",e).replace("<ENDYEAR>",t)},t.prototype.getPriority=function(){return this.config.priority},t.prototype.getPreferredLang=function(){return this.config.preferredLang},t.prototype.disable=function(){this.selectedValue=void 0,this._isEnabled=!1},t.prototype.enable=function(){this._isEnabled=!0},t.prototype.clear=function(){},t.prototype.isEnabled=function(){return this._isEnabled},t.prototype.getSelectedValue=function(){return{min:this.slider.minValue,max:this.slider.maxValue}},t;function t(t){this.config=angular.extend({},{preferredLang:"fi"},t),this.name=this.config.name,this.facetId=this.config.facetId,this.predicate=this.config.predicate,this.config.enabled?this.enable():this.disable(),this.internalId=e.uniqueId();var a=parseInt(this.config.min)||200,i=parseInt(this.config.max)||(new Date).getFullYear();this.slider={minValue:a,maxValue:i,options:{floor:a,ceil:i,step:10,draggableRange:!0,onEnd:this.config.update}};var n=e.get(t,"initial."+this.facetId+".value");n&&(this._isEnabled=!0,this.slider.minValue=n.min,this.slider.maxValue=n.max)}}angular.module("seco.facetedSearch").factory("SliderFacet",t).controller("SliderFacetController",e).directive("secoSliderFacet",function(){return{restrict:"E",scope:{options:"="},controller:"SliderFacetController",controllerAs:"vm",templateUrl:"views/sliderFacet.directive.html"}}),e.$inject=["$scope","_","EVENT_FACET_CHANGED","EVENT_REQUEST_CONSTRAINTS","EVENT_INITIAL_CONSTRAINTS","SliderFacet"],t.$inject=["_"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r){this.getResults=function(e,t,a){var i=(t[0]?"( crm:P98_brought_into_life nbf:Birth 0) ":"")+(t[1]?"( crm:P100_was_death_of nbf:Death 1) ":"")+(t[2]?"( bioc:inheres_in nbf:Career 2 ) ":"")+(t[3]?"( bioc:inheres_in nbf:Product 3 ) ":"")+(t[4]?"( bioc:inheres_in nbf:Honour 4 ) ":""),n=l+c.replace("<RESULT_SET>",e.constraint.join(" ")).replace("<VALUES>",i).replace("<LIMIT>",a);return m.getObjectsNoGrouping(n)},this.getResults2=function(e,t){var a=l+p.replace("<RESULT_SET>",e.constraint.join(" ")).replace("<LIMIT>",t);return m.getObjectsNoGrouping(a)},this.getResults3=function(e,t){var a="SELECT ?evt__lat ?evt__long (COUNT(?prs) AS ?count) ?type WHERE {     <RESULT_SET>            ?id foaf:focus ?prs .   VALUES (?prop ?eclass ?type) { "+(t[0]?"( crm:P98_brought_into_life nbf:Birth 0) ":"")+(t[1]?"( crm:P100_was_death_of nbf:Death 1) ":"")+(t[2]?"( bioc:inheres_in nbf:Career 2 ) ":"")+(t[3]?"( bioc:inheres_in nbf:Product 3 ) ":"")+(t[4]?"( bioc:inheres_in nbf:Honour 4 ) ":"")+"  }   ?evt__id ?prop ?prs ;      a ?eclass ;    \tnbf:place [        \t\tgeo:lat ?evt__lat ;       \t\tgeo:long ?evt__long    ] . } GROUP BY ?evt__lat ?evt__long ?evt__class ?type HAVING(?count>0) LIMIT 500 ",i=l+a.replace("<RESULT_SET>",e.constraint.join(" "));return m.getObjectsNoGrouping(i)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return u};var l=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",c='SELECT * WHERE {   { SELECT ?place__uri (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(DISTINCT ?url; separator=",") AS ?person__ids) ?type WHERE {      { SELECT ?id ?id2 WHERE { <RESULT_SET> ?id owl:sameAs* ?id2 . FILTER NOT EXISTS { ?id2 owl:sameAs [] } } LIMIT <LIMIT> } FILTER(BOUND(?id))      VALUES (?prop ?eclass ?type) { <VALUES> }     ?id foaf:focus ?prs .     ?evt__id ?prop ?prs ;           a ?eclass ;            nbf:place ?place__uri .   BIND (replace(str(?id2),"http://ldf.fi/nbf/","") AS ?url)    } GROUP BY ?place__uri ?type ORDER BY DESC(?count)   }   FILTER (?count>0)   ?place__uri geo:lat ?place__latitude ;         \tgeo:long ?place__longitude ;     \t\tskos:prefLabel ?place__label .   FILTER (lang(?place__label)="fi") }  ',p='SELECT * WHERE {   {   SELECT DISTINCT ?birth__place ?death__place (COUNT(distinct ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?person__ids) WHERE {     <RESULT_SET>     ?id owl:sameAs* ?id2 .     FILTER NOT EXISTS { ?id2 owl:sameAs [] } .     ?id foaf:focus ?prs .      ?birth__id crm:P98_brought_into_life ?prs ;               nbf:place ?birth__place .      ?death__id crm:P100_was_death_of ?prs ;                nbf:place ?death__place .            BIND (replace(str(?id2),"http://ldf.fi/nbf/","") AS ?url)    } GROUP BY ?birth__place ?death__place ORDER BY DESC(?count) LIMIT <LIMIT>  }   FILTER (?count>0)   ?birth__place geo:lat ?birth__latitude ;               geo:long ?birth__longitude ;               skos:prefLabel ?birth__label .   FILTER (LANG(?birth__label)="fi")      ?death__place geo:lat ?death__latitude ;               geo:long ?death__longitude ;               skos:prefLabel ?death__label .   FILTER (LANG(?death__label)="fi") } ORDER BY ?count ',d={endpointUrl:n,usePost:!0},u={endpointUrl:d.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},m=(new i(d,{mapper:r,queryTemplate:c,prefixes:l,paging:!1,pagesPerQuery:1}),new o(d,r))}angular.module("facetApp").service("groupmapService",e),e.$inject=["$q","$location","_","FacetResultHandler","SPARQL_ENDPOINT_URL","mapfacetService","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i){return{link:function(e,i){return t("navbar-fi.html").then(function(e){return i.html(e),t("views/subnavbar.html")}).then(function(t){return angular.element("#subnav").html(t),a(i.contents())(e)})},controller:function(){this.showHelp=function(){i.open({templateUrl:"views/help.html",size:"lg"})}},controllerAs:"vm"}}angular.module("facetApp").directive("wsNavbar",e),e.$inject=["$location","$templateRequest","$compile","$uibModal"]}(),function(){"use strict";function e(e,t,a){var i=this;i.login=function(){return a.login(i.un,i.pw).then(function(a){if(a)return e.transitionTo("portal",t,{reload:!0,inherit:!1,notify:!0});i.error="Kirjautuminen epäonnistui"})}}angular.module("facetApp").controller("LoginController",e),e.$inject=["$state","$stateParams","loginService"]}(),function(){"use strict";function e(e,t,a,i,n){var s=this;function o(e){s.isLoadingResults=!1,s.error=e}s.openPage=function(){t.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return s.person}}})},i.getPerson(e.personId).then(function(e){return s.person=e,s.person.externalLinks=function(e){var t=e,a=[];return t.genicom&&a.push({url:t.genicom,label:"Geni.com, kotisivu"}),t.genitree&&a.push({url:t.genitree,label:"Geni.com, sukupuu"}),t.kirjasampo&&a.push({url:t.kirjasampo,label:"Kirjasampo"}),t.norssi&&a.push({url:"https://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F"+t.norssi,label:"Norssit"}),t.warsampo&&a.push({url:"https://www.sotasampo.fi/fi/persons/?uri="+t.warsampo,label:"Sotasampo"}),t.wikipedia&&a.push({url:t.wikipedia,label:"Wikipedia"}),t.yo1853&&a.push({url:"https://ylioppilasmatrikkeli.helsinki.fi/1853-1899/henkilo.php?id="+t.yo1853,label:"Ylioppilasmatrikkeli 1853–1899"}),a=a.map(function(e){return e.url=e.url.replace(/^http[s]*:/,""),e})}(e),i.getBios(s.person.id).then(function(e){e.length&&(s.person.bios=e,s.setTab(0))}),i.getRelatives(s.person.id).then(function(e){e.length&&(s.person.relative=e)}),i.getAuthoredBios(s.person.id).then(function(e){e.length&&(s.person.authoredBios=e)}),i.getSimilar(s.person.id).then(function(e){e.length&&(s.person.similar=e)}),i.getAuthors(s.person.id).then(function(e){e.length&&(s.person.authors=e)}),i.getByAuthor(s.person.id).then(function(e){e.length&&(s.person.sameAuthor=e)}),i.getByReferences(s.person.id).then(function(e){e.length&&(s.person.referenced=e)}),e}).catch(o),s.setTab=function(e){s.tab=e},s.isSet=function(e){return s.tab===e}}angular.module("facetApp").controller("DetailController",e),e.$inject=["$stateParams","$uibModal","_","nbfService","$sce"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.openPage=function(e){a.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return e}}})},c.removeFacetSelections=function(){t.reload()},c.sortBy=function(e){return s.updateSortBy(e),m({constraint:c.previousSelections})},c.getSortClass=s.getSortClass;var p=e.$on("sf-initial-constraints",function(e,t){u(e,t),p()});function d(e){return c.isLoadingResults=!0,c.pager.getPage(e.page()-1,e.count()).then(function(e){return c.pager.getTotalCount().then(function(t){return c.tableParams.total(t),e}).then(function(e){return c.isLoadingResults=!1,e})})}function u(e,t){return l.updateUrlParams(t),c.previousSelections=i.clone(t.constraint),m(t)}function m(e){c.isLoadingResults=!0,s.getResults(e).then(function(e){c.pager=e,c.tableParams?(c.tableParams.page(1),c.tableParams.reload()):c.tableParams=new o({count:n},{getData:d})})}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){var a;c.facets=t,c.facetOptions=((a=s.getFacetOptions()).initialState=l.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=e,c.handler=new r(c.facetOptions)})}angular.module("facetApp").controller("TableController",e),e.$inject=["$scope","$state","$uibModal","_","RESULTS_PER_PAGE","nbfService","NgTableParams","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i){var n=this;n.openPage=function(){t.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return n.person}}})},n.map={center:{latitude:62,longitude:24},zoom:6},n.markers=[],n.focusEvent=function(e){n.currentEvent=e.id+": "+e.label,e.markers.forEach(function(e){e.options.icon.strokeWeight=4,e.options.zIndex+=100})},n.unfocusEvent=function(e){n.currentEvent=".",e.markers.forEach(function(e){e.options.icon.strokeWeight=1,e.options.zIndex-=100})},i.getEvents(e.personId).then(function(e){return n.currentEvent=".",n.events=e,e.length&&(n.person=e[0]),n.events=function(e,t){var a=(new Date).getFullYear(),i=!1,n=0;t.min_time=a,t.max_time=0;var s={};e.forEach(function(e){e.place&&e.place.uri&&(["uri","latitude","longitude"].forEach(function(t){e.place[t]&&e.place[t].constructor!==Array&&(e.place[t]=[e.place[t]])}),e.place.uri.forEach(function(t){s.hasOwnProperty(t)||(s[t]={count:0,latitude:e.place.latitude,longitude:e.place.longitude,type:e.class}),s[t].count+=1}))});var l=[[],[],[],[]];return e.forEach(function(e){e.y=0,e.r=1,e.markers=[],e.blobs=[],e.time.span.constructor!==Array&&(e.time.span=[e.time.span]),e.time.span.forEach(function(a){var i=a.split("-"),n={};""!=i[0]&&(i[0]=parseInt(i[0]),i[0]<t.min_time&&(t.min_time=i[0]),t.max_time<i[0]&&(t.max_time=i[0]),n.estStart=i[0]),""!=i[1]&&(i[1]=parseInt(i[1]),i[1]<t.min_time&&(t.min_time=i[1]),t.max_time<i[1]&&(t.max_time=i[1]),n.estEnd=i[1]),e.blobs.push(n)}),e.label||(e.label=""),e.class||(e.class="event"),e.class=e.class.toLowerCase();var a=0;switch(e.class){case"death":i=!0,e.label="Kuollut "+e.label,e.r=1.5;break;case"birth":e.label="Syntynyt "+e.label,e.place&&e.place.latitude&&(t.map.center={latitude:e.place.latitude[0],longitude:e.place.longitude[0]}),e.r=1.5,t.min_time<e.blobs[0].estStart&&(t.min_time=e.blobs[0].estStart);break;case"spouse":case"child":e.relative&&(e.relativelink=e.relative),e.label=e.label+", "+e.time.label;break;case"career":e.y=5,a=1;break;case"product":e.y=10,a=2;break;case"honour":e.y=15,a=3;break;default:e.y=5,e.class="event",a=1}if(l[a].push(e),e.id=++n,e.place&&e.place.latitude)for(var r=0;r<e.place.latitude.length;r++){var c=e.place.uri[r]&&s[e.place.uri[r]]&&s[e.place.uri[r]].count?15*Math.sqrt(s[e.place.uri[r]].count):15,p=o(e.place.latitude[r],e.place.longitude[r],e.id,e.class,c);e.markers.push(p),t.markers.push(p)}}),l.forEach(function(e){(function(e){for(var t={},a=e.length,i=0;i<a;i++)e[i].blobs.forEach(function(e){for(var a=e.estStart?e.estStart:e.estEnd-3,n=e.estEnd?e.estEnd:a+3,s=a;s<=n;s++)t[s]=i});var n=Array(a).fill(!1);for(var s in t)n[t[s]]=!0;for(var o=[],i=0;i<a;i++)n[i]||o.push(i);return o})(e).forEach(function(t){e[t].y+=2.5})}),i||(t.max_time+=15),t.max_time<=t.min_time&&(t.max_time=t.min_time+75),t.max_time>t.min_time+150&&(t.max_time=t.min_time+150),t.max_time>a&&(t.max_time=a),e.forEach(function(e){e.path="";var a=.1*Math.random();e.blobs.forEach(function(i){var n=i.estStart?r(i.estStart,t.min_time,t.max_time)+a:void 0,s=i.estEnd?r(i.estEnd,t.min_time,t.max_time)+a:void 0;n?s?e.path+="M"+n+","+(e.y-e.r)+" a"+e.r+","+e.r+",0,0,0,0,"+2*e.r+" H"+s+" a"+e.r+","+e.r+",0,0,0,0,-"+2*e.r+" Z":(s=n+3,e.path+="M"+s+","+(e.y-e.r)+" H"+n+" a"+e.r+","+e.r+",0,0,0,0,"+2*e.r+" H"+s):(n=s-3,e.path+="M"+n+","+(e.y+e.r)+" H"+s+" a"+e.r+","+e.r+",0,0,0,0,-"+2*e.r+" H"+n)}),e.blobs=[]}),e}(e,n),n.viewBox="1930,-10,120,27",function(e){for(var t=e.min_time,a=e.max_time,i=[],n=[{x:-2.5,y:0,content:"Elinkaari"},{x:-2.5,y:5,content:"Ura"},{x:-2.5,y:10,content:"Teokset"},{x:-2.5,y:15,content:"Kunniamaininnat"}],s=10*Math.ceil(t/10);s<a;s+=10){var o=r(s,t,a);i.push({x1:o,x2:o,y1:0,y2:15}),n.push({x:o+1,y:-2,content:""+s})}for(var l=0;l<20;l+=5)i.push({x1:r(t,t,a),x2:r(a,t,a),y1:l,y2:l});e.mainline={lines:i,texts:n}}(n),e}).catch(l);var s=1;function o(e,t,a,i,n){n||(n=15);return{latitude:e,longitude:t,id:s++,options:{icon:{path:"M-"+n+" 0 A "+n+","+n+", 0 ,1, 1,"+n+",0 A"+n+","+n+",0,1,1,-"+n+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:{death:"#ff4141",birth:"#777fff",spouse:"#c3b981",child:"#7f6780",career:"#999999",product:"#83d236",honour:"#ce5c00",event:"#999999"}[i],fillOpacity:.6,strokeOpacity:.5,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},zIndex:a,optimized:!1,label:{text:""+a,fontSize:"14px",fontFamily:'"Courier New", Courier,Monospace',color:"black"}}}}function r(e,t,a){return e-t}function l(e){n.isLoadingResults=!1,n.error=e}}angular.module("facetApp").controller("MapController",e),e.$inject=["$stateParams","$uibModal","_","mapService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.right=!1,c.map={center:{latitude:62,longitude:24},zoom:6},c.markers=[],c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.EVENTTYPES=[{type:"0",check:!0,color:"hsl(222, 90%, 60%)",label:"Syntymä",label2:"syntyneet",tooltip:"Henkilöiden syntymäpaikat kartalla"},{type:"1",check:!0,color:"hsl(0, 90%, 60%)",label:"Kuolema",label2:"kuolleet",tooltip:"Henkilöiden kuolinpaikat kartalla"},{type:"2",check:!1,color:"hsl(0, 0%, 45%)",label:"Ura",label2:"ura",tooltip:"Henkilöiden opiskelu- ja työpaikat"},{type:"3",check:!1,color:"hsl(120, 90%, 40%)",label:"Teokset",label2:"teokset",tooltip:"Paikat, joissa on henkilöihin liittyviä teoksia"},{type:"4",check:!1,color:"hsl(180, 90%, 40%)",label:"Kunniamaininnat",label2:"kunniamaininnat",tooltip:"Kunniamainintoihin liittyvät paikat"}],c.change=function(){c.EVENTTYPES.every(function(e){return!e.check})&&(c.EVENTTYPES[0].check=!0),t.search(c.right?"limit2":"limit",c.searchlimit.value);var e=c.EVENTTYPES.map(function(e){return e.check?1:0}).join(",");t.search(c.right?"events2":"events",e),m({constraint:c.previousSelections})},c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"events2":"events"]&&e[a].split(",").forEach(function(e,t){c.EVENTTYPES[t].check="0"!=e}),e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}},c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),r.updateUrlParams(t),m(t)}function m(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();t;var a=c.EVENTTYPES.map(function(e){return e.check});return s.getResults(e,a,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",c.events=function(e,t){t.markers=[],e.forEach(function(e,a){var i=function(e,t,a,i,n,s,o,r){var l=5*Math.sqrt(s),c=g(o,n,s);return{count:s,latitude:t,longitude:a,id:i,options:{icon:{path:"M-"+l+" 0 A "+l+","+l+", 0 ,1, 1,"+l+",0 A"+l+","+l+",0,1,1,-"+l+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:e.EVENTTYPES[parseInt(n)].color,fillOpacity:.6,strokeOpacity:.2,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},optimized:!0,title:c},onClick:function(){e.popuptitle=c,e.people=r,e.showForm()}}}(t,e.place.latitude,e.place.longitude,a,e.type,e.count,e.place.label,e.person.ids);t.markers.push(i)});var a=new google.maps.LatLngBounds,i=document.getElementById("ui-gmap-google-map");i&&i.fitBounds&&i.fitBounds(a);return e}(e,c))}).catch(f)}function f(e){c.isLoadingResults=!1,c.error=e}function g(e,t,a){return e+", "+c.EVENTTYPES[parseInt(t)].label2+" ("+a+")"}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=r.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("GroupmapController",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.right=!0,c.map={center:{latitude:62,longitude:24},zoom:6},c.markers=[],c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.EVENTTYPES=[{type:"0",check:!0,color:"hsl(222, 90%, 60%)",label:"Syntymä",label2:"syntyneet",tooltip:"Henkilöiden syntymäpaikat kartalla"},{type:"1",check:!0,color:"hsl(0, 90%, 60%)",label:"Kuolema",label2:"kuolleet",tooltip:"Henkilöiden kuolinpaikat kartalla"},{type:"2",check:!1,color:"hsl(0, 0%, 45%)",label:"Ura",label2:"ura",tooltip:"Henkilöiden opiskelu- ja työpaikat"},{type:"3",check:!1,color:"hsl(120, 90%, 40%)",label:"Teokset",label2:"teokset",tooltip:"Paikat, joissa on henkilöihin liittyviä teoksia"},{type:"4",check:!1,color:"hsl(180, 90%, 40%)",label:"Kunniamaininnat",label2:"kunniamaininnat",tooltip:"Kunniamainintoihin liittyvät paikat"}],c.change=function(){c.EVENTTYPES.every(function(e){return!e.check})&&(c.EVENTTYPES[0].check=!0),t.search(c.right?"limit2":"limit",c.searchlimit.value);var e=c.EVENTTYPES.map(function(e){return e.check?1:0}).join(",");t.search(c.right?"events2":"events",e),m({constraint:c.previousSelections})},c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"events2":"events"]&&e[a].split(",").forEach(function(e,t){c.EVENTTYPES[t].check="0"!=e}),e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}},c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),r.updateUrlParams(t),m(t)}function m(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();t;var a=c.EVENTTYPES.map(function(e){return e.check});return s.getResults(e,a,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",c.events=function(e,t){t.markers=[],e.forEach(function(e,a){var i=function(e,t,a,i,n,s,o,r){var l=5*Math.sqrt(s),c=g(o,n,s);return{count:s,latitude:t,longitude:a,id:i,options:{icon:{path:"M-"+l+" 0 A "+l+","+l+", 0 ,1, 1,"+l+",0 A"+l+","+l+",0,1,1,-"+l+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:e.EVENTTYPES[parseInt(n)].color,fillOpacity:.6,strokeOpacity:.2,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},optimized:!0,title:c},onClick:function(){e.popuptitle=c,e.people=r,e.showForm()}}}(t,e.place.latitude,e.place.longitude,a,e.type,e.count,e.place.label,e.person.ids);t.markers.push(i)});var a=new google.maps.LatLngBounds,i=document.getElementById("ui-gmap-google-map");i&&i.fitBounds&&i.fitBounds(a);return e}(e,c))}).catch(f)}function f(e){c.isLoadingResults=!1,c.error=e}function g(e,t,a){return e+", "+c.EVENTTYPES[parseInt(t)].label2+" ("+a+")"}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=r.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("GroupmapControllerRight",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService2","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.right=!1,c.map={center:{latitude:62,longitude:24},zoom:6},c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.change=function(){t.search(c.right?"limit2":"limit",c.searchlimit.value),m({constraint:c.previousSelections})},c.message="",c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass,c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})};var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),r.updateUrlParams(t),m(t)}function m(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();return t,c.polylines=[],s.getResults2(e,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",function(e,t){var a=1,i=0,n=e[0].count,s=e[e.length-1].count;s!=n&&(i=1-(a=8/(s-n))*n);e.forEach(function(e){e.weight=a*e.count+i});var o=[],r=[];e.forEach(function(e){v(e,o,r)}),t.polylines=o,t.markers=r}(e,c))}).catch(f)}function f(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=r.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)}),c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}};var g=0,h=function(e,t){var a=new google.maps.LatLng(e.latitude,e.longitude),i=new google.maps.LatLng(t.latitude,t.longitude);return google.maps.geometry.spherical.interpolate(a,i,.5)};function v(e,t,a){Math.random();if(e.birth.label!=e.death.label){t.push({id:g++,path:[e.birth,e.death],events:{click:function(t){c.popuptitle="Syntymäpaikka "+e.birth.label+", kuolinpaikka "+e.death.label+" ("+e.count+")",c.people=e.person.ids,c.showForm()},mouseover:function(e){e.setOptions({strokeColor:"blue",strokeOpacity:1})},mouseout:function(e){e.setOptions({strokeColor:"rgb(203,231,226)",strokeOpacity:.03})}},stroke:{color:"rgb(203,231,226)",weight:6,opacity:.03},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:4}}]});var i=h(e.birth,e.death);t.push({id:g++,path:[e.birth,i],stroke:{color:"blue",weight:e.weight}}),t.push({id:g++,path:[i,e.death],stroke:{color:"red",weight:e.weight},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:e.weight}}]})}else{var n=8*Math.sqrt(e.weight);a.push({count:e.weight,latitude:e.birth.latitude,longitude:e.birth.longitude,id:g++,options:{icon:{path:"M-"+n+" 0 A "+n+","+n+", 0 ,1, 1,"+n+",0 A"+n+","+n+",0,1,1,-"+n+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:"red",strokeColor:"blue",fillOpacity:.6},optimized:!0,title:e.birth.label+": "+e.count},click:function(){c.popuptitle="Synnyin- ja kuolinpaikka "+e.birth.label+": "+e.count,c.people=e.person.ids,c.showForm()}})}}}angular.module("facetApp").controller("LifemapController",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.right=!0,c.map={center:{latitude:62,longitude:24},zoom:6},c.window={show:!1,position:{lat:60.192059,lng:24.945831}};var p=function(e){t.search(c.right?"map2":"map",angular.toJson(c.map))};c.mapevents={zoom_changed:p,dragend:p},c.LIMITOPTIONS=[{value:200},{value:500},{value:1e3},{value:2500},{value:5e3}],c.searchlimit=c.LIMITOPTIONS[0],c.change=function(){t.search(c.right?"limit2":"limit",c.searchlimit.value),m({constraint:c.previousSelections})},c.message="",c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass,c.showForm=function(){i.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})};var d=e.$on("sf-initial-constraints",function(e,t){u(e,t),d()});function u(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),r.updateUrlParams(t),m(t)}function m(e){c.isLoadingResults=!0,c.error=void 0;var t=n.uniqueId();return t,c.polylines=[],s.getResults2(e,c.searchlimit.value).then(function(e){c.isLoadingResults=!1,e.length<1?c.message="Haku ei tuottanut tuloksia.":(c.message=e.length<c.searchlimit.value?"Haku tuotti "+e.length+" paikkatulosta.":"Kartalla näytetään "+e.length+" ensimmäistä paikkaa.",function(e,t){var a=1,i=0,n=e[0].count,s=e[e.length-1].count;s!=n&&(i=1-(a=8/(s-n))*n);e.forEach(function(e){e.weight=a*e.count+i});var o=[],r=[];e.forEach(function(e){v(e,o,r)}),t.polylines=o,t.markers=r}(e,c))}).catch(f)}function f(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",u),s.getFacets().then(function(t){c.facets=t,c.facetOptions=function(){c.readUrl();var e=s.getFacetOptions();return e.initialState=r.getFacetValuesFromUrlParams(),e}(),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)}),c.readUrl=function(){var e=t.search(),a=c.right?"limit2":"limit";if(e[a]){var i=parseInt(e[a]);c.LIMITOPTIONS.forEach(function(e,t){i==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}if(e[a=c.right?"map2":"map"])try{var n=angular.fromJson(e[a]);c.map=n}catch(e){t.search(a,null)}};var g=0,h=function(e,t){var a=new google.maps.LatLng(e.latitude,e.longitude),i=new google.maps.LatLng(t.latitude,t.longitude);return google.maps.geometry.spherical.interpolate(a,i,.5)};function v(e,t,a){Math.random();if(e.birth.label!=e.death.label){t.push({id:g++,path:[e.birth,e.death],events:{click:function(t){c.popuptitle="Syntymäpaikka "+e.birth.label+", kuolinpaikka "+e.death.label+" ("+e.count+")",c.people=e.person.ids,c.showForm()},mouseover:function(e){e.setOptions({strokeColor:"blue",strokeOpacity:1})},mouseout:function(e){e.setOptions({strokeColor:"rgb(203,231,226)",strokeOpacity:.03})}},stroke:{color:"rgb(203,231,226)",weight:6,opacity:.03},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:4}}]});var i=h(e.birth,e.death);t.push({id:g++,path:[e.birth,i],stroke:{color:"blue",weight:e.weight}}),t.push({id:g++,path:[i,e.death],stroke:{color:"red",weight:e.weight},icons:[{icon:{path:google.maps.SymbolPath.FORWARD_OPEN_ARROW,scale:e.weight}}]})}else{var n=8*Math.sqrt(e.weight);a.push({count:e.weight,latitude:e.birth.latitude,longitude:e.birth.longitude,id:g++,options:{icon:{path:"M-"+n+" 0 A "+n+","+n+", 0 ,1, 1,"+n+",0 A"+n+","+n+",0,1,1,-"+n+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:"red",strokeColor:"blue",fillOpacity:.6},optimized:!0,title:e.birth.label+": "+e.count},click:function(){c.popuptitle="Synnyin- ja kuolinpaikka "+e.birth.label+": "+e.count,c.people=e.person.ids,c.showForm()}})}}}angular.module("facetApp").controller("LifemapControllerRight",e),e.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService2","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r){var l,c,p=this;p.openPage=function(e){i.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return e}}})},p.nextPage=f,p.isScrollDisabled=function(){return p.isLoadingResults||l>c},p.removeFacetSelections=function(){a.reload()},p.sortBy=function(e){return s.updateSortBy(e),h({constraint:p.previousSelections})},p.getSortClass=s.getSortClass,p.people=[];var d,u,m=e.$on("sf-initial-constraints",function(e,t){g(e,t),m()});function f(){var e=n.uniqueId();d=e,p.isLoadingResults=!0,l++<=c?p.pager.getPage(l-1,24).then(function(t){e===d&&(p.people=p.people.concat(t),p.isLoadingResults=!1)}).catch(v):p.isLoadingResults=!1}function g(e,t){if(!p.previousSelections||!n.isEqual(t.constraint,p.previousSelections))return p.previousSelections=n.clone(t.constraint),r.updateUrlParams(t),h(t)}function h(e){p.isLoadingResults=!0,p.people=[],p.error=void 0;var t=n.uniqueId();u=t,l=0,s.getResults(e).then(function(e){return e.getMaxPageNo().then(function(t){return[e,t]})}).then(function(e){if(u===t)return p.pager=e[0],c=e[1],p.isLoadingResults=!1,f()}).catch(v)}function v(e){p.isLoadingResults=!1,p.error=e}e.$on("sf-facet-constraints",g),s.getFacets().then(function(t){var a;p.facets=t,p.facetOptions=((a=s.getFacetOptions()).initialState=r.getFacetValuesFromUrlParams(),a),p.facetOptions.scope=e,p.handler=new o(p.facetOptions)})}angular.module("facetApp").controller("CardsController",e),e.$inject=["$scope","$location","$state","$uibModal","_","nbfService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getResults=function(a){var i=this,n=l.replace(/<RESULT_SET>/g,a.constraint.join(" "));return k.getObjectsNoGrouping(n).then(function(a){if(a.length>1e4)return e.reject({statusText:"Tulosjoukko on liian suuri. Ole hyvä ja rajaa tuloksia suodittimien avulla"});var n={},s=c.replace(/<DOC>/g,"<"+t.map(a,"id").join("> <")+">");return i.upos.forEach(function(e){n[e.key]=w.getObjectsNoGrouping(s.replace(/<UPOS>/g,e.key))}),e.all(n)})},this.getWordCount=function(e){var t={},a=p.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=k.getObjectsNoGrouping(a),console.log(t),t},this.getResultsTop10=function(e){var t={},a=d.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=k.getObjectsNoGrouping(a),console.log("results",t),t},this.getResultsBottom10=function(e){var t=u.replace(/<RESULT_SET>/g,e.constraint.join(" "));return k.getObjectsNoGrouping(t)},this.getResultsBottomCat=function(e){var t={},a=f.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=k.getObjectsNoGrouping(a),console.log(t),t},this.getResultsTopCat=function(e){var t={},a=m.replace(/<RESULT_SET>/g,e.constraint.join(" "));return t=k.getObjectsNoGrouping(a),console.log(t),t},this.getStatistics=function(e){var t=h.replace(/<RESULT_SET>/g,e.constraint.join(" "));return k.getObjectsNoGrouping(t)},this.getLenStatistics=function(e){var t=g.replace(/<RESULT_SET>/g,e.constraint.join(" "));return k.getObjectsNoGrouping(t)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return angular.copy(b)},this.upos=[{key:"VERB",label:"Verbi"},{key:"NOUN",label:"Substantiivi"},{key:"ADJ",label:"Adjektiivi"},{key:"PROPN",label:"Erisnimi"}];var r=" PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX conll: <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#>  PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",l=" SELECT DISTINCT ?id WHERE {  {     <RESULT_SET>   }  }",c=r+' SELECT DISTINCT ?lemma (COUNT(?lemma) AS ?count) {   VALUES ?doc { <DOC> }   ?s nif:structure/<http://ldf.fi/nbf/biography/data#bioId> ?doc .   ?s a nif:Sentence .   ?word nif:sentence ?s .   ?word conll:UPOS "<UPOS>" .   ?word conll:LEMMA ?lemma .   FILTER(STRLEN(STR(?lemma))>1)   FILTER (regex(?lemma, ".*(?<![.])$")) .  } GROUP BY ?lemma ORDER BY DESC(?count) LIMIT 50',p=r+" SELECT  (SUM(xsd:integer(?cnt)) AS ?count) (SUM(xsd:integer(?verb)) AS ?verbCount) (SUM(xsd:integer(?adj)) AS ?adjCount) (SUM(xsd:integer(?noun)) AS ?nounCount) (SUM(xsd:integer(?pnoun)) AS ?pnounCount) {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .   ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt ;      <http://ldf.fi/nbf/biography/data#verbCount> ?verb ;      <http://ldf.fi/nbf/biography/data#adjCount> ?adj ;      <http://ldf.fi/nbf/biography/data#nounCount> ?noun ;      <http://ldf.fi/nbf/biography/data#propnCount> ?pnoun . } ",d=r+" SELECT DISTINCT ?id ?name ?cnt {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } ORDER BY DESC(xsd:integer(?cnt)) LIMIT 10",u=r+" SELECT DISTINCT ?id ?name ?cnt {   {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } ORDER BY ASC(xsd:integer(?cnt)) LIMIT 10",m=r+" SELECT DISTINCT ?category (ROUND(SUM(xsd:integer(?cnt)) / COUNT(xsd:integer(?cnt))) AS ?count) (COUNT(xsd:integer(?cnt)) as ?lkm) {  {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?id foaf:focus/nbf:has_category ?cat .  ?cat skos:prefLabel ?category .  ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } GROUP BY ?category ORDER BY DESC(?count) LIMIT 10",f=r+" SELECT DISTINCT ?category (ROUND(SUM(xsd:integer(?cnt)) / COUNT(xsd:integer(?cnt))) AS ?count) (COUNT(xsd:integer(?cnt)) as ?lkm){  {     <RESULT_SET>   }   ?id a <http://ldf.fi/nbf/PersonConcept> .  ?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?name .   ?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .   ?id foaf:focus/nbf:has_category ?cat .  ?cat skos:prefLabel ?category .  ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .  ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;      <http://ldf.fi/nbf/biography/data#wordCount> ?cnt . } GROUP BY ?category ORDER BY ASC(?count) LIMIT 10",g=r+" SELECT DISTINCT ?year (ROUND(SUM(xsd:integer(?cnt)) / COUNT(xsd:integer(?cnt))) AS ?count) {   {     <RESULT_SET>   }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   ?doc <http://ldf.fi/nbf/biography/data#docRef> ?id .   ?ds <http://ldf.fi/nbf/biography/data#document> ?doc ;       <http://ldf.fi/nbf/biography/data#wordCount> ?cnt .   BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ",h=r+" SELECT DISTINCT ?year (COUNT(distinct ?id) AS ?count) {   {     <RESULT_SET>   }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ",v={endpointUrl:n,usePost:!0},b={endpointUrl:v.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},w=new a({endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},o),k=new a(v,o)}angular.module("facetApp").service("nlpService",e),e.$inject=["$q","_","AdvancedSparqlService","FacetResultHandler","SPARQL_ENDPOINT_URL","mapfacetService","objectMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r){var l=this;l.hasResults=function(){return i.keys(l.results).length>0},l.upos=s.upos,l.removeFacetSelections=function(){a.reload()},s.getFacets().then(function(e){var a;l.facets=e,l.facetOptions=((a=s.getFacetOptions()).initialState=r.getFacetValuesFromUrlParams(),a),l.facetOptions.scope=t,l.handler=new o(l.facetOptions)});var c,p=t.$on("sf-initial-constraints",function(e,t){d(e,t),p()});function d(t,a){if(!l.previousSelections||!i.isEqual(a.constraint,l.previousSelections))return l.previousSelections=i.clone(a.constraint),r.updateUrlParams(a),function(t){l.isLoadingResults=!0,l.results=[],l.error=void 0;var a=i.uniqueId();return c=a,s.getStatistics(t).then(function(e){c===a&&function(e){n.charts.setOnLoadCallback(function(){var t=new n.visualization.DataTable,a=i.map(e,function(e){return parseInt(e.year)}),s=i.map(e,function(e){return[e.year,parseInt(e.count)]}),o={title:"SKS:n Biografiajakauma vuosikymmenittäin",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:a},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},r=new n.visualization.ColumnChart(document.getElementById("biography-chart"));t.addColumn("string","Vuosikymmen"),t.addColumn("number","Biografioita"),t.addRows(s),r.draw(t,o)})}(e)}).then(function(){return s.getLenStatistics(t).then(function(e){c===a&&(console.log(e),function(e){n.charts.setOnLoadCallback(function(){var t=new n.visualization.DataTable,a=i.map(e,function(e){return parseInt(e.year)}),s=i.map(e,function(e){return[e.year,parseInt(e.count)]}),o={title:"SKS:n Biografioiden keskimääräinen sanamääräjakauma vuosikymmenittäin",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:a},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},r=new n.visualization.ColumnChart(document.getElementById("biography-len-chart"));t.addColumn("string","Vuosikymmen"),t.addColumn("number","Biografioiden keskimääräinen sanamäärä"),t.addRows(s),r.draw(t,o)})}(e))})}).then(function(){return s.getResultsTop10(t).then(function(e){c===a&&(l.resultsTop10=e,l.isLoadingResults=!1)})}).then(function(){return s.getResultsBottom10(t).then(function(e){c===a&&(l.resultsBottom10=e,l.isLoadingResults=!1)})}).then(function(){return s.getResultsBottomCat(t).then(function(e){c===a&&(l.resultsBotCat=e,l.isLoadingResults=!1)})}).then(function(){return s.getResultsTopCat(t).then(function(e){c===a&&(l.resultsTopCat=e,l.isLoadingResults=!1)})}).then(function(){return s.getWordCount(t).then(function(e){c===a&&(l.lemmaCount=e[0],l.isLoadingResults=!1,console.log(e[0]))})}).then(function(){return s.getResults(t).then(function(e){c===a&&(l.results=function(e){var t,a,i;for(t in console.log(l.lemmaCount.count),e){console.log(t),console.log(e[t]);var n="VERB"==(i=t)?l.lemmaCount.verbCount:"ADJ"==i?l.lemmaCount.adjCount:"NOUN"==i?l.lemmaCount.nounCount:"PROPN"==i?l.lemmaCount.pnounCount:(console.log("Unidentifiable pos-tag",i),l.lemmaCount.count);for(a in e[t])console.log(e[t][a].count),e[t][a].percentage=(e[t][a].count/l.lemmaCount.count*100).toFixed(2),e[t][a].class_percentage=(e[t][a].count/n*100).toFixed(2)}return console.log(e),e}(e),l.isLoadingResults=!1)})}).catch(function(t){return function(t,a){a===c&&(l.isLoadingResults=!1,l.error=t,e.error(t))}(t,a)})}(a)}t.$on("sf-facet-constraints",d)}angular.module("facetApp").controller("NlpStatisticsController",e),e.$inject=["$log","$scope","$state","_","google","nlpService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function e(e,t,a,i,n,s){var o=this;o.hasResults=function(){return i.keys(o.results).length>0},o.removeFacetSelections=function(){a.reload()},o.upos=n.upos,n.getFacets().then(function(e){o.facets=e,o.facetOptions=n.getFacetOptions(),o.facetOptions.scope=t,o.handler=new s(o.facetOptions)});var r,l=t.$on("sf-initial-constraints",function(e,t){c(e,t),l()});function c(t,a){if(!o.previousSelections||!i.isEqual(a.constraint,o.previousSelections))return o.previousSelections=i.clone(a.constraint),function(t){o.isLoadingResults=!0,o.results=[],o.error=void 0;var a=i.uniqueId();return r=a,n.getWordCount(t).then(function(e){r===a&&(o.lemmaCount=e[0],o.isLoadingResults=!1,console.log(e[0]))}).then(function(){return n.getResults(t).then(function(e){r===a&&(o.results=function(e){var t,a;for(t in console.log(o.lemmaCount.count),e){console.log(t),console.log(e[t]);var i=p(t);for(a in e[t])console.log(e[t][a].count),e[t][a].percentage=(e[t][a].count/o.lemmaCount.count*100).toFixed(2),e[t][a].class_percentage=(e[t][a].count/i*100).toFixed(2)}return console.log(e),e}(e),o.isLoadingResults=!1)})}).catch(function(t){return function(t,a){a===r&&(o.isLoadingResults=!1,o.error=t,e.error(t))}(t,a)})}(a)}function p(e){return"VERB"==e?o.lemmaCount.verbCount:"ADJ"==e?o.lemmaCount.adjCount:"NOUN"==e?o.lemmaCount.nounCount:"PROPN"==e?o.lemmaCount.pnounCount:(console.log("Unidentifiable pos-tag",e),o.lemmaCount.count)}t.$on("sf-facet-constraints",c)}angular.module("facetApp").controller("NlpComparisonController",e),e.$inject=["$log","$scope","$state","_","nlpService","FacetHandler"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getYears=function(e){return h(e,l)},this.getAge=function(e){return h(e,c)},this.getMarriageAge=function(e){return h(e,p)},this.getFirstChildAge=function(e){return h(e,d)},this.getNumberOfChildren=function(e){return h(e,u)},this.getNumberOfSpouses=function(e){return h(e,m)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return f};var r="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX\tnbf:\t<http://ldf.fi/nbf/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX\tgvp:\t<http://vocab.getty.edu/ontology#>\t PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\trelations:\t<http://ldf.fi/nbf/relations/> PREFIX\tsources:\t<http://ldf.fi/nbf/sources/> ",l=r+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   { <RESULT_SET> }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .  BIND (FLOOR(YEAR(?birth)/10)*10 AS ?value)  BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY ?value ',c=r+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   { <RESULT_SET> }   ?id foaf:focus/^crm:P100_was_death_of/nbf:time [ gvp:estStart ?time ; gvp:estEnd ?time2 ] ;        foaf:focus/^crm:P98_brought_into_life/nbf:time [ gvp:estStart ?birth ; gvp:estEnd ?birth2 ] .   BIND (xsd:integer(0.5*(year(?time)+year(?time2)-year(?birth)-year(?birth2))) AS ?value)   FILTER (-1<?value && ?value<120)   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',p=r+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE {      {     SELECT DISTINCT ?id (min(?age) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Spouse }       ?id bioc:has_family_relation [ a ?rel ;  nbf:time/gvp:estStart ?time ] ;                                      foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .       BIND (year(?time)-year(?birth) AS ?age)       FILTER (13<?age && ?age<120)}    GROUP BY ?id }    FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',d=r+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE {      {     SELECT DISTINCT ?id (min(?age) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Child relations:Son relations:Daughter }       ?id bioc:has_family_relation [ a ?rel ;  nbf:time/gvp:estStart ?time ] ;                                      foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .       BIND (year(?time)-year(?birth) AS ?age)       FILTER (13<?age && ?age<120)}     GROUP BY ?id }    FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',u=r+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   {       SELECT DISTINCT ?id (count(?rel) AS ?value)       WHERE { { <RESULT_SET> }         VALUES ?rel { relations:Child relations:Son relations:Daughter }         ?id bioc:has_family_relation/a ?rel . }        GROUP BY ?id }   UNION {     \t{ <RESULT_SET> }       ?id dcterms:source sources:source1 ;           foaf:focus/nbf:has_biography/nbf:has_paragraph/nbf:id "2"^^xsd:integer .       FILTER not exists { ?id bioc:has_family_relation/a relations:Child } \t   BIND (0 AS ?value) }   FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',m=r+'SELECT DISTINCT ?value (COUNT(?id) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons) WHERE {   {     SELECT DISTINCT ?id (count(?rel) AS ?value) WHERE     {       { <RESULT_SET> }       VALUES ?rel { relations:Spouse }       ?id bioc:has_family_relation/a ?rel . }     GROUP BY ?id   }   UNION {     { <RESULT_SET> }     ?id dcterms:source sources:source1 ;         foaf:focus/nbf:has_biography/nbf:has_paragraph/nbf:id "2"^^xsd:integer .     FILTER not exists { ?id bioc:has_family_relation/a relations:Spouse }     BIND (0 AS ?value)   }   FILTER (BOUND(?id))   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ',f={endpointUrl:o,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},g=new i(o,n);function h(e,t){var a=e.constraint.join(" "),i=t.replace(/<RESULT_SET>/g,a);return g.getObjectsNoGrouping(i)}}angular.module("facetApp").service("visuColumnService",e),e.$inject=["$q","_","FacetResultHandler","AdvancedSparqlService","objectMapperService","mapfacetService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r){var l=this;l.people=[],l.data={},l.chart_ids=[0,1,2,3,4,5].map(function(e){return a.uniqueId()}),l.showForm=function(){r.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},l.removeFacetSelections=function(){t.reload()};var c=e.$on("sf-initial-constraints",function(e,t){p(e,t),c()});function p(e,t){l.previousSelections&&a.isEqual(t.constraint,l.previousSelections)||(l.previousSelections=a.clone(t.constraint),o.updateUrlParams(t),n.getYears(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){!function(e,t,a,n){var s=e.map(function(e){return[e.value,parseInt(e.count)]}),o=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0);l.data[n]=e.map(function(e){return e.persons});var r=new i.visualization.DataTable,c={title:a+", yhteensä "+o+" henkilöä",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:""},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},p=new i.visualization.ColumnChart(document.getElementById(n));r.addColumn("string","Vuosikymmen"),r.addColumn("number","Henkilöä"),r.addRows(s),p.draw(r,c),i.visualization.events.addListener(p,"select",function(){var e=p.getSelection(),t=e[0].row,a=parseInt(s[t][0]),i=a+9;l.people=l.data[n][t],l.popuptitle="Vuodet "+a+"–"+i+": "+s[t][1]+" henkilöä",l.showForm()})}(e,0,"Henkilöjakauma vuosikymmenittäin",l.chart_ids[0])})}),n.getAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Elinikä",l.chart_ids[1]," vuotta")})}),n.getMarriageAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Naimisiinmenoikä",l.chart_ids[2]," vuotta")})}),n.getFirstChildAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Lapsensaanti-ikä",l.chart_ids[3]," vuotta")})}),n.getNumberOfChildren(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,25],"Lasten lukumäärä",l.chart_ids[4],"")})}),n.getNumberOfSpouses(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,10],"Puolisoiden lukumäärä",l.chart_ids[5],"")})}))}function d(e,t,a,n,s){var o=5;e.forEach(function(e){var a=parseInt(e.value);o<a&&a<=t[1]&&(o=a)}),o<t[1]&&(t[1]=o);for(var r=t[1]-t[0]+1,c=new Array(r),p=new Array(r),d=0;d<r;d++)c[d]=[d,0],p[d]="";e.forEach(function(e){var a=parseInt(e.value);t[0]<=a&&a<=t[1]&&(c[a]=[a,parseInt(e.count)],p[a]=e.persons)}),l.data[n]=p;var u=function(e){var t=0,a=0,i=0;if($.each(e,function(e,n){var s=n[0]*n[1];t+=s,a+=n[0]*s,i+=n[1]}),i>0){var n=t/i;return[i,n,Math.sqrt(a/i-n*n)]}return[0,0,0]}(c),m=a+(0==u[0]?": ei tuloksia":", otos: "+u[0]+", keskiarvo: "+u[1].toFixed(2)+", keskihajonta: "+u[2].toFixed(2)),f=new i.visualization.DataTable,g={title:m,legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:function(e){var t=[],a=10*Math.floor(1+e[0]/10);for(;a<e[1];)t.push(a),a+=10;return t}(t)},vAxis:{maxValue:4,viewWindow:{min:1}},width:"95%",bar:{groupWidth:"88%"},height:500},h=new i.visualization.ColumnChart(document.getElementById(n));f.addColumn("number","Ikä"),f.addColumn("number","Henkilöä"),f.addRows(c),h.draw(f,g),i.visualization.events.addListener(h,"select",function(){var e=h.getSelection()[0].row;l.people=l.data[n][e],l.popuptitle=a+" "+e+s+": "+c[e][1]+(1==c[e][1]?" henkilö":" henkilöä"),l.showForm()})}e.$on("sf-facet-constraints",p),n.getFacets().then(function(t){var a;l.facets=t,l.facetOptions=((a=n.getFacetOptions()).initialState=o.getFacetValuesFromUrlParams(),a),l.facetOptions.scope=e,l.handler=new s(l.facetOptions)})}angular.module("facetApp").controller("VisuColumnController",e),e.$inject=["$scope","$state","_","google","visuColumnService","FacetHandler","facetUrlStateHandlerService","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r){var l=this;l.people=[],l.data={},l.chart_ids=[0,1,2,3,4,5].map(function(e){return""+e+Math.random()}),l.showForm=function(){r.open({templateUrl:"views/popup.html",scope:e}).result.then(function(){},function(e){})},l.rightSize=function(){},l.removeFacetSelections=function(){t.reload()};var c=e.$on("sf-initial-constraints",function(e,t){p(e,t),c()});function p(e,t){l.previousSelections&&a.isEqual(t.constraint,l.previousSelections)||(l.previousSelections=a.clone(t.constraint),o.updateUrlParams(t),n.getYears(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){!function(e,t,a,n){var s=e.map(function(e){return[e.value,parseInt(e.count)]}),o=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0);l.data[n]=e.map(function(e){return e.persons});var r=new i.visualization.DataTable,c={title:a+", yhteensä "+o+" henkilöä",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:""},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},p=new i.visualization.ColumnChart(document.getElementById(n));r.addColumn("string","Vuosikymmen"),r.addColumn("number","Henkilöä"),r.addRows(s),p.draw(r,c),i.visualization.events.addListener(p,"select",function(){var e=p.getSelection(),t=e[0].row,a=parseInt(s[t][0]),i=a+9;l.people=l.data[n][t],l.popuptitle="Vuodet "+a+"–"+i+": "+s[t][1]+" henkilöä",l.showForm()})}(e,0,"Henkilöjakauma vuosikymmenittäin",l.chart_ids[0])})}),n.getAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Elinikä",l.chart_ids[1]," vuotta")})}),n.getMarriageAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Naimisiinmenoikä",l.chart_ids[2]," vuotta")})}),n.getFirstChildAge(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,120],"Lapsensaanti-ikä",l.chart_ids[3]," vuotta")})}),n.getNumberOfChildren(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,25],"Lasten lukumäärä",l.chart_ids[4],"")})}),n.getNumberOfSpouses(t).then(function(e){e.length&&i.charts.setOnLoadCallback(function(){d(e,[0,10],"Puolisoiden lukumäärä",l.chart_ids[5],"")})}))}function d(e,t,a,n,s){var o=5;e.forEach(function(e){var a=parseInt(e.value);o<a&&a<=t[1]&&(o=a)}),o<t[1]&&(t[1]=o);for(var r=t[1]-t[0]+1,c=new Array(r),p=new Array(r),d=0;d<r;d++)c[d]=[d,0],p[d]="";e.forEach(function(e){var a=parseInt(e.value);t[0]<=a&&a<=t[1]&&(c[a]=[a,parseInt(e.count)],p[a]=e.persons)}),l.data[n]=p;var u=function(e){var t=0,a=0,i=0;if($.each(e,function(e,n){var s=n[0]*n[1];t+=s,a+=n[0]*s,i+=n[1]}),i>0){var n=t/i;return[i,n,Math.sqrt(a/i-n*n)]}return[0,0,0]}(c),m=a+(0==u[0]?": ei tuloksia":", otos: "+u[0]+", keskiarvo: "+u[1].toFixed(2)+", keskihajonta: "+u[2].toFixed(2)),f=new i.visualization.DataTable,g={title:m,legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:function(e){var t=[],a=10*Math.floor(1+e[0]/10);for(;a<e[1];)t.push(a),a+=10;return t}(t)},vAxis:{maxValue:4,viewWindow:{min:1}},width:"95%",bar:{groupWidth:"88%"},height:500},h=new i.visualization.ColumnChart(document.getElementById(n));f.addColumn("number","Ikä"),f.addColumn("number","Henkilöä"),f.addRows(c),h.draw(f,g),i.visualization.events.addListener(h,"select",function(){var e=h.getSelection()[0].row;l.people=l.data[n][e],l.popuptitle=a+" "+e+s+": "+c[e][1]+(1==c[e][1]?" henkilö":" henkilöä"),l.showForm()})}e.$on("sf-facet-constraints",p),n.getFacets().then(function(t){var a;l.facets=t,l.facetOptions=((a=n.getFacetOptions()).initialState=o.getFacetValuesFromUrlParams(),a),l.facetOptions.scope=e,l.handler=new s(l.facetOptions)})}angular.module("facetApp").controller("VisuColumnControllerRight",e),e.$inject=["$scope","$state","_","google","visuColumnService","FacetHandler","facetUrlStateHandlerService2","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getGenders=function(e){return g(e,l)},this.getCategories=function(e){return g(e,c)},this.getTitles=function(e){return g(e,p)},this.getDatabases=function(e){return g(e,d)},this.getCompanies=function(e){return g(e,u)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return m};var r="PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\tnbf: <http://ldf.fi/nbf/>  PREFIX owl: <http://www.w3.org/2002/07/owl#> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX\trelations: <http://ldf.fi/nbf/relations/> PREFIX schema: <http://schema.org/>  PREFIX\tsources: <http://ldf.fi/nbf/sources/> PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",l=r+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)   WHERE {  <RESULT_SET>   ?id foaf:focus ?prs .   { ?prs nbf:sukupuoli ?value }   UNION   { BIND ("ei tiedossa" AS ?value) .     FILTER NOT EXISTS { ?prs nbf:sukupuoli [] }   }   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url)  } GROUP BY ?value ORDER BY DESC(?count) ',c=r+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE { { <RESULT_SET> }   ?id foaf:focus/nbf:has_category/skos:prefLabel ?value   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY DESC(?count)',p=r+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE { { <RESULT_SET> }   ?id foaf:focus/^bioc:inheres_in/nbf:has_title/skos:prefLabel ?value   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY DESC(?count)',d=r+'SELECT DISTINCT ?value (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE { { <RESULT_SET> }   ?id owl:sameAs*|^(owl:sameAs)* ?id2 .   ?id2 dcterms:source ?source .   FILTER (?source!=<http://ldf.fi/nbf/sources/source7>)   ?source skos:prefLabel ?value .   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?value ORDER BY DESC(?count)',u=r+'SELECT DISTINCT (SAMPLE(?label) AS ?value) (COUNT(DISTINCT ?url) AS ?count) (GROUP_CONCAT(?url; separator=",") AS ?persons)  WHERE {    { <RESULT_SET> }   ?id foaf:focus/^bioc:inheres_in/nbf:related_company ?cmp .   ?cmp skos:prefLabel ?label .   BIND (replace(str(?id),"^.+/([^/]+)$","$1") AS ?url) } GROUP BY ?cmp ORDER BY DESC(?count)',m={endpointUrl:o,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},f=new i(o,n);function g(e,t){var a=e.constraint.join(" "),i=t.replace(/<RESULT_SET>/g,a);return f.getObjectsNoGrouping(i)}}angular.module("facetApp").service("visuPieService",e),e.$inject=["$q","_","FacetResultHandler","AdvancedSparqlService","objectMapperService","mapfacetService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.people=[],c.data={},c.chart_ids=[0,1,2,3,4].map(function(e){return i.uniqueId()}),c.showForm=function(){l.open({templateUrl:"views/popup.html",scope:t}).result.then(function(){},function(e){})},c.removeFacetSelections=function(){a.reload()};var p=t.$on("sf-initial-constraints",function(e,t){d(e,t),p()});function d(e,t){c.previousSelections&&i.isEqual(t.constraint,c.previousSelections)||(c.previousSelections=i.clone(t.constraint),r.updateUrlParams(t),s.getGenders(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Sukupuoli tai ryhmä",c.chart_ids[0])})}),s.getCategories(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Toimiala",c.chart_ids[2])})}),s.getTitles(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Arvo, ammatti tai toiminta",c.chart_ids[3])})}),s.getDatabases(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Tietokanta",c.chart_ids[1])})}),s.getCompanies(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Yritys tai yhteisö",c.chart_ids[4])})}))}function u(e,t,a){var i=e.map(function(e){return[e.value,parseInt(e.count)]}),s=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0),o=n.visualization.arrayToDataTable([["Luokka","Arvo"]].concat(i));c.data[a]=e.map(function(e){return e.persons});var r={title:t+(0==s?": ei tuloksia":": "+e.length+(e.length>1?" luokkaa, ":" luokka, ")+"yhteensä "+s+" henkilöä")},l=new n.visualization.PieChart(document.getElementById(a));l.draw(o,r),n.visualization.events.addListener(l,"select",function(){var e;try{e=l.getSelection()[0].row}catch(e){return void console.log("Unhandled click")}c.people=c.data[a][e],c.popuptitle=i[e][0]+": "+i[e][1]+" tulosta",c.showForm()})}t.$on("sf-facet-constraints",d),s.getFacets().then(function(e){var a;c.facets=e,c.facetOptions=((a=s.getFacetOptions()).initialState=r.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=t,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("VisuPieController",e),e.$inject=["$log","$scope","$state","_","google","visuPieService","FacetHandler","facetUrlStateHandlerService","$uibModal"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.people=[],c.data={},c.chart_ids=[0,1,2,3,4].map(function(e){return""+e+Math.random()}),c.showForm=function(){l.open({templateUrl:"views/popup.html",scope:t}).result.then(function(){},function(e){})},c.removeFacetSelections=function(){a.reload()};var p=t.$on("sf-initial-constraints",function(e,t){d(e,t),p()});function d(e,t){c.previousSelections&&i.isEqual(t.constraint,c.previousSelections)||(c.previousSelections=i.clone(t.constraint),r.updateUrlParams(t),s.getGenders(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Sukupuoli tai ryhmä",c.chart_ids[0])})}),s.getCategories(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Toimiala",c.chart_ids[2])})}),s.getTitles(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Arvo, ammatti tai toiminta",c.chart_ids[3])})}),s.getDatabases(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Tietokanta",c.chart_ids[1])})}),s.getCompanies(t).then(function(e){e.length&&n.charts.setOnLoadCallback(function(){u(e,"Yritys tai yhteisö",c.chart_ids[4])})}))}function u(e,t,a){var i=e.map(function(e){return[e.value,parseInt(e.count)]}),s=e.map(function(e){return parseInt(e.count)}).reduce((e,t)=>e+t,0),o=n.visualization.arrayToDataTable([["Luokka","Arvo"]].concat(i));c.data[a]=e.map(function(e){return e.persons});var r={title:t+(0==s?": ei tuloksia":": "+e.length+(e.length>1?" luokkaa, ":" luokka, ")+"yhteensä "+s+" henkilöä")},l=new n.visualization.PieChart(document.getElementById(a));l.draw(o,r),n.visualization.events.addListener(l,"select",function(){var e;try{e=l.getSelection()[0].row}catch(e){return void console.log("Unhandled click")}c.people=c.data[a][e],c.popuptitle=i[e][0]+": "+i[e][1]+" tulosta",c.showForm()})}t.$on("sf-facet-constraints",d),s.getFacets().then(function(e){var a;c.facets=e,c.facetOptions=((a=s.getFacetOptions()).initialState=r.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=t,c.handler=new o(c.facetOptions)})}angular.module("facetApp").controller("VisuPieControllerRight",e),e.$inject=["$log","$scope","$state","_","google","visuPieService","FacetHandler","facetUrlStateHandlerService2","$uibModal"]}(),function(){"use strict";function e(e,t,a){n.prototype.postProcess=function(e){return e};var i=Object.getPrototypeOf(a);return n.prototype=angular.extend({},i,PersonMapper.prototype),new n;function n(){this.objectClass=Object}}angular.module("facetApp").factory("eventMapperService",e),e.$inject=["$sce","_","objectMapperService"]}(),function(){"use strict";function e(e,t,a,i){var n=this;function s(e){n.isLoadingResults=!1,n.error=e}n.openPage=function(){t.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return n.place}}})},i.getPlace(e.placeId).then(function(e){return console.log(e),function(e,t){var a=[],i=[],n=[];e.forEach(function(e){var t=e.prs;switch(t.event){case"http://ldf.fi/nbf/Birth":a.push(t);break;case"http://ldf.fi/nbf/Death":i.push(t);break;default:t.label=t.label+": "+t.eventLabel,n.push(t)}}),t.place={id:e[0].id,label:e[0].label},t.place.born=a,t.place.died=i,t.place.event=n}(e,n),console.log(n.place),n.place}).catch(s)}angular.module("facetApp").controller("PlaceController",e),e.$inject=["$stateParams","$uibModal","_","placeService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getPlace=function(e){var t="VALUES ?id { <"+e+"> } . ",a=r.replace("<RESULT_SET>",t);return l.getObjectsNoGrouping(a)},this.getResults=function(t){var a=[this.getPlace(t)];return e.all(a)};var r='PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX\tnbf:\t<http://ldf.fi/nbf/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX\tgvp:\t<http://vocab.getty.edu/ontology#>\t PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\trelations:\t<http://ldf.fi/nbf/relations/> PREFIX\tsources:\t<http://ldf.fi/nbf/sources/>  SELECT distinct ?id ?label ?prs__event ?prs__eventLabel ?prs__id ?prs__label  WHERE {    { <RESULT_SET> }    ?id a nbf:Place ;        skos:prefLabel ?label . FILTER (lang(?label)="fi")    { OPTIONAL { ?prs__id foaf:focus/^crm:P98_brought_into_life [ nbf:place ?id ; a ?prs__event ] }    } UNION {    OPTIONAL { ?prs__id foaf:focus/^crm:P100_was_death_of [ nbf:place ?id ; a ?prs__event ] }    } UNION {     OPTIONAL { ?prs__id foaf:focus/^bioc:inheres_in  [ nbf:place ?id ; a ?prs__event ; skos:prefLabel ?prs__eventLabel ] }    }    ?prs__id skosxl:prefLabel ?prs__lab .      OPTIONAL { ?prs__lab schema:familyName ?prs__fname }      OPTIONAL { ?prs__lab schema:givenName ?prs__gname }      BIND (CONCAT(COALESCE(?prs__gname, "")," ",COALESCE(?prs__fname, "")) AS ?prs__label )  } ',l=new i(o,s)}angular.module("facetApp").service("placeService",e),e.$inject=["$q","$location","_","AdvancedSparqlService","FacetResultHandler","objectMapperService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i){var n=this;function s(e){n.isLoadingResults=!1,n.error=e}n.openPage=function(){t.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return n.title}}})},i.getTitle(e.titleId).then(function(e){return n.title=e[0],n.title}).catch(s)}angular.module("facetApp").controller("TitleController",e),e.$inject=["$stateParams","$uibModal","_","titleService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getTitle=function(e){var t="VALUES ?id { <"+e+"> } . ",a=r.replace("<RESULT_SET>",t);return console.log(a),l.getObjectsNoGrouping(a)},this.getResults=function(t){var a=[this.getPlace(t)];return e.all(a)};var r="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX\tnbf:\t<http://ldf.fi/nbf/>  PREFIX\tcategories:\t<http://ldf.fi/nbf/categories/>  PREFIX\tgvp:\t<http://vocab.getty.edu/ontology#>\t PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX\trelations:\t<http://ldf.fi/nbf/relations/> PREFIX\tsources:\t<http://ldf.fi/nbf/sources/>  SELECT distinct ?id ?label   WHERE {  \t { <RESULT_SET> }    ?id a nbf:Title ;    skos:prefLabel ?label .}",l=new i(o,s)}angular.module("facetApp").service("titleService",e),e.$inject=["$q","$location","_","AdvancedSparqlService","FacetResultHandler","objectMapperService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function e(e,t,a,i,n,s,o,r,l){var c=this;c.cy=null,c.elems={},c.message="",c.dict={},c.loading=!1,c.showlegend=!1,c.showWindow=function(){c.window.show=!0},c.closeWindow=function(){c.window.show=!1},c.COLORS=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC","#999"],c.LIMITOPTIONS=[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:1e6,label:"ei rajaa"}],c.searchlimit=c.LIMITOPTIONS[3],c.changelimit=function(){t.search("limit",c.searchlimit.value),f({constraint:c.previousSelections})},c.SIZEOPTIONS=[{value:"Vakio",tooltip:!1},{value:"Asteluku",tooltip:"Asteluku (degree) tarkoittaa henkilöstä lähtevien ja saapuvien linkkien kokonaismäärää."},{value:"Tuloaste",tooltip:"Tuloaste (indegree) tarkoittaa henkilöön saapuvien linkkien lukumäärää."},{value:"Lähtöaste",tooltip:"Lähtöaste (outdegree) tarkoittaa henkilöstä lähtevien linkkien lukumäärää."},{value:"Pagerank",tooltip:"Pagerank-algoritmi mittaa henkilön keskeisyyttä verkostossa."}],c.sizeoption=c.SIZEOPTIONS[1],c.changesize=function(){var e=c.SIZEOPTIONS.indexOf(c.sizeoption);e>-1&&t.search("sizeoption",e);var a="20 px";switch(c.sizeoption){case c.SIZEOPTIONS[1]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.degree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[2]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.indegree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[3]:c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.degree=t.outdegree()}),v(c.elems,"degree","size",10,50),a="data(size)";break;case c.SIZEOPTIONS[4]:var i=c.cy.elements().pageRank();c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id),a=i.rank(t);e.data.pagerank=a}),v(c.elems,"pagerank","size",10,50),a="data(size)"}c.cy.style().selector("node").style("height",a).style("width",a).update()},c.COLOROPTIONS=[{value:"Vakio",tooltip:!1},{value:"Sukupuoli",tooltip:"Henkilöt väritetään sukupuolen mukaan."},{value:"Toimiala",tooltip:"Henkilöt väritetään tietokannassa ilmoitetun toimialan mukaan."}],c.coloroption=c.COLOROPTIONS[0],c.changecolor=function(){var e,a=c.COLOROPTIONS.indexOf(c.coloroption);switch(a>-1&&t.search("coloroption",a),c.showlegend=!1,c.coloroption){case c.COLOROPTIONS[1]:h(c.elems,"gender","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[2]:h(c.elems,"category","color"),e="data(color)",c.showlegend=!0;break;case c.COLOROPTIONS[3]:var i=c.cy.elements().dijkstra({root:c.cy.getElementById(c.id)});c.elems.nodes.forEach(function(e){var t=c.cy.getElementById(e.data.id);e.data.dijkstra=i.distanceTo(t)}),h(c.elems,"dijkstra","color"),e="data(color)";break;default:e=c.COLORS[0]}c.cy.style().selector("node").style("background-color",e).update()};var p=t.search();if(p.limit){var d=parseInt(p.limit);c.LIMITOPTIONS.forEach(function(e,t){d==e.value&&(c.searchlimit=c.LIMITOPTIONS[t])})}p.coloroption&&(c.coloroption=c.COLOROPTIONS[parseInt(p.coloroption)]),p.sizeoption&&(c.sizeoption=c.SIZEOPTIONS[parseInt(p.sizeoption)]),c.isScrollDisabled=function(){return c.isLoadingResults||nextPageNo>maxPage},c.removeFacetSelections=function(){a.reload()},c.getSortClass=s.getSortClass;var u=e.$on("sf-initial-constraints",function(e,t){m(e,t),u()});function m(e,t){if(!c.previousSelections||!n.isEqual(t.constraint,c.previousSelections))return c.previousSelections=n.clone(t.constraint),r.updateUrlParams(t),f(t)}function f(a){c.error=void 0,c.cy&&c.cy.elements().remove(),c.cy=null,c.message="",c.loading=!0;var i=n.uniqueId();return i,s.getGroupLinks(a,c.searchlimit.value).then(function(a){if(a.length<1)return c.loading=!1,c.message="Asetuksilla ei löydy näytettävää verkostoa.",void(c.messagecolor="red");c.elems.edges=a.map(function(e){return{data:e}});var i={},n="";a.forEach(function(e){i[e.source.replace("http://ldf.fi/nbf/","nbf:")]=!0,i[e.target.replace("http://ldf.fi/nbf/","nbf:")]=!0});for(let e in i)n+=e+" ";return s.getNodesForPeople(n).then(function(a){c.elems.nodes=a.map(function(e){return{data:e}}),function(a){var i=[{selector:"node",style:{shape:"ellipse",height:"20",width:"20","text-valign":"center","text-halign":"right",content:"data(label)","background-color":a.COLORS[0],color:"#888"}},{selector:":active",style:{"background-color":"#800",color:"#000"}},{selector:"edge",style:{width:1,"line-color":"#999","curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"#999"}}];a.cy=cytoscape({container:document.getElementById("networkcontainer"),elements:a.elems,wheelSensitivity:.2,layout:{name:"circle"},style:i}),a.cy.on("click","node",function(a){document.body.style.cursor="auto";var i="/"+this.id().replace(new RegExp("/","g"),"~2F")+"/verkosto";t.url(i),e.$apply()}),a.cy.on("mouseover","node",function(e){document.body.style.cursor="pointer"}),a.cy.on("mouseout","node",function(e){document.body.style.cursor="auto"}),a.changecolor(),a.changesize(),a.cy.layout({name:"cose",idealEdgeLength:100,nodeOverlap:20,refresh:20,fit:!0,padding:30,randomize:!1,componentSpacing:100,nodeRepulsion:4e5,edgeElasticity:100,nestingFactor:5,gravity:80,numIter:800,initialTemp:200,coolingFactor:.95,minTemp:1}).run(),a.cy.panzoom&&a.cy.panzoom({})}(c),c.loading=!1,c.elems.edges.length==c.searchlimit.value?c.message="Näytetään {} ensimmäistä linkkiä ja {2} henkilöä".replace("{}",c.searchlimit.value).replace("{2}",c.elems.nodes.length):c.message="Näytetään {} linkkiä ja {2} henkilöä".replace("{}",c.elems.edges.length).replace("{2}",c.elems.nodes.length)}).catch(g)}).catch(g)}function g(e){c.isLoadingResults=!1,c.error=e}e.$on("sf-facet-constraints",m),s.getFacets().then(function(t){var a;c.facets=t,c.facetOptions=((a=s.getFacetOptions()).initialState=r.getFacetValuesFromUrlParams(),a),c.facetOptions.scope=e,c.handler=new o(c.facetOptions)});var h=function(e,t,a){var i={};e.nodes.forEach(function(e){var a=""+e.data[t];i.hasOwnProperty(a)||(i[a]=0),i[a]++});var n=[];for(var s in i)n.push({count:i[s],label:s});n.sort(function(e,t){return t.count-e.count}),i={},n.forEach(function(e,t){i[e.label]=t<c.COLORS.length?c.COLORS[t]:c.COLORS[c.COLORS.length-1]}),c.legend=n.map(function(e,t){return{label:""+e.label=="undefined"?"ei tiedossa":e.label,color:c.COLORS[t]}});var o=c.COLORS.length;c.legend.length>o&&(c.legend=c.legend.slice(0,o),c.legend[o-1].label="muut"),e.nodes.forEach(function(e){var n=e.data[t];e.data[a]=i[n]})},v=function(e,t,a,i,n){if(!(e.nodes.length<1)){var s=e.nodes[0].data[t],o=s;e.nodes.forEach(function(e){var a=e.data[t];a<s&&(s=a),o<a&&(o=a)}),s==o&&(o+=1);var r=(n-i)/(o-s),l=i-s/(o-s)*(n-i);e.nodes.forEach(function(e){var i=e.data[t];e.data[a]=i*r+l})}}}angular.module("facetApp").controller("NetworkController",e),e.$inject=["$scope","$location","$state","$uibModal","_","networkService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){this.getLinks=function(e){var t=l+c.replace(/<RESULT_SET>/g,e);return f.getObjectsNoGrouping(t)},this.getNodes=function(e,t){var a="<{}>".replace("{}",e),i=l+d.replace(/<RESULT_SET>/g,a).replace("<LIMIT>",""+t);return f.getObjectsNoGrouping(i)},this.getGroupNodes=function(e,t){var a=e.constraint.join(" "),i=a.replace("?id ","?id2 "),n=l+m.replace(/<RESULT_SET>/g,a).replace(/<RESULT_SET2>/g,i).replace("<LIMIT>",t);return f.getObjectsNoGrouping(n)},this.getGroupLinks=function(e,t){var a=e.constraint.join(" "),i=a.replace("?id ","?id2 "),n=l+p.replace(/<RESULT_SET>/g,a).replace(/<RESULT_SET2>/g,i).replace("<LIMIT>",t);return f.getObjectsNoGrouping(n)},this.getNodesForPeople=function(e){var t=l+u.replace(/<RESULT_SET>/g,e);return f.getObjectsNoGrouping(t)},this.getFacets=s.getFacets,this.getFacetOptions=function(){return r};var r={endpointUrl:{endpointUrl:i,usePost:!0}.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},l="PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX nbf: <http://ldf.fi/nbf/> PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#> PREFIX skos: <http://www.w3.org/2004/02/skos/core#> PREFIX schema: <http://schema.org/> PREFIX foaf: <http://xmlns.com/foaf/0.1/> ",c="SELECT distinct * WHERE {  VALUES ?source { <RESULT_SET> }  VALUES ?target { <RESULT_SET> }  ?source nbf:references ?target . FILTER (?source!=?target) . } ",p="SELECT distinct (?id AS ?source) (?id2 AS ?target) WHERE {   { <RESULT_SET> }  { <RESULT_SET2> }   ?id nbf:references ?id2 . } LIMIT <LIMIT> ",d='SELECT distinct ?id ?label ?gender (sample(?cats) AS ?category)  WHERE {      VALUES ?source { <RESULT_SET> }   GRAPH nbf:links {     {  VALUES ?id { <RESULT_SET> }        BIND (0 AS ?level) }     UNION     { ?source nbf:references ?id . BIND (1 AS ?level) }     UNION     { ?id nbf:references ?source . BIND (1 AS ?level) }     UNION     { ?source nbf:references/nbf:references ?id . BIND (2 AS ?level)}   }   ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }    OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label)    ?id foaf:focus ?prs .    OPTIONAL { ?prs nbf:sukupuoli ?gender }    OPTIONAL { ?prs nbf:has_category/skos:prefLabel ?cats } } GROUP BY ?level ?id ?label ?gender ORDER BY ?level LIMIT <LIMIT> ',u='SELECT distinct ?id ?label ?gender (sample(?cats) AS ?category)  WHERE {   VALUES ?id { <RESULT_SET> }   ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }    OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label)    ?id foaf:focus ?prs .    OPTIONAL { ?prs nbf:sukupuoli ?gender }    OPTIONAL { ?prs nbf:has_category/skos:prefLabel ?cats } }  GROUP BY ?id ?label ?gender ',m='SELECT distinct ?id ?label ?gender (sample(?cats) AS ?category)  WHERE {   { <RESULT_SET> }   { <RESULT_SET2> }   FILTER EXISTS { ?id nbf:references ?id2 }    ?id skosxl:prefLabel ?id__label .   OPTIONAL { ?id__label schema:familyName ?id__fname }   OPTIONAL { ?id__label schema:givenName ?id__gname }    BIND (CONCAT(COALESCE(?id__gname,"")," ",COALESCE(?id__fname,"")) AS ?label)    ?id foaf:focus ?prs .    OPTIONAL { ?prs nbf:sukupuoli ?gender }    OPTIONAL { ?prs nbf:has_category/skos:prefLabel ?cats } } GROUP BY ?id ?label ?gender LIMIT <LIMIT> ',f=new n({endpointUrl:i,usePost:!0})}angular.module("facetApp").service("networkService",e),e.$inject=["$q","$location","_","SPARQL_ENDPOINT_URL","AdvancedSparqlService","mapfacetService","personMapperService"]}(),function(){"use strict";function e(e,t,a,i,n,s,o){var r=this;r.cy=null,r.elems={},r.message="",r.dict={},r.loading=!1,r.showlegend=!1,r.popover=!1,r.popx="200px",r.popy="200py",r.COLORS=["#3366CC","#DC3912","#FF9900","#109618","#990099","#3B3EAC","#0099C6","#DD4477","#66AA00","#B82E2E","#316395","#994499","#22AA99","#AAAA11","#6633CC","#E67300","#8B0707","#329262","#5574A6","#3B3EAC","#999"],r.LIMITOPTIONS=[{value:10,label:"10"},{value:20,label:"20"},{value:50,label:"50"},{value:100,label:"100"},{value:200,label:"200"},{value:500,label:"500"},{value:1e3,label:"1000"},{value:1e6,label:"ei rajaa"}],r.searchlimit=r.LIMITOPTIONS[1],r.changelimit=function(){t.search("limit",r.searchlimit.value),d(r.previousSelections)},r.SIZEOPTIONS=[{value:"Vakio",tooltip:!1},{value:"Etäisyys",tooltip:"Solmujen koko määräytyy keskushenkilöön johtavan linkkipolun etäisyyden perusteella."},{value:"Asteluku",tooltip:"Asteluku (degree) tarkoittaa henkilöstä lähtevien ja saapuvien linkkien kokonaismäärää."},{value:"Tuloaste",tooltip:"Tuloaste (indegree) tarkoittaa henkilöön saapuvien linkkien lukumäärää."},{value:"Lähtöaste",tooltip:"Lähtöaste (outdegree) tarkoittaa henkilöstä lähtevien linkkien lukumäärää."},{value:"Pagerank",tooltip:"Pagerank-algoritmi mittaa henkilön keskeisyyttä verkostossa."}],r.sizeoption=r.SIZEOPTIONS[1],r.changesize=function(){var e=r.SIZEOPTIONS.indexOf(r.sizeoption);e>-1&&t.search("sizeoption",e);var a="20 px";switch(r.sizeoption){case r.SIZEOPTIONS[1]:var i=r.cy.elements().dijkstra({root:r.cy.getElementById(r.id)});r.elems.nodes.forEach(function(e){var t=r.cy.getElementById(e.data.id);e.data.dijkstra=-i.distanceTo(t)}),f(r.elems,"dijkstra","size",10,50),a="data(size)";break;case r.SIZEOPTIONS[2]:r.elems.nodes.forEach(function(e){var t=r.cy.getElementById(e.data.id);e.data.degree=t.degree()}),f(r.elems,"degree","size",10,50),a="data(size)";break;case r.SIZEOPTIONS[3]:r.elems.nodes.forEach(function(e){var t=r.cy.getElementById(e.data.id);e.data.degree=t.indegree()}),f(r.elems,"degree","size",10,50),a="data(size)";break;case r.SIZEOPTIONS[4]:r.elems.nodes.forEach(function(e){var t=r.cy.getElementById(e.data.id);e.data.degree=t.outdegree()}),f(r.elems,"degree","size",10,50),a="data(size)";break;case r.SIZEOPTIONS[5]:var n=r.cy.elements().pageRank();r.elems.nodes.forEach(function(e){var t=r.cy.getElementById(e.data.id),a=n.rank(t);e.data.pagerank=a}),f(r.elems,"pagerank","size",10,50),a="data(size)"}r.cy.style().selector("node").style("height",a).style("width",a).update()},r.COLOROPTIONS=[{value:"Vakio",tooltip:!1},{value:"Sukupuoli",tooltip:"Henkilöt väritetään sukupuolen mukaan."},{value:"Toimiala",tooltip:"Henkilöt väritetään tietokannassa ilmoitetun toimialan mukaan."},{value:"Etäisyys",tooltip:"Solmujen väri määräytyy keskushenkilöön johtavan linkkipolun etäisyyden perusteella."}],r.coloroption=r.COLOROPTIONS[3],r.changecolor=function(){var e,a=r.COLOROPTIONS.indexOf(r.coloroption);switch(a>-1&&t.search("coloroption",a),r.showlegend=!1,r.coloroption){case r.COLOROPTIONS[1]:m(r.elems,"gender","color"),e="data(color)",r.showlegend=!0;break;case r.COLOROPTIONS[2]:m(r.elems,"category","color"),e="data(color)",r.showlegend=!0;break;case r.COLOROPTIONS[3]:var i=r.cy.elements().dijkstra({root:r.cy.getElementById(r.id)});r.elems.nodes.forEach(function(e){var t=r.cy.getElementById(e.data.id);e.data.dijkstra=i.distanceTo(t)}),m(r.elems,"dijkstra","color"),e="data(color)";break;default:e=r.COLORS[0]}r.cy.style().selector("node").style("background-color",e).update()};var l=t.search();if(l.limit){var c=parseInt(l.limit);r.LIMITOPTIONS.forEach(function(e,t){c==e.value&&(r.searchlimit=r.LIMITOPTIONS[t])})}l.coloroption&&(r.coloroption=r.COLOROPTIONS[parseInt(l.coloroption)]),l.sizeoption&&(r.sizeoption=r.SIZEOPTIONS[parseInt(l.sizeoption)]);var p=e.$on("sf-initial-constraints",function(e,t){d(),p()});function d(){return r.error=void 0,r.loading=!0,r.cy&&r.cy.elements().remove(),r.message="",r.messagecolor="blue",r.cy=null,r.personId=n.personId,s.getNodes(n.personId,r.searchlimit.value).then(function(a){if(a.length<2)return r.loading=!1,r.message="Henkilölle ei löydy näytettävää verkostoa.",void(r.messagecolor="red");r.elems.nodes=a.map(function(e){return{data:e}});var i=a.map(function(e){return e.id.replace("http://ldf.fi/nbf/","nbf:")}).join(" ");return r.label=a[0].label,r.id=n.personId,s.getLinks(i).then(function(a){r.elems.edges=a.map(function(e){return{data:e}}),function(a){var i=[{selector:"node",style:{shape:"ellipse",height:"20",width:"20","text-valign":"center","text-halign":"right",content:"data(label)","background-color":a.COLORS[0],color:"#888"}},{selector:":active",style:{"background-color":"#800",color:"#000"}},{selector:"edge",style:{width:1,"line-color":"#999","curve-style":"bezier","target-arrow-shape":"triangle","target-arrow-color":"#999"}}];a.cy=cytoscape({container:document.getElementById("networkcontainer"),elements:a.elems,wheelSensitivity:.2,layout:{name:"circle"},style:i}),a.cy.on("click","node",function(a){document.body.style.cursor="auto";var i="/"+this.id().replace(new RegExp("/","g"),"~2F")+"/verkosto";t.url(i),e.$apply()}),a.cy.on("mouseover","node",function(e){document.body.style.cursor="pointer"}),a.cy.on("mouseout","node",function(e){document.body.style.cursor="auto"}),a.changecolor(),a.changesize(),a.cy.layout({name:"cose",idealEdgeLength:100,nodeOverlap:20,refresh:20,fit:!0,padding:30,randomize:!1,componentSpacing:100,nodeRepulsion:4e5,edgeElasticity:100,nestingFactor:5,gravity:80,numIter:800,initialTemp:200,coolingFactor:.95,minTemp:1}).run(),a.cy.panzoom&&a.cy.panzoom({})}(r),r.loading=!1,r.elems.edges.length==r.searchlimit.value?r.message="Näytetään {} ensimmäistä linkkiä ja {2} henkilöä".replace("{}",r.searchlimit.value).replace("{2}",r.elems.nodes.length):r.message="Näytetään {} linkkiä ja {2} henkilöä".replace("{}",r.elems.edges.length).replace("{2}",r.elems.nodes.length)}).catch(u)}).catch(u)}function u(e){r.isLoadingResults=!1,r.error=e}e.$on("sf-facet-constraints",d),r.handler=new o({scope:e});var m=function(e,t,a){var i={};e.nodes.forEach(function(e){var a=""+e.data[t];i.hasOwnProperty(a)||(i[a]=0),i[a]++});var n=[];for(var s in i)n.push({count:i[s],label:s});n.sort(function(e,t){return t.count-e.count}),i={},n.forEach(function(e,t){i[e.label]=t<r.COLORS.length?r.COLORS[t]:r.COLORS[r.COLORS.length-1]}),r.legend=n.map(function(e,t){return{label:""+e.label=="undefined"?"ei tiedossa":e.label,color:r.COLORS[t]}});var o=r.COLORS.length;r.legend.length>o&&(r.legend=r.legend.slice(0,o),r.legend[o-1].label="muut"),e.nodes.forEach(function(e){var n=e.data[t];e.data[a]=i[n]})},f=function(e,t,a,i,n){if(!(e.nodes.length<1)){var s=e.nodes[0].data[t],o=s;e.nodes.forEach(function(e){var a=e.data[t];a<s&&(s=a),o<a&&(o=a)}),s==o&&(o+=1);var r=(n-i)/(o-s),l=i-s/(o-s)*(n-i);e.nodes.forEach(function(e){var i=e.data[t];e.data[a]=i*r+l})}}}angular.module("facetApp").controller("PersonNetworkController",e),e.$inject=["$scope","$location","$state","_","$stateParams","networkService","FacetHandler"]}(),function(){"use strict";function e(e,t,a,i,n){var s=this;function o(e){s.isLoadingResults=!1,s.error=e}s.strings={pageTitle:"Semanttinen kansallisbiografia",jumboTitle:"Semanttinen kansallisbiografia",jumboSubtitle:"Suomalaisten elämäkertojen verkosto semanttisessa webissä",generalDesc:"Sovellus mahdollistaa suomalaisten historiallisten henkilöiden elämäkertojen ja henkilöryhmien tutkimisen toisiinsa linkitettyjen laajojen tietoaineistojen avulla.",ins:"ohje",followFacebook:"Liity Semanttinen kansallisbiografia -ryhmään Facebookissa",localeLinkText:"In English",choosePerspective:"Valitse sovellusnäkymä aineistoihin",perspectiveTooltip:"Klikkaa käynnistääksesi sovellus",searchH:"Hae ja selaa",searchP:"Etsi elämäkertoja joustavasti eri näkökulmista",mapsH:"Kartat",mapsP:"Elämäkerrat kartalla",statisticsH:"Tilastot",statisticsP:"Ryhmien elämäntarinat tilastojen kautta",networksH:"Verkostot",networksP:"Tutki historiallisten henkilöiden verkostoja",relationsH:"Yhteyshaku",relationsP:"Hae henkilöiden ja paikkojen välisisä yhteyksiä",casultiesH:"Kielianalyysi",casultiesP:"Tutki elämäkerroissa käytetttyä kieltä",metaDescription:"Sovelluksen avulla voi hakea, selata, visualisoida ja tutkia laajoja suomalaisiin historiallisiin henkilöihin liittyviä tietoaineistoja."},s.testing="Testing",i.getPortal().then(function(e){return e}).catch(o)}angular.module("facetApp").controller("PortalController",e),e.$inject=["$stateParams","$uibModal","_","nbfService","$sce"]}(),function(){"use strict";function e(e,t){this.getPopover=function(e){var t=a+i,n="VALUES ?id2 { <"+e+"> } . ";return o.getObjectsNoGrouping(t.replace("<RESULT_SET>",n)).then(function(e){return e[0]})},this.getHrefPopover=function(e){var t='VALUES ?href { "'+e+'" } ';return o.getObjectsNoGrouping(a+n.replace("<RESULT_SET>",t)).then(function(e){return e[0]})},this.getPopoverGroup=function(e){var t=e.map(function(e){return e.match(/^p\d+$/)?"nbf:"+e:"<"+e+">"}).join(" "),i=a+s,n="VALUES ?id2 { "+t+" } . ";return o.getObjectsNoGrouping(i.replace("<RESULT_SET>",n)).then(function(e){return e})};var a=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX sources:\t<http://ldf.fi/nbf/sources/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX rels: <http://ldf.fi/nbf/relations/> ",i='SELECT DISTINCT ?id ?label ?image ?lifespan  WHERE {  <RESULT_SET>   ?id2 owl:sameAs* ?id . FILTER NOT EXISTS {?id owl:sameAs []}   ?id foaf:focus ?prs .   OPTIONAL { ?prs nbf:image [ schema:image ?image1 ; dct:source sources:source1 ] }   OPTIONAL { ?prs nbf:image [ schema:image ?image2 ; dct:source sources:source10 ] }   OPTIONAL { ?prs nbf:image/schema:image ?image3 }   BIND (COALESCE(?image1, ?image2, ?image3) AS ?image)      OPTIONAL { ?id skosxl:prefLabel/schema:familyName ?fname . }      OPTIONAL { ?id skosxl:prefLabel/schema:givenName ?gname . }      BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)          OPTIONAL { ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime }      OPTIONAL { ?id foaf:focus/^crm:P100_was_death_of/nbf:time/gvp:estStart ?dtime }      BIND (CONCAT("(", COALESCE(STR(YEAR(?btime)), " "), "-", COALESCE(STR(YEAR(?dtime)), " "), ")") AS ?lifespan)     } LIMIT 1 ',n='SELECT DISTINCT ?id ?label ?image ?lifespan  WHERE {     { <RESULT_SET> }   ?id nbf:formatted_link ?href ;   \t\towl:sameAs*/foaf:focus ?prs .   OPTIONAL { ?prs nbf:image [ schema:image ?image1 ; dct:source sources:source1 ] }   OPTIONAL { ?prs nbf:image [ schema:image ?image2 ; dct:source sources:source10 ] }   OPTIONAL { ?prs nbf:image/schema:image ?image3 }   BIND (COALESCE(?image1, ?image2, ?image3) AS ?image)      OPTIONAL { ?id skosxl:prefLabel/schema:familyName ?fname . }      OPTIONAL { ?id skosxl:prefLabel/schema:givenName ?gname . }      BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)          OPTIONAL { ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime }      OPTIONAL { ?id foaf:focus/^crm:P100_was_death_of/nbf:time/gvp:estStart ?dtime }      BIND (CONCAT("(", COALESCE(STR(YEAR(?btime)), " "), "-", COALESCE(STR(YEAR(?dtime)), " "), ")") AS ?lifespan)     } LIMIT 1 ',s='SELECT DISTINCT ?id ?label ?image ?lifespan  WHERE {     <RESULT_SET>   ?id2 owl:sameAs* ?id . FILTER NOT EXISTS {?id owl:sameAs []}   ?id foaf:focus ?prs .   OPTIONAL { ?prs nbf:image [ schema:image ?image1 ; dct:source sources:source1 ] }   OPTIONAL { ?prs nbf:image [ schema:image ?image2 ; dct:source sources:source10 ] }   OPTIONAL { ?prs nbf:image/schema:image ?image3 }   BIND (COALESCE(?image1, ?image2, ?image3) AS ?image)    OPTIONAL { ?id skosxl:prefLabel/schema:familyName ?fname . }  OPTIONAL { ?id skosxl:prefLabel/schema:givenName ?gname . }  BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)   OPTIONAL { ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?btime }   OPTIONAL { ?id foaf:focus/^crm:P100_was_death_of/nbf:time/gvp:estStart ?dtime }   BIND (CONCAT("(", COALESCE(STR(YEAR(?btime)), " "), "-", COALESCE(STR(YEAR(?dtime)), " "), ")") AS ?lifespan) } ORDER BY UCASE(?fname) ?gname ',o=new t({endpointUrl:e,usePost:!0})}angular.module("facetApp").service("popoverService",e),e.$inject=["SPARQL_ENDPOINT_URL","AdvancedSparqlService"]}(),function(){"use strict";angular.module("facetApp").directive("kblink",function(){return{restrict:"EC",scope:{href:"@"},transclude:!0,controller:["$scope","popoverService",function(e,t){e.href&&(e.image=!1,e.lifespan="",t.getHrefPopover(e.href).then(function(t){t.length&&(t=t[0]),e.label=t.label,e.link="#!/"+t.id.replace(new RegExp("/","g"),"~2F"),new RegExp(/\d/).test(t.lifespan)&&(t.lifespan=t.lifespan.replace(/(\D)0/g,"$1"),e.lifespan=t.lifespan),t.hasOwnProperty("image")&&(e.image=t.image)}))}],template:'<a uib-popover-template="\'views/personTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ng-href="{{ link }}" ng-transclude></a>'}})}(),function(){"use strict";angular.module("facetApp").directive("personlink",function(){return{restrict:"EC",scope:{url:"@"},transclude:!0,controller:["$scope","popoverService",function(e,t){e.url&&(e.link="#!/"+e.url.replace(new RegExp("/","g"),"~2F"),e.image=!1,e.lifespan="",t.getPopover(e.url).then(function(t){t.length&&(t=t[0]),e.label=t.label,new RegExp(/\d/).test(t.lifespan)&&(t.lifespan=t.lifespan.replace(/(\D)0/g,"$1"),e.lifespan=t.lifespan),t.hasOwnProperty("image")&&(e.image=t.image)}))}],template:'<a uib-popover-template="\'views/personTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ng-href="{{ link }}"><span ng-transclude></span></a>'}})}(),function(){"use strict";angular.module("facetApp").directive("nbfPerson",function(){return{restrict:"AE",scope:{url:"@"},controller:["$scope","popoverService",function(e,t){e.link="#!/"+e.url.replace(new RegExp("/","g"),"~2F"),e.image=!1,e.lifespan="",t.getPopover(e.url).then(function(t){t.length&&(t=t[0]),e.label=t.label,new RegExp(/\d/).test(t.lifespan)&&(t.lifespan=t.lifespan.replace(/(\D)0/g,"$1"),e.lifespan=t.lifespan),t.hasOwnProperty("image")&&(e.image=t.image)})}],template:'<a uib-popover-template="\'views/personTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" ng-href="{{ link }}">{{ label }}</a>'}})}(),function(){"use strict";angular.module("facetApp").directive("nbfPersongroup",function(){return{restrict:"AE",scope:{url:"@"},controller:["$scope","popoverService",function(e,t){t.getPopoverGroup(e.url.split(",")).then(function(t){t.forEach(function(e,t){e.link="#!/"+e.id.replace(new RegExp("/","g"),"~2F"),e.lifespan=e.lifespan.replace(/(\D)0/g,"$1"),new RegExp(/\d/).test(e.lifespan)||(e.lifespan=""),e.placement=t>7?"top":"bottom"}),e.people=t})}],templateUrl:"views/directive/nbf-persongroup.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nbfBiography",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","biographyService",function(e,t){e.loadBio=function(){"false"!=e.active&&t.getBio(e.url).then(function(t){e.bio=t})}}],link:function(e,t,a,i){e.$watch("active",function(t,a){t&&e.loadBio()},!0)},templateUrl:"views/directive/nbf-biography.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nlpBiography",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","biographyService",function(e,t){e.loadBio=function(){"false"!=e.active&&t.getNlpBio(e.url).then(function(t){e.data=t})}}],link:function(e,t,a,i){e.$watch("active",function(t,a){t&&e.loadBio()},!0)},templateUrl:"views/directive/nlp-biography.directive.html"}})}(),function(){"use strict";angular.module("facetApp").directive("nbfIframe",function(){return{restrict:"AE",scope:{url:"@",active:"@"},controller:["$scope","$sce",function(e,t){e.loadBio=function(){"false"!=e.active&&(e.src=t.trustAsResourceUrl(e.url))}}],link:function(e,t,a,i){e.$watch("active",function(t,a){e.loadBio()},!0)},templateUrl:"views/directive/nbf-iframe.directive.html"}})}(),function(){"use strict";function e(e,t){this.updateUrlParams=function(a){a=a.facets||a;var i={};t(a).forOwn(function(e,a){!e||!e.value||t.isObject(e.value)&&t.isEmpty(e.value)||(i[a]={value:e.value,constraint:e.constraint})}),i=t.isEmpty(i)?null:angular.toJson(i);e.search(this.urlparameter,i)},this.getFacetValuesFromUrlParams=function(){var a={},i=(e.search()||{})[this.urlparameter];if(!i)return a;try{i=angular.fromJson(i)}catch(t){return e.search(this.urlparameter,null),a}return t.forOwn(i,function(e,t){a[t]=e}),a},this.urlparameter="facets2"}angular.module("seco.facetedSearch").service("facetUrlStateHandlerService2",e),e.$inject=["$location","_"]}(),function(){"use strict";function e(e,t,a,i,n){this.getBio=function(e){var a=s+r,i="VALUES ?bio { <"+e+"> } . ";return c.getObjectsNoGrouping(a.replace("<RESULT_SET>",i)).then(function(e){var a=e[0];return a.description&&(a.description=t.trustAsHtml(a.description)),a.source_paragraph&&(a.source_paragraph=t.trustAsHtml(a.source_paragraph)),a.lead_paragraph&&(a.lead_paragraph=t.trustAsHtml(a.lead_paragraph)),a.spouse_paragraph&&(a.spouse_paragraph=t.trustAsHtml(a.spouse_paragraph)),a})},this.getNlpBio=function(e){var t=o+l,a=" <"+e+"> ";return p.getObjectsNoGrouping(t.replace("<RESULT_SET>",a)).then(function(e){var t=[],a="",i=!1;return e.forEach(function(e){var n=parseInt(e.x),s=parseInt(e.y);parseInt(e.z);t[n]||(t[n]=[]),t[n][s]||(t[n][s]=[],a="",i=!1),e.space=!0,e.word||(e.word="–",RegExp("[0-9IVXLCDM.]").test(a)&&(e.space=!1)),RegExp("&quot;").test(e.word)&&(e.word=e.word.replace("&quot;",'"'),i=!i,e.space=i),RegExp("[&']").test(e.word)&&console.log(e),"–"==a&&RegExp("^[0-9IVXLCDM]").test(e.word)&&(e.space=!1),e.word&&RegExp("^[.,:;=!?)}%]").test(e.word)?e.space=!1:RegExp('"').test(a)&&(e.space=!i),RegExp("[({[]").test(a)&&(e.space=!1),t[n][s].push(e),a=e.word?e.word.slice(-1):""}),t})};var s=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX sources:\t<http://ldf.fi/nbf/sources/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:\t<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",o="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX dct: <http://purl.org/dc/terms/> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#> PREFIX bd: <http://ldf.fi/nbf/biography/data#> ",r='SELECT DISTINCT * WHERE { { <RESULT_SET> }  OPTIONAL { ?bio dct:source ?source . ?source skos:prefLabel ?database }  OPTIONAL { ?bio nbf:authors ?author_text }  OPTIONAL { ?bio schema:dateCreated ?created }  OPTIONAL { ?bio schema:dateModified ?modified }  OPTIONAL { ?bio schema:relatedLink ?link }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "0"^^xsd:integer ; nbf:content ?lead_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "1"^^xsd:integer ; nbf:content ?description    ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "2"^^xsd:integer ; nbf:content ?family_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "3"^^xsd:integer ; nbf:content ?parent_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "4"^^xsd:integer ; nbf:content ?spouse_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "5"^^xsd:integer ; nbf:content ?child_paragraph  ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "6"^^xsd:integer ; nbf:content ?medal_paragraph  ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "7"^^xsd:integer ; nbf:content ?source_paragraph ] }} ORDER BY str(?source)',l="SELECT ?word ?x ?y ?z WHERE {   \t?structure bd:bioId <RESULT_SET> . \t?s nif:structure ?structure ; \t\trdf:type nif:Sentence ; \t\tdct:isPartOf ?paragraph ;         nif:order ?seo .            \t?w nif:sentence ?s ;        <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#ID> ?k . \t?paragraph bd:order ?i .     OPTIONAL {         ?w <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#WORD> ?word . \t} OPTIONAL {             ?w dct:isPartOf ?ne .             ?ne bd:namedEntityType ?type ;                 nif:isString ?string ;                 nif:beginIndex ?begin ;                  nif:endIndex ?end .             ?ne bd:usedNeMethod ?ned .             ?ne bd:primary 1 .             ?ned bd:score ?score .         }       BIND(xsd:integer(?i)-1 AS ?x)       BIND(xsd:integer(xsd:decimal(STR(?seo)))-1 AS ?y)       BIND(xsd:integer(?k)-1 AS ?z) } ORDER BY asc(?x) asc(?y) asc(?z) ",c=new i({endpointUrl:a,usePost:!0},n),p=new i({endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},n)}angular.module("facetApp").service("biographyService",e),e.$inject=["$q","$sce","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),angular.module("facetApp").run(["$templateCache",function(e){"use strict";e.put("views/comparison.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-6 comparison comparison-left" ui-view="left"></div> <div class="col-sm-6 comparison comparison-right" ui-view="right"></div> </div> </div>'),e.put("views/description.network.partial.html",'<h1>Tutki ryhmiin liit&shy;tyvää verkostoa</h1> <p> Sivulla näytetään havainnekuva henkilöön liittyvästä verkostosta. Linkitys on luotu biografiakuvausten viittausten perusteella. </p> <p> Verkoston solmuja voidaan siirtää hiirellä. Solmuja klikkaamalla pääset tarkastelemaan verkostoa valitun henkilön ympärillä. Alapuoleisilla valikoilla voidaan säätää verkoston laajuutta ja ulkoasua. </p> <div class="well well-sm"> <p style="color:{{vm.messagecolor}}">{{ vm.message }}</p> <p> Näytä verkostossa korkeintaan <select ng-model="vm.searchlimit" ng-options="item.label for item in vm.LIMITOPTIONS" ng-change="vm.changelimit()"> </select> linkkiä. </p> <p> Solmujen koko: <select ng-model="vm.sizeoption" ng-options="item.value for item in vm.SIZEOPTIONS" ng-change="vm.changesize()"> </select> <span ng-if="vm.sizeoption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.sizeoption.tooltip}}" tooltip-placement="right"></span> </p> <p> Solmujen väri: <select ng-model="vm.coloroption" ng-options="item.value for item in vm.COLOROPTIONS" ng-change="vm.changecolor()"> </select> <span ng-if="vm.coloroption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.coloroption.tooltip}}" tooltip-placement="right"></span> </p> </div>'),e.put("views/description.npl.partial.html","<h1>Kielianalyysi</h1> <p> Aineistosta laskettuja tilastoja. <br>Rajaa aineistoa tekemällä valintoja alla olevista suodattimista. </p>"),e.put("views/description.statistics.partial.html","<h1>Tutki tilastoja</h1> <p> Aineistosta laskettuja tilastoja. <br>Rajaa aineistoa tekemällä valintoja alla olevista suodattimista. </p>"),e.put("views/directive/nbf-biography.directive.html",'<div class="col-sm-6 col-md-12" ng-if="!!bio"> <div ng-if="bio.database" class="entry-text text-left icon-menu"> <p> <br> <span style="font-size: 100%"> <a ng-if="bio.link" title="Artikkeli Biografiakeskuksen sivulla" ng-href="{{ bio.link }}"> \x3c!-- <span class="glyphicon glyphicon-book" aria-hidden="true"></span>  --\x3e Artikkeli Biografiakeskuksen sivulla</a> </span> </p><p> </p></div> <div ng-if="bio.lead_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="bio.lead_paragraph"></p> </div> <div ng-if="bio.description" class="entry-text text-left"> <hr> <p ng-bind-html="bio.description"></p> </div> <div ng-if="bio.family_paragraph" class="entry-text text-left"> <hr> <p>{{ bio.family_paragraph }}</p> </div> <div ng-if="bio.parent_paragraph" class="entry-text text-left"> <hr> <h4>Vanhemmat</h4> <p>{{ bio.parent_paragraph }}</p> </div> <div ng-if="bio.spouse_paragraph" class="entry-text text-left"> <hr> <h4>Puoliso(t) vanhempineen</h4> <p>{{ bio.spouse_paragraph }}</p> </div> <div ng-if="bio.child_paragraph" class="entry-text text-left"> <hr> <h4>Lapset</h4> <p>{{ bio.child_paragraph }}</p> </div> <div ng-if="bio.medal_paragraph" class="entry-text text-left"> <hr> <h4>Kunniamerkit</h4> <p>{{ bio.medal_paragraph }}</p> </div> <div ng-if="bio.source_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="bio.source_paragraph"></p> </div> <div class="entry-text text-left"> <hr> <span ng-if="bio.author_text">Kirjoittaja(t): {{ bio.author_text }}</span> <span ng-if="bio.created">Julkaistu {{ bio.created | date:\'dd.MM.yyyy\' }}</span> <span ng-if="bio.modified">(päivitetty {{ bio.modified | date:\'dd.MM.yyyy\' }})</span> </div> <hr> </div>'),e.put("views/directive/nbf-iframe.directive.html",'<div class="col-sm-6 col-md-12" ng-if="!!src"> <iframe ng-src="{{src}}" onload="loaded=true" onerror="console.log(\'on error\')" error="console.log(\'error\')"> <a href="{{src}}">{{src}}</a> </iframe> </div>'),e.put("views/directive/nbf-persongroup.directive.html",'<ul class="list-group row list-group-persons ng-scope" id="popupcontainer2"> <li class="list-group-item col-xs-6 ng-scope" ng-repeat="person in people"> <a uib-popover-template="\'views/persongroupTooltipTemplate.html\'" popover-trigger="\'mouseenter\'" popover-placement="{{ person.placement }}" ng-href="{{ person.link }}">{{ person.label }}</a> </li> </ul>'),e.put("views/directive/nlp-biography.directive.html",'<div class="col-sm-6 col-md-12" ng-if="!!data"> <p ng-repeat="parag in data"> <span ng-repeat="sentence in parag"> <span ng-repeat="x in sentence"><span ng-if="x.space"> </span><span>{{x.word}}</span></span> </span> <hr> </p> </div>'),e.put("views/directive/ws-related-links-paged.directive.html",'<img src="images/loading-sm.73030d37.gif" ng-show="!vm.totalItems && vm.isLoadingPage"> <div class="row related" ng-if="vm.totalItems" ng-init="show = true"> <div class="col-sm-12" title="{{ additionalText }}"> <h3 ng-click="show = !show"> <a>{{ title }} ({{ vm.totalItems }}) <span ng-class="[\'glyphicon\', {\'glyphicon-menu-down\': show, \'glyphicon-menu-right\': !show}]"></span> </a> <img src="images/loading-sm.73030d37.gif" ng-show="vm.isLoadingPage"> </h3> <div uib-collapse="!show"> <ul class="list-group"> <li class="list-group-item" ng-repeat="thing in vm.related"> <span ng-if="!external"> <a ws-page-link="thing.id">{{ vm.getLabel(thing) | words:10 }}</a> </span> <span ng-if="external"> <a ng-href="{{ thing.id }}">{{ vm.getLabel(thing) | words:10 }}</a>  </span></li> <li class="list-group-item" ng-if="vm.totalItems > vm.pageSize"> <ul uib-pagination total-items="vm.totalItems" ng-change="vm.updatePage()" ng-model="vm.currentPage" max-size="5" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" class="pagination-sm no-margin" boundary-links="true"></ul> </li> </ul> </div> </div> </div>'),e.put("views/directive/ws-related-links.directive.html",'<div class="row related" ng-if="related && related.length" ng-init="show = related.length <= 10"> <div class="col-sm-12"> <h3 ng-click="show = !show"> <a>{{ title }} ({{ related.length }}) <span ng-class="[\'glyphicon\', {\'glyphicon-menu-down\': show, \'glyphicon-menu-right\': !show}]"></span> </a> </h3> <div uib-collapse="!show"> <ul class="list-group"> <li class="list-group-item" ng-repeat="thing in related"> <span ng-switch="!!external"> <span ng-switch-when="false"> <a ng-href="{{ thing.id }}">{{ thing.label }}</a> </span> <span ng-switch-when="true"> <a ng-href="{{ thing.id }}">{{ thing.listLabel || thing.getLabel() || thing.label | words:10 }}</a> </span> </span> </li> </ul> </div> </div> </div>'),e.put("views/facets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> <seco-jena-text-facet data-options="vm.facets.entryText"></seco-jena-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <seco-basic-facet data-options="vm.facets.keywords"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.period"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.familyName"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.author"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.title"></seco-basic-facet> <seco-hierarchy-facet data-options="vm.facets.place"></seco-hierarchy-facet> </div> </div>'),e.put("views/groupmap/comparison.left.html",'<div class="row"> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/description.partial.html\'"></div> <div ng-include="\'views/groupmap/controls.partial.html\'"></div> </div> <div ng-include="\'views/groupmap/map.html\'"></div> </div>'),e.put("views/groupmap/comparison.right.html",'<div class="row"> <div ng-include="\'views/groupmap/map.html\'"></div> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/controls.partial.html\'"></div> </div> </div>'),e.put("views/groupmap/comparison2.left.html",'<div class="row"> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/description2.partial.html\'"></div> <div ng-include="\'views/groupmap/controls2.partial.html\'"></div> </div> <div ng-include="\'views/groupmap/map2.html\'"></div> </div>'),e.put("views/groupmap/comparison2.right.html",'<div class="row"> <div ng-include="\'views/groupmap/map2.html\'"></div> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/controls2.partial.html\'"></div> </div> </div>'),e.put("views/groupmap/controls.partial.html",'<span ng-if="vm.message" style="color:blue">{{ vm.message }}<br><br></span> <div class="well well-sm"> <b>Tapahtumatyypit</b> <form name="eventForm" class="eventForm" ng-repeat="type in vm.EVENTTYPES"> <label title="{{ type.tooltip }}" style="color: {{ type.color }}"> <input type="checkbox" ng-model="type.check" ng-change="vm.change()"> <span>{{ type.label }}</span> </label><br> </form> Näytä kartalla korkeintaan <select ng-model="vm.searchlimit" ng-options="item.value for item in vm.LIMITOPTIONS" ng-change="vm.change()"> </select> tulosta. </div> <div ng-include="\'views/mapfacets.partial.html\'"></div>'),e.put("views/groupmap/controls2.partial.html",'Näytä kartalla kor&shy;keintaan <select ng-model="vm.searchlimit" ng-options="item.value for item in vm.LIMITOPTIONS" ng-change="vm.change()"> </select> tulosta. <br> <span ng-if="vm.message" style="color:blue">{{ vm.message }}<br><br></span> <div ng-include="\'views/mapfacets.partial.html\'"></div>'),e.put("views/groupmap/description.partial.html",'<div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <h1>Tutki elämä&shy;ker&shy;to&shy;ja kar&shy;toilla</h1> <p> Kartalla näytetään henki&shy;löiden elin&shy;aikai&shy;sia tapah&shy;tumia. Ala&shy;puo&shy;lei&shy;silla suodat&shy;ti&shy;milla voi&shy;daan valita halu&shy;tut tapah&shy;tuma&shy;tyypit ja henkilö&shy;ryhmä. </p> <p> Klikkaamalla ympyrää kartalla auke&shy;aa ikkuna, jossa näytetään lista hen&shy;ki&shy;löistä, joilla on paikkaan liit&shy;tyviä tapahtumia. </p>'),e.put("views/groupmap/description2.partial.html",'<div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <h1>Tutki elämä&shy;ker&shy;toja kar&shy;toilla</h1> <p> Kartalla yhdistetään henki&shy;löiden <span style="color:blue">synnyin-</span> ja <span style="color:red">kuolin</span>paikat nuolilla. Jos paikka on sama, esite&shy;tään se ympy&shy;ränä. Ala&shy;puolei&shy;silla suodat&shy;ti&shy;milla voidaan rajata haluttu henkilö&shy;ryhmä. </p> <p> Klikkaamalla nuolia ja ympyröitä kar&shy;tal&shy;la aukeaa ikkuna, jossa näy&shy;te&shy;tään lista henkilöistä, joilla on paik&shy;kaan liittyviä tapahtumia. </p>'),e.put("views/groupmap/groupmap.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>'),e.put("views/groupmap/map.html",'<div class="col-md-8 col-lg-9"> <div class="col-sm-12 mapspinner" ng-show="vm.isLoadingResults"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom" events="vm.mapevents"> <ui-gmap-window id="ui-gmap-window" show="vm.window.show" options="vm.window" templateurl="\'views/groupmap/popup.html\'" templateparameter="vm" closeclick="vm.closeWindow"> <span></span> </ui-gmap-window> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options" click="marker.onClick()"> </ui-gmap-marker> </ui-gmap-google-map> </div>'),e.put("views/groupmap/map2.html",'<div class="col-md-8 col-lg-9"> <div class="col-sm-12 mapspinner" ng-show="vm.isLoadingResults && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom" events="vm.mapevents"> <ui-gmap-window id="ui-gmap-window" show="vm.window.show" options="vm.window" templateurl="\'views/groupmap/popup.html\'" templateparameter="vm" closeclick="vm.closeWindow"> <span></span> </ui-gmap-window> <ui-gmap-polyline static="true" visible geodesic="true" ng-repeat="p in vm.polylines" path="p.path" stroke="p.stroke" icons="p.icons" events="p.events"> </ui-gmap-polyline> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options" click="marker.click()"> </ui-gmap-marker> </ui-gmap-google-map> </div>'),e.put("views/groupmap/singleview.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/description.partial.html\'"></div> <div ng-include="\'views/groupmap/controls.partial.html\'"></div> </div> <div ng-include="\'views/groupmap/map.html\'"></div> </div> </div>'),e.put("views/groupmap/singleview2.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/groupmap/description2.partial.html\'"></div> <div ng-include="\'views/groupmap/controls2.partial.html\'"></div> </div> <div ng-include="\'views/groupmap/map2.html\'"></div> </div> </div>'),e.put("views/groupmap/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="maps.singleview" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Tapahtumakartta</a> </li> <li ui-sref="maps.comparison.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>Tapahtumakarttojen vertailu</a> </li> <li ui-sref="maps.singleview2" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Elämäkartta</a> </li> <li ui-sref="maps.comparison2.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-globe" aria-hidden="true"></span> <span class="glyphicon glyphicon-globe" aria-hidden="true"></span> Elämäkarttojen vertailu</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/groupmap3.html",'<div class="container-fluid"> <div class="row"> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="col-md-4 pull-md-4 col-lg-3"> <h1>Tutki elämäkertoja kartoilla</h1> Kartalla näytetään tapahtumapaikkoja lämpökarttana. Alapuoleisilla suodattimilla voidaan rajata haluttu tapahtumatyyppi ja henkilöryhmä. <br><br> <span ng-if="vm.message" style="color:#ff4141">{{ vm.message }}<br><br></span> <div class="well well-sm"> <b>Tapahtumatyypit</b> <form name="eventForm" class="eventForm"> <label title="Henkilöiden syntymäpaikat lämpökarttana"> <input type="checkbox" ng-model="vm.eventBox[0]" ng-change="vm.change()"> Syntymä </label><br> <label title="Henkilöiden kuolinpaikat lämpökarttana"> <input type="checkbox" ng-model="vm.eventBox[1]" ng-change="vm.change()"> Kuolema </label><br> <label title="Henkilöiden opiskelu- ja työpaikat"> <input type="checkbox" ng-model="vm.eventBox[2]" ng-change="vm.change()"> Ura </label><br> <label title="Paikat, joissa on henkilöihin liittyviä teoksia"> <input type="checkbox" ng-model="vm.eventBox[3]" ng-change="vm.change()"> Teokset </label><br> <label> <input type="checkbox" ng-model="vm.eventBox[4]" ng-change="vm.change()"> Kunniamaininnat </label><br> </form> </div> <div ng-include="\'views/mapfacets.partial.html\'"> </div> </div> <div class="container-fluid"> <div class="col-md-8 col-lg-9"> <div class="col-sm-12 mapspinner" ng-show="vm.isLoadingResults && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="ui-gmap-google-map" style="height:600px"></div> </div> </div> </div> </div>'),e.put("views/help.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10 text-left"> <h3 class="modal-title">Kansallisbiografia</h3> </div> <div class="col-xs-2"> <a href="#" ng-click="$close()" class="no-decoration btn-lg pull-right glyphicon glyphicon-remove"></a> </div> </div> </div> <div class="modal-body"> <p>Matrikkelin tietoja voi selata käyttöliittymässä käyttämällä vasemmalla olevia suodattimia. </p> <p>Hakeaksesi rekisteristä tekstihaulla, kirjoita hakutermit ylimpänä olevaan \'Haku\'-kenttään. <br>Poistaaksesi hakurajauksen, paina X-nappia hakukentän oikealla puolella.</p> <p>Jokaisella suodattimella on oma hakukenttä sekä lista suodattimen vaihtoehdoista, josta voi valita haluamansa ehdon. Valitun ehdon antamien tulosten määrä näkyy suluissa valinnan nimen perässä. Rajauksen voi poistaa valitsemalla vaihtoehdon \'-- Ei valintaa --\'.</p> <p>Kustakin suodattimesta voi valita vain yhden vaihtoehdon, jolloin henkilölistausta suodatetaan tämän vaihtoehdon perusteella. Useita eri suodattimia voi käyttää samanaikaisesti. </p> <p> <h4>Suodattimien valinta:</h4> <ol> <li>Valitse joku suodattimista ja avaa suodatin painamalla \'+\'-nappia suodattimen otsikon oikealla puolella.</li> <li>Valitse suodattimeen arvo listalta tai hae kirjoittamalla listan yllä olevaan tekstikenttään. Jos suodatinehtoa haetaan tekstikentän avulla alla oleva lista suodattimista päivittyy kirjoittaessa.</li> <li>Suodatinehdon voi valita klikkaamalla sitä listalta, tai poistaa valitsemalla \'-- Ei valintaa --\' listan alusta. </li> <li>Henkilöiden lista päivittyy suodattimien oikealla puolella.</li> <li>Tuloksia voi nyt suodattaa tarvittaessa lisää toistamalla toisella suodattimella edelliset askeleet 1-4.</li> </ol> </p> </div>'),e.put("views/login.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>Kirjaudu</h1> <div ng-show="vm.error" class="alert alert-danger" role="alert">{{ vm.error }}</div> <form> <div class="form-group"> <label for="un">Käyttäjätunnus</label> <input ng-model="vm.un" type="text" class="form-control" id="un" placeholder="Username"> </div> <div class="form-group"> <label for="pw">Salasana</label> <input ng-model="vm.pw" type="password" class="form-control" id="pw" placeholder="Password"> </div> <button ng-click="vm.login()" type="submit" class="btn btn-default">Submit</button> </form> </div> </div> </div>'),e.put("views/mapfacets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> \x3c!-- <seco-jena-text-facet data-options="vm.facets.entryText"></seco-jena-text-facet>  --\x3e <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-slider-facet data-options="vm.facets.slider"></seco-slider-facet> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.keywords"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.author"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.title"></seco-basic-facet> <seco-hierarchy-facet data-options="vm.facets.place"></seco-hierarchy-facet> <seco-hierarchy-facet data-options="vm.facets.deathplace"></seco-hierarchy-facet> </div> </div>'),e.put("views/network.html",'<div class="container-fluid" style="overflow: hidden; height: 100%"> <div class="row" style="display: flex; height: 900px"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3" style="overflow-y: auto"> <div ng-include="\'views/description.network.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="networkcontainer" class="container fill"></div> <div class="cytolegend"> <div class="well well-sm" ng-if="vm.showlegend"> <br> <p ng-if="vm.legend" ng-repeat="item in vm.legend"> <span class="legenddot" style="background-color: {{item.color}}"></span> {{item.label}} </p> </div> </div> \x3c!-- popover not used here because it prevents the nodes of being dragged\n\t\t\t<span class="pop-availability personlink" ng-if="vm.popover" ng-style="{\'top\': vm.popy,\'left\': vm.popx}"  url="{{ vm.current }}">\n\t\t\t\t<img src="images/empty80.png"></img>\n\t\t\t</span>\n\t\t\t --\x3e </div> </div> </div>'),e.put("views/nlp/comparison.html",'<div class="row"> <div class="col-sm-6 comparison comparison-left" ui-view="left"></div> <div class="col-sm-6 comparison comparison-right" ui-view="right"></div> </div>'),e.put("views/nlp/comparison.left.html",'<div class="row"> <div class="col-sm-4"> <span><b>Näkymä:</b> <a ui-sref-active="active" ui-sref="nlp.statistics">Tilastoja</a> | <a ui-sref-active="active" ui-sref="nlp.comparison.sides">Vertailu</a> </span> <br><br> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/nlp/results.partial.comparison.html\'"></div> </div> </div>'),e.put("views/nlp/comparison.right.html",'<div class="row"> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/nlp/results.partial.comparison.html\'"></div> </div> <div class="col-sm-4"> <div ng-include="\'views/facets.partial.html\'"></div> </div> </div>'),e.put("views/nlp/nlp.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>'),e.put("views/nlp/results.bottom.category.partial.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> {{ vm.error.statusText }} </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption>Lyhyimmät tekstit: keskimääräinen sanamäärä toimialan mukaan</caption> <colgroup> <col class="name"> <col class="count"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <th>Lkm</th> <tr ng-repeat="obj in vm.resultsBotCat"> <td>{{ obj.category }}</td> <td>{{ obj.count }}</td> <td>{{ obj.lkm }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.bottom.partial.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> {{ vm.error.statusText }} </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption style="margin-top: 20px">Lyhyimmät biografiset tekstit</caption> <colgroup> <col class="name"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <tr ng-repeat="obj in vm.resultsBottom10"> <td><span class="personlink" url="{{ obj.id }}">{{ obj.name }}</span></td> <td>{{ obj.cnt }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.partial.comparison.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> {{ vm.error.statusText }} </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" ng-repeat="upos in vm.upos"> <table class="comparison-results"> <colgroup> <col class="word"> <col class="count"> </colgroup> <th>{{ upos.label }}</th> <th>Kaikki </th> <tr ng-repeat="word in vm.results[upos.key]"> <td>{{ word.lemma }}</td> <td>{{ word.percentage }} % </td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.partial.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> {{ vm.error.statusText }} </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" ng-repeat="upos in vm.upos"> <table class="comparison-results"> <colgroup> <col class="word"> <col class="count"> <col class="pos_count"> </colgroup> <th>{{ upos.label }}</th> <th>Sanaluokka </th> <th>Kaikki </th> <tr ng-repeat="word in vm.results[upos.key]"> <td>{{ word.lemma }}</td> <td>{{ word.class_percentage }} %</td> <td>{{ word.percentage }} %</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.top.category.partial.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption>Pisimmät tekstit: keskimääräinen sanamäärä toimialan mukaan</caption> <colgroup> <col class="name"> <col class="count"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <th>Lkm</th> <tr ng-repeat="obj in vm.resultsTopCat"> <td>{{ obj.category }}</td> <td>{{ obj.count }}</td> <td>{{ obj.lkm }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/results.top.partial.html",'<div ng-show="vm.error" class="comparison-result-error alert alert-danger" role="alert"> </div> <div ng-show="vm.hasResults()" class="col-md-3 col-sm-2" style="width:50%"> <table class="comparison-results"> <caption style="margin-top: 20px">Pisimmät biografiset tekstit</caption> <colgroup> <col class="name"> <col class="count"> </colgroup> <th>Biografia</th> <th>Sanamäärä</th> <tr ng-repeat="obj in vm.resultsTop10"> <td><span class="personlink" url="{{ obj.id }}">{{ obj.name }}</span></td> <td>{{ obj.cnt }}</td> </tr> </table> </div> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/nlp/statistics.html",'<div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/description.npl.partial.html\'"></div> <span><b>Näkymä:</b> <a ui-sref-active="active" ui-sref="nlp.statistics">Tilastoja</a> | <a ui-sref-active="active" ui-sref="nlp.comparison.sides">Vertailu</a> </span> <br><br> \x3c!--div ng-include="\'views/facets.partial.html\'"></div--\x3e <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="biography-chart"></div> <div id="biography-len-chart"></div> <div class="row list-row"> <div id="biography-top-best" ng-include="\'views/nlp/results.top.partial.html\'"></div> <div id="biography-top-bottom" ng-include="\'views/nlp/results.bottom.partial.html\'"></div> </div><div class="row list-row"> <div id="biography-cat-best" ng-include="\'views/nlp/results.top.category.partial.html\'"></div> <div id="biography-cat-bottom" ng-include="\'views/nlp/results.bottom.category.partial.html\'"></div> </div> <div class="row" style="margin-top: 20px"> <div class="row mt-3"><div ng-include="\'views/nlp/results.partial.html\'"></div></div> </div>'),e.put("views/person.sentences.html",'<div class="container-fluid"> <div class="row"> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center"> <h1>{{ vm.label }}</h1> <div class="container-fluid thumbnail"> <div> <div class="col-md-4 pull-md-4 col-lg-3 text-left"> <h1>Tutki henki&shy;löön liit&shy;tyvää verkostoa</h1> <p> Sivulla näytetään havainnekuva henkilöön liittyvästä verkostosta. Linkitys on luotu biografiakuvausten viittausten perusteella. </p> </div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> </div> </div> </div> </div> </div>'),e.put("views/person/detail.html",'<div class="col-sm-12 col-md-8 text-center"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <h1>{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="thumbnail" ng-show="vm.person"> <div class="person-profile-img"> <div class="row"> <div class="col-sm-12 text-center"> <img ng-repeat="img in vm.person.images" class="person-img img img-responsive" ng-src="{{ img }}" uib-tooltip="Kuvalähde: {{ vm.person.imagesources[$index] }}" tooltip-enable="{{ !!vm.person.imagesources[$index] }}" tooltip-placement="bottom"> </div> </div> </div> <div class="caption" ng-show="vm.person"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12"> <p ng-if="(vm.person.birthPlace || vm.person.birthDate || vm.person.deathDate)"> <span ng-if="(vm.person.birthPlace || vm.person.birthDate)">&#8727;&nbsp;{{ vm.person.birthPlace | castArray | join:\', \' }} {{ vm.person.birthDate }}</span> <span ng-if="(vm.person.deathPlace || vm.person.deathDate)">&dagger;&nbsp;{{ vm.person.deathPlace | castArray | join:\', \' }}</span> <span ng-if="vm.person.deathDate">{{ vm.person.deathDate }}</span> </p> </div> <div ng-if="vm.person.occupation" class="col-xs-12"> <p>{{ vm.person.occupation | castArray | join:\', \' }}</p> </div> <div ng-if="vm.person.source" class="col-xs-12"> <p>Lähteet: {{ vm.person.source | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a title="Data ldf.fi-palvelussa" class="" ng-href="{{ vm.person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="vm.person.wikipedia" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.wikipedia }}">Wikipedia</a> </div> <div ng-if="vm.person.wikidata" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.wikidata }}">Wikidata</a> </div> <div ng-if="vm.person.fennica.length>1" class="col-xs-6 col-xs-offset-3"> Fennica <a ng-repeat="f in vm.person.fennica" ng-href="{{ f }}">[{{$index+1}}] </a> </div> <div ng-if="vm.person.fennica.length<2" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.fennica[0] }}">Fennica</a> </div> <div ng-if="vm.person.warsampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ vm.person.warsampo }}">Sotasampo</a> </div> <div ng-if="vm.person.kirjasampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="vm.person.kulttuurisampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.kulttuurisampo }}">Kulttuurisampo</a> </div> <div ng-if="vm.person.blf" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.blf }}">Biografiskt lexikon för Finland</a> </div> <div ng-if="vm.person.ulan" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.ulan }}">ULAN</a> </div> <div ng-if="vm.person.viaf" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.viaf }}">VIAF</a> </div> <div ng-if="vm.person.eduskunta" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.eduskunta }}">Eduskunta</a> </div> <div ng-if="vm.person.norssi" class="col-xs-6 col-xs-offset-3"> <a ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ vm.person.norssi }}">Norssi</a> </div> <div ng-if="vm.person.website" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.website }}">Kotisivu</a> </div> <div ng-if="vm.person.genicom || vm.person.genitree" class="col-xs-6 col-xs-offset-3"> <span>Geni.com: </span><a ng-href="{{ vm.person.genicom }}">Kotisivu</a> <a ng-href="{{ vm.person.genitree }}">Sukupuu</a> </div> <div ng-if="vm.person.yo1853" class="col-xs-6 col-xs-offset-3"> <a ng-href="https://ylioppilasmatrikkeli.helsinki.fi/1853-1899/henkilo.php?id={{ vm.person.yo1853 }}">Ylioppilasmatrikkeli 1853–1899</a> </div> </div> \x3c!-- \n            <div class="col-sm-6 col-md-12" ng-if="false && vm.person.bios && vm.person.bios.length" ng-repeat="bio in vm.person.bios | castArray">\n            \t<div ng-if="bio.database" class="entry-text text-left icon-menu">\n\t              <hr />\n\t              \n\t              \t<h4>{{ bio.database }} <a ng-if="bio.link" title="Artikkeli Biografiakeskuksen sivulla" ng-href="{{ bio.link }}">\n\t              \t<span class="glyphicon glyphicon-book" aria-hidden="true"></span>\n\t              \t</a></h4>\n\t              \n\t            </div>\n            \t<div ng-if="bio.lead_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <p ng-bind-html="bio.lead_paragraph"></p>\n\t            </div>\n\t            <div ng-if="bio.description" class="entry-text text-left">\n\t              <hr />\n\t              <p ng-bind-html="bio.description"></p>\n\t            </div>\n\t            \n\t            <div ng-if="bio.family_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <p>{{ bio.family_paragraph }}</p>\n\t            </div>\n\t            \n\t             <div ng-if="bio.parent_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <h4>Vanhemmat</h4>\n\t              <p>{{ bio.parent_paragraph }}</p>\n\t            </div>\n\t            <div ng-if="bio.spouse_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <h4>Puoliso(t) vanhempineen</h4>\n\t              <p>{{ bio.spouse_paragraph }}</p>\n\t            </div>\n\t            <div ng-if="bio.child_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <h4>Lapset</h4>\n\t              <p>{{ bio.child_paragraph }}</p>\n\t            </div>\n\t            \n\t            <div ng-if="bio.medal_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <h4>Kunniamerkit</h4>\n\t              <p>{{ bio.medal_paragraph }}</p>\n\t            </div>\n\t            \n\t            <div ng-if="bio.source_paragraph" class="entry-text text-left">\n\t              <hr />\n\t              <p ng-bind-html="bio.source_paragraph"></p>\n\t            </div>\n\t            \n\t            <div class="entry-text text-left">\n\t            \t<hr />\n\t            \t<span ng-if="bio.author_text">Kirjoittaja(t): {{ bio.author_text }}</span>\n\t            \t<span ng-if="bio.created">Julkaistu {{ bio.created | date:\'dd.MM.yyyy\' }}</span>\n\t            \t<span ng-if="bio.modified">(päivitetty {{ bio.modified | date:\'dd.MM.yyyy\' }})</span>\n\t            </div>\n\t            <hr />\n            </div>\n            --\x3e </div> </div> </div> <div class="col-sm-6 col-md-12 text-left" ng-if="(vm.person) && !vm.person.bios"> <br> <h4>Henkilöllä ei ole biografiakuvauksia</h4> <hr> </div> <div class="col-sm-6 col-md-12 text-left thumbnail" ng-if="vm.person.bios && vm.person.bios.length"> <ul class="nav nav-tabs"> <li ng-repeat="bio in vm.person.bios | castArray" ng-class="{ active: vm.isSet($index) }"> <a href ng-click="vm.setTab($index)"><span class="glyphicon glyphicon-book" aria-hidden="true"></span><span style="font-size: 120%"> {{ bio.database }}</span></a> </li> <li ng-repeat="link in vm.person.externalLinks | castArray" ng-class="{ active: vm.isSet(link.label) }"> <a href ng-click="vm.setTab(link.label)">{{ link.label }}</a> </li> </ul> <nbf-biography ng-repeat="bio in vm.person.bios | castArray" ng-show="vm.isSet($index)" url="{{bio.bio}}" active="{{vm.isSet($index)}}"> </nbf-biography> \x3c!-- \n         \t<nlp-biography ng-repeat="bio in vm.person.bios | castArray" ng-show="vm.isSet($index)" url="{{bio.prs}}" active="{{vm.isSet($index)}}">\n         \t</nlp-biography>\n         \t --\x3e <nbf-iframe ng-repeat="link in vm.person.externalLinks | castArray" ng-show="vm.isSet(link.label)" url="{{link.url}}" active="{{vm.isSet(link.label)}}"> </nbf-iframe> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.relative && vm.person.relative.length"> <div class="relativeblock"> <h3>Lähisukulaiset</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilön sukulaisissa näytetään vanhemmat, puolisot ja lapset, ei kaukaisempia sukulaisia."> </span> </div> <div class="col-sm-6" ng-repeat="relative in vm.person.relative"> {{ relative.type }} <personlink url="{{ relative.id2 }}">{{ relative.name }}</personlink> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.similar"> <div class="relativeblock"> <h3>Samankaltaisia henkilöitä</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöt on määritelty samankaltaisiksi vertaamalla laskennallisesti heidän biografiakuvauksien sanastoa."> </span> </div> <img ng-if="!vm.person.similar" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in vm.person.similar"> <nbf-person url="{{ person.prs }}"></nbf-person> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.referenced"> <div class="relativeblock"> <h3>T&auml;nne viittaavat sivut</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Henkilöitä joiden biografioista viitataan tälle sivulle."> </span> </div> <img ng-if="!vm.person.referenced" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in vm.person.referenced"> <nbf-person url="{{ person.id.url }}"></nbf-person> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.authors"> <div class="relativeblock"> <h3>Kirjoittajat</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Tutustu biografiakuvauksen laatijoihin."> </span> </div> <img ng-if="!vm.person.authors" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in vm.person.authors"> <nbf-person url="{{ person.author.url }}"></nbf-person> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.sameAuthor"> <div class="relativeblock"> <h3>Samoilta kirjoittajilta</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Lue muita biografia-artikkeleja samoilta kirjoittajilta."> </span> </div> <img ng-if="!vm.person.sameAuthor" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in vm.person.sameAuthor"> <nbf-person url="{{ person.id.url }}"></nbf-person> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.authoredBios"> <div class="relativeblock"> <h3>Kirjoitettuja artikkeleja</h3> <span class="glyphicon glyphicon-info-sign" uib-tooltip="Lue tämän henkilön laatimia biografia-artikkeleja."> </span> </div> <img ng-if="!vm.person.authoredBios" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in vm.person.authoredBios"> <nbf-person url="{{ person.id.url }}"></nbf-person> </div> </div>  '),e.put("views/person/map.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div class="container-fluid text-center"> <h1 ng-show="vm.person">{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="container-fluid thumbnail"> <div> <div id="labelcontainer" class="col-md-4 pull-md-4 col-lg-3"> <h1>Tutki henki&shy;löön liit&shy;tyviä tapah&shy;tumia</h1> <span> Sivulla näytetään lista henkilöön liittyvistä tapahtumista, niihin liittyvät paikat kartalla sekä tapahtumasarja aikajanalla. Tapahtumat on poimittu biografiakuvausten tekstikentistä. </span> <br><br> <div uib-alert ng-if="vm.error" style="color:red"> {{ vm.error }} </div> <p ng-show="vm.person" ng-repeat="event in ::vm.events" class="{{event.class}}" ng-mouseenter="vm.focusEvent(event)" ng-mouseleave="vm.unfocusEvent(event)"> {{$index+1}}: <span ng-if="::event.relative" class="personlink" url="{{ ::event.relative }}">{{ event.label }}</span> <span ng-if="::!event.relative">{{ ::event.label }}</span> </p> </div> </div> <div ng-show="vm.person" class="col-md-8 col-lg-9 text-center"> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom"> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options"></ui-gmap-marker> </ui-gmap-google-map> <svg id="timelinecontainer" viewbox="-15,-7,120,27" preserveaspectratio="none" version="1.0" x="0" y="0" width="900" height="180" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <line ng-repeat="line in ::vm.mainline.lines" ng-attr-x1="{{ line.x1 }}" ng-attr-x2="{{ line.x2 }}" ng-attr-y1="{{ line.y1 }}" ng-attr-y2="{{ line.y2 }}"> </line> <text ng-repeat="text in ::vm.mainline.texts" ng-attr-x="{{ text.x }}" ng-attr-y="{{ text.y }}"> {{ text.content }} </text> <path ng-repeat="event in vm.events" ng-mouseenter="vm.focusEvent(event)" ng-mouseleave="vm.unfocusEvent(event)" class="{{ ::event.class }}" ng-attr-d="{{ ::event.path }}"> </path> </svg> <p> <span>{{ vm.currentEvent }}</span> </p> </div> </div> </div> </div> </div>'),e.put("views/person/network.html",'<div class="container-fluid"> <div class="row"> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center"> <h1>{{ vm.label }}</h1> <div class="container-fluid thumbnail" style="height: 900px"> <div> <div class="col-md-4 pull-md-4 col-lg-3 text-left"> <h1>Tutki henki&shy;löön liit&shy;tyvää verkostoa</h1> <p> Sivulla näytetään havainnekuva henkilöön liittyvästä verkostosta. Linkitys on luotu biografiakuvausten viittausten perusteella. </p> <p> Verkoston solmuja voidaan siirtää hiirellä. Solmuja klikkaamalla pääset tarkastelemaan verkostoa valitun henkilön ympärillä. Alapuoleisilla valikoilla voidaan säätää verkoston laajuutta ja ulkoasua. </p> <div class="well well-sm"> <p style="color:{{vm.messagecolor}}">{{ vm.message }}</p> <p> Näytä verkostossa korkeintaan <select ng-model="vm.searchlimit" ng-options="item.label for item in vm.LIMITOPTIONS" ng-change="vm.changelimit()"> </select> henkilöä. </p> <p> Solmujen koko: <select ng-model="vm.sizeoption" ng-options="item.value for item in vm.SIZEOPTIONS" ng-change="vm.changesize()"> </select> <span ng-if="vm.sizeoption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.sizeoption.tooltip}}" tooltip-placement="right"></span> </p> <p> Solmujen väri: <select ng-model="vm.coloroption" ng-options="item.value for item in vm.COLOROPTIONS" ng-change="vm.changecolor()"> </select> <span ng-if="vm.coloroption.tooltip" class="glyphicon glyphicon-info-sign tooltip-info" uib-tooltip="{{vm.coloroption.tooltip}}" tooltip-placement="right"></span> </p> </div> </div> </div> <div class="col-md-8 col-lg-9 text-center thumbnail" style="height: 900px"> <div class="col-sm-12" ng-show="vm.loading"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div id="networkcontainer" class="container fill"></div> <div class="cytolegend"> <div class="well well-sm" ng-if="vm.showlegend"> <br> <p ng-if="vm.legend" ng-repeat="item in vm.legend"> <span class="legenddot" style="background-color: {{item.color}}"></span> {{item.label}} </p> </div> </div> \x3c!-- popover not used here because it prevents the nodes of being dragged\n\t\t\t<span class="pop-availability personlink" ng-if="vm.popover" ng-style="{\'top\': vm.popy,\'left\': vm.popx}"  url="{{ vm.current }}">\n\t\t\t\t<img src="images/empty80.png"></img>\n\t\t\t</span>\n\t\t\t --\x3e </div> </div> </div> </div> </div>'),e.put("views/person/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="person.detail" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Henkilön tiedot</a> </li> <li ui-sref="person.map" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Kartta ja aikajana</a> </li> <li ui-sref="person.network" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Verkosto</a> </li> <li ui-sref="person.sentence" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Lauseet</a> </li> </ul> </div> </div> <div class="row"> <div ui-view></div> </div> </div>'),e.put("views/personTooltipTemplate.html",'<div> <p>{{ label }}<br>{{ lifespan }}</p> <img ng-if="!image" height="120" class="person-img img" src="images/person_placeholder.cd371769.svg"> <img ng-if="!!image" height="120" class="person-img img" src="{{ image }}"> </div>'),e.put("views/persongroupTooltipTemplate.html",'<div> <p>{{ person.label }}<br>{{ person.lifespan }}</p> <img ng-if="!person.image" height="120" class="person-img img" src="images/person_placeholder.cd371769.svg"> <img ng-if="!!person.image" height="120" class="person-img img" src="{{ person.image }}"> </div>'),e.put("views/place.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>{{ vm.place.label }}</h1> </div> </div> <div class="col-md-8"> <div id="linkContent"> <ws-related-links data-title="\'Syntyneet\'" data-related="vm.place.born"></ws-related-links> <ws-related-links data-title="\'Tapahtumat\'" data-related="vm.place.event"></ws-related-links> <ws-related-links data-title="\'Kuolleet\'" data-related="vm.place.died"></ws-related-links> </div> </div> </div>'),e.put("views/popup.html",'<div class="modal-header"> <h3>{{ ::vm.popuptitle }}</h3> <nbf-persongroup url="{{ vm.people }}"></nbf-persongroup> </div>'),e.put("views/portal.html",'<!DOCTYPE html> <html lang="fi"> <head> \x3c!-- \r\n  //\tNOTE: this functionality moved to scripts/portal.controller.js\r\n  \r\n  <script src="../scripts/front-page.js"><\/script>\r\n  <title></title>\r\n  <meta charset="utf-8" />\r\n  <meta name="viewport" content="width=device-width, initial-scale=1" />\r\n   <meta name="google-site-verification" content="yC4ofDhxNJ_sXh8xCtC7RxpxGtbTdTxavHmkx9aaTJ4" />\r\n\r\n  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">\r\n  \r\n  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"><\/script>\r\n  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"><\/script>\r\n   \r\n  <script type="application/ld+json">\r\n    {\r\n      "@context": "http://schema.org",\r\n      "@type": "WebSite",\r\n      "url": "https://www.sotasampo.fi",\r\n      "name": "Sotasampo",\r\n      "alternateName": "WarSampo",\r\n      "sameAs": [\r\n        "https://www.wikidata.org/entity/Q28942343",\r\n        "https://www.facebook.com/groups/sotasampo"\r\n      ]\r\n    }\r\n  <\/script>\r\n\r\n  <script>\r\n    if (window.location.host === \'www.sotasampo.fi\') {\r\n      (function(i,s,o,g,r,a,m){i[\'GoogleAnalyticsObject\']=r;i[r]=i[r]||function(){\r\n      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\r\n      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\r\n      })(window,document,\'script\',\'https://www.google-analytics.com/analytics.js\',\'ga\');\r\n\r\n      ga(\'create\', \'UA-12724615-12\', \'auto\');\r\n      ga(\'send\', \'pageview\');\r\n    }\r\n<\/script>\r\n<script>\r\n  \t$(document).ready(function(){\r\n  \t\t$("#nav").load("page-templates/navbar-fi.html.partial");\r\n    \t$("#footer").load("views/footer.html.partial") \r\n\t\t}) \r\n<\/script>\r\n  --\x3e </head> <body> <div class="wrapper"> <noscript><div class="alert alert-danger text-center"> <h3>Sovellus vaatii toimiakseen JavaScriptin. The application requires JavaScript to function.</h3> </div></noscript> \x3c!--  CONTAINER --\x3e <div class="container"> \x3c!--  HEADER --\x3e \x3c!-- \r\n<div id="nav"></div>\r\n<img src = "css/bios.png" height="50px"><img src = "css/bios.png" height="50px"> <img src = "css/bios.png" height="50px"><img src = "css/bios.png" height="50px">      \r\n --\x3e \x3c!--  JUMBO --\x3e <div id="jumbo" class="jumbotron"> <div class="row"> <div class="col-md-10"> <noscript><h1>Suomen suku</h1> <p>Semanttinen kansallisbiografia</p></noscript> <h1 id="jumboTitle">{{ ::vm.strings["jumboTitle"] }}</h1> <p id="jumboSubtitle">{{ ::vm.strings["jumboSubtitle"] }}</p> </div> </div> </div> \x3c!-- Jumbotron --\x3e <div class="row"> <div class="col-md-12"> <p id="generalDesc"> {{ ::vm.strings["generalDesc"] }} (<a data-toggle="modal" data-target="#myModal" href="#">{{ ::vm.strings["ins"] }}</a>)</p> <noscript><p>Portaalilla voi hakea, selata ja visualisoida laajoja tietoaineistoja Suomen historiallisista henkilöistä.</p> <p><b>Salli JavaScript käyttääksesi Suomen sukua. Please enable JavaScript to use Semantic Biography of Finland.</b></p></noscript> <p><a href="https://www.facebook.com/groups/sotasampo/"><img src="images/FB-f-Logo__blue_29.cec1afed.png"> <span id="followFacebook">{{ ::vm.strings["followFacebook"] }}</span></a></p> </div> </div> <div class="row"> <div class="col-md-12"> <hr> <h3 id="choosePerspective">{{ ::vm.strings["choosePerspective"] }}</h3> \x3c!-- PERSPECTIVES --\x3e <div class="row"> <a id="events" class="col-md-4 pers-link" ui-sref="search.cards"> <div class="persbox" id="nav-events"> <h4 id="searchH">{{ ::vm.strings["searchH"] }}</h4> <p id="searchP">{{ ::vm.strings["searchP"] }}</p> </div> </a> <a id="maps" class="col-md-4 pers-link" ui-sref="maps.singleview"> <div class="persbox" id="nav-maps"> <h4 id="mapsH">{{ ::vm.strings["mapsH"] }}</h4> <p id="mapsP">{{ ::vm.strings["mapsP"] }}</p> </div> </a> <a id="statistics" class="col-md-4 pers-link" ui-sref="visu.statistics"> <div class="persbox" id="nav-statistics"> <h4 id="statisticsH">{{ ::vm.strings["statisticsH"] }}</h4> <p id="statisticsP">{{ ::vm.strings["statisticsP"] }}</p> </div> </a> <a id="networks" class="col-md-4 pers-link" ui-sref="network"> <div class="persbox" id="nav-networks"> <h4 id="networksH">{{ ::vm.strings["networksH"] }}</h4> <p id="networksP">{{ ::vm.strings["networksP"] }}</p> </div> </a> <a id="relations" class="col-md-4 pers-link"> <div class="persbox" id="nav-relations"> <h4 id="relationsH">{{ ::vm.strings["relationsH"] }}</h4> <p id="relationsP">{{ ::vm.strings["relationsP"] }}</p> </div> </a> <a id="language" class="col-md-4 pers-link" ui-sref="nlp.statistics"> <div class="persbox" id="nav-language"> <h4 id="casultiesH">{{ ::vm.strings["casultiesH"] }}</h4> <p id="casultiesP">{{ ::vm.strings["casultiesP"] }}</p> </div> </a> </div> </div> <div class="push"></div> </div> \x3c!-- container --\x3e </div> \x3c!-- wrapper --\x3e \x3c!--   FOOTER     --\x3e <div id="footer"> <footer class="footer"> <div class="container-fluid" height="100px"> <hr> <a href="https://seco.cs.aalto.fi" style="border:0px"> <img id="seco" alt="Semantic Computing Research Group" src="https://www.ldf.fi/img/seco-logo.png" style="height:50px;padding-right:30px; border:none"></a> <a href="https://www.aalto.fi/en/"> <img id="aalto" alt="Aalto University" src="https://www.ldf.fi/img/aalto-logo.png" style="height:50px; padding-right:30px; padding-bottom:5px; border:none"></a> <a href="http://www.heldig.fi/"> <img id="heldig" alt="HELDIG - Helsinki Centre for Digital Humanities" src="http://www.ldf.fi/img/bio/heldig-text.jpg" style="height:50px; padding-right:30px; border:none"></a> <a href="https://www.finlit.fi/"> <img id="sks" alt="Finnish Literature Society" src="https://www.ldf.fi/img/sks.jpg" style="height:50px; padding-right:30px; border:none"></a> </div> </footer> </div> </div></body> </html>'),e.put("views/profile-image-popover.html",'<div> <img class="img img-responsive" ng-src="{{ img }}"> </div>'),e.put("views/search/cards.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/search/description.partial.html\'"></div> <br> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <br><b>Järjestä:</b> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/search/cards.partial.html\'"></div> </div> </div> </div>'),e.put("views/search/cards.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div infinite-scroll="vm.nextPage()" infinite-scroll-disabled="vm.isScrollDisabled()" infinite-scroll-distance="0"> <div class="row"> <div ng-repeat="person in vm.people" class="person-container"> <div class="col-xs-12 col-sm-12 person-panel col-md-4 col-lg-3"> <div class="thumbnail"> <a ui-sref="person.detail({ personId: person.id })"> <div class="person-profile-img vertical-center"> <img class="img img-responsive center-block media-middle" ng-src="{{ ::person.images | first }}"> </div> </a> <div class="caption"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12 col-sm-3 col-md-12"> <b><a ui-sref="person.detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b> </div> <div class="col-xs-12 col-sm-9 col-md-12"> <p ng-if="::(person.birthPlace || person.birthDate || person.deathDate)"> &#8727;&nbsp;<span ng-if="::person.birthPlace">{{ ::person.birthPlace | castArray | join:\', \' }}</span> {{ ::person.birthDate }} <span ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace | castArray | join:\', \' }}&nbsp;{{ ::person.deathDate }}</span> </p> </div> <div ng-if="::person.occupation" class="col-xs-12"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a title="Näytä matrikkeliteksti" ng-attr-title="{{ showText ? \'Piilota matrikkeliteksti\' : \'Näytä matrikkeliteksti\' }}" href="" ng-click="showText = !showText"><span class="glyphicon" ng-class="{ \'glyphicon-collapse-down\': !showText, \'glyphicon-collapse-up\': showText }" aria-hidden="true"></span></a> <a title="Artikkeli Kansallisbiografian sivustolla" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data ldf.fi-palvelussa" class="" ng-href="{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="::person.hasAchievements" class="col-xs-6"> <a href="" class="link" ng-click="vm.getAchievements(person)" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto right">Saavutukset</a> </div> <div ng-if="::person.wikipedia" class="col-xs-6"> <a ng-href="{{ ::person.wikipedia }}">Wikipedia</a> </div> <div ng-if="::person.wikidata" class="col-xs-6"> <a ng-href="{{ ::person.wikidata }}">Wikidata</a> </div> <div ng-if="::person.fennica[0]" class="col-xs-6"> <a ng-href="{{ ::person.fennica[0] }}">Fennica</a> </div> <div ng-if="::person.fennica[1]" class="col-xs-6"> <a ng-href="{{ ::person.fennica[1] }}">Fennica (2)</a> </div> <div ng-if="::person.warsampo" class="col-xs-6"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsampo }}">Sotasampo</a> </div> <div ng-if="::person.norssi" class="col-xs-6"> <a ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ ::person.norssi }}">Norssi</a> </div> <div ng-if="::person.kirjasampo" class="col-xs-6"> <a ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="::person.blf" class="col-xs-6"> <a ng-href="{{ ::person.blf }}">BLF</a> </div> <div ng-if="::person.ulan" class="col-xs-6"> <a ng-href="{{ ::person.ulan }}">ULAN</a> </div> <div ng-if="::person.viaf" class="col-xs-6"> <a ng-href="{{ ::person.viaf }}">VIAF</a> </div> <div ng-if="::person.norssit" class="col-xs-6"> <a ng-href="{{ ::person.norssit }}">Norssit</a> </div> <div ng-if="::person.eduskunta" class="col-xs-6"> <a ng-href="{{ ::person.eduskunta }}">Eduskunta</a> </div> <div ng-if="::person.website" class="col-xs-6"> <a ng-href="{{ ::person.website }}">Kotisivu</a> </div> <div ng-if="::person.genicom" class="col-xs-6"> <a ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> </div> <div ng-if="::person.genitree" class="col-xs-6"> <a ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </div> </div> <div ng-if="::person.relative" class="row"> <div class="col-xs-12">Sukulaiset:</div> <div class="col-sm-6 col-md-12" ng-repeat="relative in person.relative | castArray"> {{ ::relative.type }} <a ui-sref="person.detail({ personId: relative.id })">{{ ::relative.name }}</a> </div> </div> <div ng-if="::person.hobby" class="row"> <div class="col-md-12"> <p>Harrastukset: {{ ::person.hobby | castArray | join: \', \' }}</p> </div> </div> <div uib-collapse="!showText"> <hr> <p ng-bind-html="::person.lead_paragraph"></p> </div> </div> </div> </div> </div> <div class="clearfix visible-lg-block" ng-if="($index + 1) % 4 == 0"></div> <div class="clearfix visible-md-block" ng-if="($index + 1) % 3 == 0"></div> <div class="clearfix visible-sm-block" ng-if="($index + 1) % 1 == 0"></div> <div class="clearfix visible-xs-block" ng-if="($index + 1) % 1 == 0"></div> </div> </div> </div>'),e.put("views/search/description.partial.html","<h1>Hae ja selaa</h1> <p> Rajaa elämäkertoja tekemällä valintoja alla olevista suodattimista. Valitse sitten elämäkerta luettavaksi. </p>"),e.put("views/search/table.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK --\x3e <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/search/description.partial.html\'"></div> <br> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <br><b>Järjestä:</b> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/search/table.partial.html\'"></div> </div> </div> </div>'),e.put("views/search/table.partial.html",'<table class="table table-striped norssi-table ng-table-responsive" ng-table="vm.tableParams"> <thead> <tr> <th class="col-xs-4">Nimi</th> <th class="col-xs-1">Henkilö</th> <th class="col-xs-1">Linkit</th> <th class="col-xs-3 hidden-xs hidden-sm">Matrikkeliteksti</th> </tr> </thead> <tbody> <tr ng-show="!vm.isLoadingResults" ng-repeat="person in $data"> <td class="person-image-container" data-title="\'Nimi\'"> <div ng-class="::{ \'name-col col-md-12 col-lg-7\': person.images }"> <b><a ui-sref="person.detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b><br> <span ng-if="::person.birthDate">&#8727;&nbsp;{{ ::person.birthPlace }} {{ ::person.birthDate }}</span> <span ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace }} {{ ::person.deathDate }}</span> <br> <span class="icon-menu"> <a title="Kansallisbiografia" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </span> </div> <div ng-if="::person.images" class="name-col col-md-12 col-lg-5"> <div ng-repeat="img in ::person.images" ng-class="{ \'col-md-12\': ($first && $last), \'col-sm-6\': !($first && $last) }" class="person-img-col vcenter"> <img uib-popover-template="\'views/profile-image-popover.html\'" popover-trigger="\'mouseenter\'" popover-placement="auto right" popover-append-to-body="true" class="person-image img img-responsive" ng-src="{{ img  }}"> </div> </div> </td> <td class="links" data-title="\'Henkilö\'"> <div ng-if="::person.occupation" class="hidden-xs hidden-sm"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> </td> <td class="links" data-title="\'Linkit\'"> <div ng-if="::person.achievement"> <a href="" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto top">Saavutukset</a> </div> <a class="link" ng-if="::person.wikipedia" ng-href="{{ ::person.wikipedia }}">Wikipedia</a> <a class="link" ng-if="::person.warsa" ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsa }}">Sotasampo</a> <a class="link" ng-if="::person.fennica[0]" ng-href="{{ ::person.fennica[0] }}">Fennica</a> <a class="link" ng-if="::person.fennica[1]" ng-href="{{ ::person.fennica[1] }}">Fennica (2)</a> <a class="link" ng-if="::person.kirjasampo" ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> <a class="link" ng-if="::person.kulttuurisampo" ng-href="{{ ::person.kulttuurisampo }}">Kulttuurisampo</a> <a class="link" ng-if="::person.blf" ng-href="{{ ::person.blf }}">BLF</a> <a class="link" ng-if="::person.ulan" ng-href="{{ ::person.ulan }}">ULAN</a> <a class="link" ng-if="::person.viaf" ng-href="{{ ::person.viaf }}">VIAF</a> <a class="link" ng-if="::person.norssi" ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ ::person.norssi }}">Norssi</a> <a class="link" ng-if="::person.eduskunta" ng-href="{{ ::person.eduskunta }}">Eduskunta</a> <a class="link" ng-if="::person.website" ng-href="{{ ::person.website }}">Kotisivu</a> <a class="link" ng-if="::person.genicom" ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> <a class="link" ng-if="::person.genitree" ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </td> \x3c!-- \n    <td data-title="\'Muuta\'">\n      <div ng-if="::person.relative">\n      \t<span>Sukulaiset: </span><br>\n      \t<span ng-repeat="relative in person.relative | castArray">\n          {{ ::relative.type }} <a ui-sref="person.detail({ personId: relative.id })">{{ ::relative.name }}</a>\n      \t</span>\n      </div>\n      <div ng-if="::person.hobby"><span>Harrastukset: </span><br>{{ ::person.hobby | join:\', \' }}</div>\n    </td>\n     --\x3e <td data-title="\'Matrikkeliteksti\'" class="hidden-xs hidden-sm"><p ng-bind-html="::person.lead_paragraph"></p></td> </tr> </tbody> </table> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),e.put("views/search/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="search.cards" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-th" aria-hidden="true"></span> Ruudukko</a> </li> <li ui-sref="search.table" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span> Lista</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/sliderFacet.directive.html",'<seco-facet-wrapper> <rzslider rz-slider-model="vm.facet.slider.minValue" rz-slider-high="vm.facet.slider.maxValue" rz-slider-options="vm.facet.slider.options"></rzslider> </seco-facet-wrapper>'),e.put("views/subnavbar.html",'<ul class="nav navbar-nav"> \x3c!-- \n  <li><a href="" id="show-help" ng-click="vm.showHelp()"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Ohje</a></li>\n   --\x3e <li class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href=""> Näkymät<span class="caret"></span></a> <ul class="dropdown-menu"> \x3c!-- \n      <li ui-sref-active="active"><a ui-sref="portal"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Etusivu</a></li>\n     --\x3e <li ui-sref-active="{ active: \'search.**\' }"><a ui-sref="search.cards"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Hae ja selaa</a></li> <li ui-sref-active="{ active: \'maps.**\' }"><a ui-sref="maps.singleview"><span class="glyphicon glyphicon glyphicon-globe" aria-hidden="true"></span> Kartat</a></li> <li ui-sref-active="{ active: \'visu.**\' }"><a ui-sref="visu.statistics"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Tilastot</a></li> <li ui-sref-active="{ active: \'network\' }"><a ui-sref="network"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Verkostoanalyysi</a></li> <li ui-sref-active="active"><a ui-sref="#"><span class="glyphicon glyphicon-retweet" aria-hidden="true"></span> Yhteyshaku</a></li> <li ui-sref-active="{ active: \'nlp.**\' }"><a ui-sref="nlp.statistics"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Kielianalyysi</a></li> </ul> </li> </ul> \x3c!-- \n <ul class="nav navbar-nav">\n\n  <li><a href="" id="show-help" ng-click="vm.showHelp()"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Ohje</a></li>\n\t\n  <li ui-sref-active="{ active: \'search.**\' }"><a ui-sref="search.cards"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Henkilöhaku</a></li>\n  <li ui-sref-active="{ active: \'maps.**\' }"><a ui-sref="maps.singleview"><span class="glyphicon glyphicon glyphicon-globe" aria-hidden="true"></span> Kartat</a></li>\n  <li ui-sref-active="{ active: \'visu.**\' }"><a ui-sref="visu.statistics"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Tilastoja</a></li>\n  <li ui-sref-active="{ active: \'nlp.**\' }"><a ui-sref="nlp.statistics"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Kielianalyysi</a></li>\n  <li ui-sref-active="active"><a ui-sref="network"><span class="glyphicon glyphicon-link" aria-hidden="true"></span> Verkosto</a></li>\n\t\n</ul>\n --\x3e'),e.put("views/testing.html",'<p>kun <span class="kblink" href="kb/artikkeli/4064/">Tarja Halonen</span> valittiin toiselle kaudelle. </p> <p>Hän tuli ylioppilaaksi 1951 Kallion yhteiskoulusta, jota kävivät myös taiteilijaveljekset <span class="kblink" href="kb/artikkeli/1504/">Seppo</span> ja <span class="kblink" href="kb/artikkeli/4830/">Lassi Nummi</span> sekä kirjailija <span class="kblink" href="kb/artikkeli/4932/">Anu Kaipainen</span>. </p> <span class="personlink" url="{{ obj.id }}">{{ obj.name }}</span> <span class="personlink" url="http://ldf.fi/nbf/p4901">Sauli Niinistön</span> \x3c!-- \n<nlp-biography url="http://ldf.fi/nbf/p330" active="true"></nlp-biography>\n<nbf-biography url="http://ldf.fi/nbf/bio3271"></nbf-biography>\n<nbf-person url="http://ldf.fi/nbf/p6428"></nbf-person>\n<nbf-person url="http://ldf.fi/nbf/p4901"></nbf-person>\n<br />\n<br />\n<nbf-persongroup url="http://ldf.fi/nbf/p6184,http://ldf.fi/nbf/p4901,http://ldf.fi/nbf/p4902,http://ldf.fi/nbf/p4903,http://ldf.fi/nbf/p4904,http://ldf.fi/nbf/p4905,http://ldf.fi/nbf/p4906,http://ldf.fi/nbf/p4907,http://ldf.fi/nbf/p4908,http://ldf.fi/nbf/p4909,http://ldf.fi/nbf/p4910"></nbf-persongroup>\n\n<nbf-persongroup url="p6184,p4901,p4902,p4903,p4904,p4905,p4906,p4907,p4908,p4909,p4910"></nbf-persongroup>\n\nkokeneen kokoomuspoliitikon <span class="personlink" url="http://ldf.fi/nbf/p4901">Sauli Niinistön</span> kanssa\n<br/>\n--\x3e'),e.put("views/title.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>{{ vm.title.label }}</h1> Under Construction </div> </div> <div class="row"> <div ui-view></div> </div> </div>'),e.put("views/visu/comparison.left.html",'<div class="row"> <div class="col-sm-4"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu/results.partial.html\'"></div> </div> </div>'),e.put("views/visu/comparison.right.html",'<div class="row"> {{ vm.setRightSide() }} <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu/results.partial.html\'"></div> </div> <div class="col-sm-4"> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> </div>'),e.put("views/visu/results.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div ng-if="!vm.isLoadingResults"> <div class="chartcontainer" ng-repeat="id in vm.chart_ids" ng-attr-id="{{ id }}"></div> </div>'),e.put("views/visu/statistics.html",'<div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9" min-height="500"> <div ng-include="\'views/visu/results.partial.html\'"></div> </div>'),e.put("views/visu/tabs.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="visu.statistics" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Pylväsdiagrammit</a> </li> <li ui-sref="visu.comparison.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> <span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Pylväsdiagrammien vertailu</a> </li> <li ui-sref="visu.statistics2" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Piirakkadiagrammit</a> </li> <li ui-sref="visu.comparison2.sides" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Piirakkadiagrammien vertailu</a> </li> </ul> </div> </div> <div class="row"> <br> <div ui-view></div> </div> </div>'),e.put("views/visu/visu.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>'),e.put("views/visu2/comparison.left.html",'<div class="row"> <div class="col-sm-4"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu2/results.partial.html\'"></div> </div> </div>'),e.put("views/visu2/comparison.right.html",'<div class="row"> <div class="col-sm-8" min-height="500"> <div ng-include="\'views/visu2/results.partial.html\'"></div> </div> <div class="col-sm-4"> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> </div>'),e.put("views/visu2/results.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div ng-if="!vm.isLoadingResults"> <div class="piecontainer" ng-repeat="id in vm.chart_ids" ng-attr-id="{{ id }}"></div> </div>'),e.put("views/visu2/statistics.html",'<div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/description.statistics.partial.html\'"></div> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9" min-height="500"> <div ng-include="\'views/visu2/results.partial.html\'"></div> </div>'),e.put("views/visu2/visu.html",'<div class="container-fluid"> <div class="row"> \x3c!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --\x3e <div ui-view></div> </div> </div>')}]);