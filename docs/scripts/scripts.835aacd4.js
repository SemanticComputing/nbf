!function(){"use strict";angular.module("facetApp",["ui.router","seco.facetedSearch","ngTable","angular.filter","ngAnimate","ui.bootstrap","infinite-scroll","uiGmapgoogle-maps"]).constant("_",_).constant("RESULTS_PER_PAGE",25).constant("PAGES_PER_QUERY",1).value("SPARQL_ENDPOINT_URL","https://ldf.fi/nbf/sparql").run(["authStorage",function(a){a.init()}]).config(["$urlMatcherFactoryProvider",function(a){a.strictMode(!1)}]).config(["$urlRouterProvider",function(a){a.when("","/ruudukko")}]).service("authInterceptor",["$q","$state",function(a,b){this.responseError=function(c){return 401==c.status&&b.go("login"),a.reject(c)}}]).config(["$httpProvider",function(a){a.interceptors.push("authInterceptor")}]).config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginController",controllerAs:"vm"}).state("detail",{url:"/tiedot/:personId",templateUrl:"views/detail.html",controller:"DetailController",controllerAs:"vm"}).state("map",{url:"/kartta/:personId",templateUrl:"views/map.html",controller:"MapController",controllerAs:"vm"}).state("table",{url:"/lista",templateUrl:"views/table.html",controller:"TableController",controllerAs:"vm"}).state("cards",{url:"/ruudukko",templateUrl:"views/cards.html",controller:"CardsController",controllerAs:"vm"}).state("visualizations",{"abstract":!0}).state("visualizations.visu",{url:"/visualisointi",templateUrl:"views/visu.html",controller:"VisuController",controllerAs:"vm"}).state("visualizations.visu2",{url:"/visualisointi2",templateUrl:"views/visu2.html",controller:"VisuController2",controllerAs:"vm"})}])}(),function(){"use strict";angular.module("facetApp").service("authStorage",["$window","$http",function(a,b){function c(){var a=f();a&&e(a)}function d(){a.sessionStorage.removeItem("sparqlAuthToken")}function e(c){return b.defaults.headers.common.Authorization="Basic "+c,a.sessionStorage.setItem("sparqlAuthToken",c)}function f(){return a.sessionStorage.getItem("sparqlAuthToken")}this.init=c,this.setToken=e,this.getToken=f,this.clearToken=d}])}(),function(){"use strict";function a(a,b,c,d){function e(a,e){c.clearToken();var f=btoa(a+":"+e),g={headers:{Authorization:"Basic "+f}};return b.get(d+"?query=ASK{}",g).then(function(){return c.setToken(f),!0})["catch"](function(){return!1})}this.login=e}angular.module("facetApp").service("loginService",a),a.$inject=["$q","$http","authStorage","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";angular.module("facetApp").filter("castArray",["_",function(a){return function(b){return a.castArray(b)}}])}(),function(){"use strict";function a(a,b,c){function d(){this.objectClass=Object}function e(c){return c.forEach(function(c){c.hasImage=!!c.images,c.images=c.images?b.castArray(c.images):["images/person_placeholder.cd371769.svg"],c.description=a.trustAsHtml(c.description),c.source_paragraph=a.trustAsHtml(c.source_paragraph),c.lead_paragraph=a.trustAsHtml(c.lead_paragraph)}),c}d.prototype.postProcess=e;var f=Object.getPrototypeOf(c);return d.prototype=angular.extend({},f,d.prototype),new d}angular.module("facetApp").factory("personMapperService",a),a.$inject=["$sce","_","objectMapperService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){return v.getResults(a,m())}function i(b){var c=p+r,d="VALUES ?idorg { <"+b+"> } . ?idorg owl:sameAs* ?id . ";return w.getObjects(c.replace("<RESULT_SET>",d)).then(function(b){return b.length?b[b.length-1]:a.reject("Not found")})}function j(){var b=angular.copy(o);return a.when(b)}function k(){return t}function l(a){var c=b.search().sortBy||"?ordinal";c===a&&b.search("desc",b.search().desc?null:!0),b.search("sortBy",a)}function m(){var a=b.search().sortBy;c.isString(a)||(a="?ordinal");var d;return d=b.search().desc?"DESC("+a+")":a,"?ordinal"===a?d:d+" ?ordinal"}function n(a,c){var d=b.search().sortBy||"?ordinal",e=c?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";return d===a?b.search().desc?e+"-alt":e:void 0}this.getResults=h,this.getFacets=j,this.getFacetOptions=k,this.updateSortBy=l,this.getSortClass=n,this.getPerson=i;var o={entryText:{facetId:"entryText",predicate:"<http://ldf.fi/nbf/has_biography>/<http://schema.org/description>",name:"Haku",enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] .",label:"Kirjasampo"},{id:"kulttuurisampo",pattern:"?id <http://ldf.fi/nbf/kulttuurisampo> [] .",label:"Kulttuurisampo"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsa> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssit> [] .",label:"Norssit"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"BLF"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"}],enabled:!0,name:"Linkit"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",enabled:!0},familyName:{facetId:"familyName",predicate:"<http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://schema.org/familyName>",name:"Sukunimi"},dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source>",name:"Tietokanta"},birthYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>",name:"Synnyinaika",enabled:!0},birthPlace:{facetId:"birthPlace",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/place>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Syntymäpaikka",enabled:!0},deathYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>/<http://ldf.fi/nbf/time>",name:"Kuolinaika",enabled:!0},deathPlace:{facetId:"deathPlace",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>/<http://ldf.fi/nbf/place>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Kuolinpaikka",enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/schema/bioc/has_profession>/<http://ldf.fi/nbf/has_occupation>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Arvo tai ammatti",enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/schema/bioc/has_profession>/<http://ldf.fi/nbf/related_company>",name:"Yritys tai yhteisö",enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>",name:"Kategoria",enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli",enabled:!0}},p=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:	<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",q=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   ?id skosxl:prefLabel ?plabel .   		OPTIONAL { ?plabel schema:givenName ?givenName . }  		OPTIONAL { ?plabel schema:familyName ?familyName . }   OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { ?id foaf:focus ?prs .   		OPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:place ?birthPlace . filter (isliteral(?birthPlace)) }   		OPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:time/skos:prefLabel ?birthDate . }  		OPTIONAL { ?prs ^crm:P100_was_death_of/nbf:time/skos:prefLabel ?deathDate . }  		OPTIONAL { ?prs ^crm:P100_was_death_of/nbf:place ?deathPlace . filter (isliteral(?deathPlace)) }  		OPTIONAL { ?prs schema:gender ?gender . }  		OPTIONAL { ?prs schema:image ?images . }  		OPTIONAL { ?prs bioc:has_profession/skos:prefLabel ?occupation . }  		OPTIONAL { ?prs bioc:has_profession/nbf:related_company ?company . }  		OPTIONAL { ?prs nbf:has_category ?category . }  		OPTIONAL { ?prs nbf:has_biography ?bio .   			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?lead_paragraph ; nbf:id "0"^^xsd:integer  ] }  		}  } }',r=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   ?id skosxl:prefLabel ?plabel .   		OPTIONAL { ?plabel schema:givenName ?givenName . }  		OPTIONAL { ?plabel schema:familyName ?familyName . }   OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { { ?id bioc:has_family_relation [   		bioc:inheres_in ?relative__id ;   		a/skos:prefLabel ?relative__type ] . } 		UNION { ?relative__id bioc:has_family_relation [   		bioc:inheres_in ?id ;   		bioc:inverse_role/skos:prefLabel ?relative__type ] . }   		FILTER (LANG(?relative__type)="fi")   		?relative__id skosxl:prefLabel/schema:familyName ?relative__familyName ; 			skosxl:prefLabel/schema:givenName ?relative__givenName .  		BIND (replace(concat(?relative__givenName," ",?relative__familyName),"[(][^)]+[)]\\\\s*","") AS ?relative__name)    }   OPTIONAL { ?id foaf:focus ?prs .   		OPTIONAL { ?prs ^crm:P98_brought_into_life ?bir .   			OPTIONAL { ?bir nbf:place ?birthPlace . filter (isliteral(?birthPlace)) }   			OPTIONAL { ?bir nbf:time/skos:prefLabel ?birthDate . }		}   		OPTIONAL { ?prs ^crm:P100_was_death_of ?dea . 			OPTIONAL { ?dea nbf:time/skos:prefLabel ?deathDate . }  			OPTIONAL { ?dea nbf:place ?deathPlace . filter (isliteral(?deathPlace)) }		}   		OPTIONAL { ?prs schema:image ?images . }  		OPTIONAL { ?prs bioc:has_profession/skos:prefLabel ?occupation . }  		OPTIONAL { ?prs bioc:has_profession/nbf:related_company ?company . }  		OPTIONAL { ?prs nbf:has_category ?category . }  		OPTIONAL { ?prs nbf:has_biography ?bio .   			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?lead_paragraph ; nbf:id "0"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?description ; nbf:id "1"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?family_paragraph ; nbf:id "2"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?parent_paragraph ; nbf:id "3"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?spouse_paragraph ; nbf:id "4"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?child_paragraph ; nbf:id "5"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?medal_paragraph ; nbf:id "6"^^xsd:integer  ] }  			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?source_paragraph ; nbf:id "7"^^xsd:integer  ] }  		}  } }',s={endpointUrl:e,usePost:!0},t={endpointUrl:s.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?familyName . ?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi"},u={mapper:g,queryTemplate:q,prefixes:p,paging:!0,pagesPerQuery:2},v=new d(s,u),w=new f(s,g)}angular.module("facetApp").service("nbfService",a),a.$inject=["$q","$location","_","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){return t.getResults(a,n())}function i(b){var c=p+q,d="VALUES ?idorg { <"+b+"> } . ?idorg owl:sameAs* ?id . ";return u.getObjectsNoGrouping(c.replace("<RESULT_SET>",d)).then(function(b){return b.length?b:a.reject("No events found")})}function j(b){var c=p+q,d="VALUES ?idorg { <"+b+"> } . ?idorg owl:sameAs* ?id . ";return u.getObjects(c.replace("<RESULT_SET>",d)).then(function(b){return console.log(b),b.length?b[b.length-1]:a.reject("Not found")})}function k(){var b=angular.copy(facets);return a.when(b)}function l(){return facetOptions}function m(a){var c=b.search().sortBy||"?ordinal";c===a&&b.search("desc",b.search().desc?null:!0),b.search("sortBy",a)}function n(){var a=b.search().sortBy;c.isString(a)||(a="?ordinal");var d;return d=b.search().desc?"DESC("+a+")":a,"?ordinal"===a?d:d+" ?ordinal"}function o(a,c){var d=b.search().sortBy||"?ordinal",e=c?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";return d===a?b.search().desc?e+"-alt":e:void 0}this.getResults=h,this.getFacets=k,this.getFacetOptions=l,this.updateSortBy=m,this.getSortClass=o,this.getPerson=j,this.getEvents=i;var p=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:	<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",q=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   ?id a nbf:PersonConcept ;       foaf:focus ?prs ;   		skosxl:prefLabel ?ilabel .   OPTIONAL { ?ilabel schema:givenName ?givenName }   OPTIONAL { ?ilabel schema:familyName ?familyName }     { ?event bioc:inheres_in ?id }   UNION   { ?id bioc:has_family_relation ?event }   UNION   { ?event crm:P100_was_death_of ?prs }   UNION   { ?event crm:P98_brought_into_life ?prs }     ?event nbf:time ?time . 		OPTIONAL { ?time gvp:estStart ?time__start. }   		OPTIONAL { ?time gvp:estEnd ?time__end. }   		OPTIONAL { ?time skos:prefLabel ?time__label. }     OPTIONAL { ?event a/skos:prefLabel ?class . FILTER (lang(?class)="en") }    	OPTIONAL { ?event skos:prefLabel ?label }   OPTIONAL { ?event nbf:place ?place .     	filter (isUri(?place))     	OPTIoNAL { ?place  geo:lat ?place__latitude ; geo:long ?place__longitude }      	OPTIoNAL { ?place  skos:prefLabel ?place__name }    }  } ORDER BY DESC(?time__end) ',r={endpointUrl:e,usePost:!0},s=({endpointUrl:r.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://www.w3.org/2004/02/skos/core#prefLabel> ?familyName . ?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi"},{mapper:g,queryTemplate:q,prefixes:p,paging:!0,pagesPerQuery:2}),t=new d(r,s),u=new f(r,g)}angular.module("facetApp").service("mapService",a),a.$inject=["$q","$location","_","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function a(a,b,c,d){function e(d,e){var f;return f="www.norssit.fi"===a.host()?"/navbar-fi.html":"navbar-fi.html",b(f).then(function(a){return e.html(a),b("views/subnavbar.html")}).then(function(a){return angular.element("#subnav").html(a),c(e.contents())(d)})}function f(){function a(){d.open({templateUrl:"views/help.html",size:"lg"})}var b=this;b.showHelp=a}return{link:e,controller:f,controllerAs:"vm"}}angular.module("facetApp").directive("wsNavbar",a),a.$inject=["$location","$templateRequest","$compile","$uibModal"]}(),function(){"use strict";function a(a){function b(){return a.$close()}function c(a,b,c){return a.replace(""+b,""+(b+c))}function d(a){g.pageUrl=c(g.pageUrl,g.pageNo,a),g.pageNo=g.pageNo+a}function e(){return d(1)}function f(){return d(-1)}var g=this;g.close=b,g.nextPage=e,g.previousPage=f,g.$onInit=function(){g.person=g.resolve.person,g.pageUrl=g.resolve.person.pageImageURL,g.pageNo=parseInt(g.resolve.person.pageNumber)}}angular.module("facetApp").component("registerPageModal",{templateUrl:"views/page-modal.html",controller:a,bindings:{resolve:"<",close:"&",dismiss:"&"}}),a.$inject=["$scope"]}(),function(){"use strict";function a(a,b,c){function d(){return c.login(e.un,e.pw).then(function(c){return c?a.transitionTo("cards",b,{reload:!0,inherit:!1,notify:!0}):void(e.error="Kirjautuminen epäonnistui")})}var e=this;e.login=d}angular.module("facetApp").controller("LoginController",a),a.$inject=["$state","$stateParams","loginService"]}(),function(){"use strict";function a(a,b,c,d){function e(){d.getPerson(a.personId).then(function(a){return h.person=a,a})["catch"](g)}function f(){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return h.person}}})}function g(a){h.isLoadingResults=!1,h.error=a}var h=this;h.openPage=f,e()}angular.module("facetApp").controller("DetailController",a),a.$inject=["$stateParams","$uibModal","_","nbfService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){b.reload()}function k(){r.tableParams=new g({count:e},{getData:n})}function l(a){c.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return a}}})}function m(){var a=f.getFacetOptions();return a.initialState=i.getFacetValuesFromUrlParams(),a}function n(a){return r.isLoadingResults=!0,r.pager.getPage(a.page()-1,a.count()).then(function(a){return r.pager.getTotalCount().then(function(b){return r.tableParams.total(b),a}).then(function(a){return r.isLoadingResults=!1,a})})}function o(a,b){return i.updateUrlParams(b),r.previousSelections=d.clone(b.constraint),p(b)}function p(a){r.isLoadingResults=!0,f.getResults(a).then(function(a){r.pager=a,r.tableParams?(r.tableParams.page(1),r.tableParams.reload()):k()})}function q(a){return f.updateSortBy(a),p({constraint:r.previousSelections})}var r=this;r.openPage=l,r.removeFacetSelections=j,r.sortBy=q,r.getSortClass=f.getSortClass;var s=a.$on("sf-initial-constraints",function(a,b){o(a,b),s()});a.$on("sf-facet-constraints",o),f.getFacets().then(function(b){r.facets=b,r.facetOptions=m(),r.facetOptions.scope=a,r.handler=new h(r.facetOptions)})}angular.module("facetApp").controller("TableController",a),a.$inject=["$scope","$state","$uibModal","_","RESULTS_PER_PAGE","nbfService","NgTableParams","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d){function e(){d.getEvents(a.personId).then(function(a){return j.currentEvent=".",j.events=a,a.length&&(j.person=a[0]),j.events=f(a),g(j),console.log(j),a})["catch"](i)}function f(a){var b=(new Date).getFullYear(),c=b,d=0,e=!1;a.forEach(function(a){a["class"]||(a["class"]="event"),a["class"]=a["class"].toLowerCase(),a.y=0,a.r=10,["start","end"].forEach(function(b){if(a.time[b]){var e=parseInt(a.time[b].match(/^\d\d\d\d/g)[0]);e>d&&(d=e),c>e&&(c=e),a.time[b]=e,a["start"==b?"x0":"x1"]=e}});var b="http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|ABCDEF";switch(a["class"]){case"death":e=!0,b="http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|ff4141",a.label="Kuollut "+a.label,a.r=15;break;case"birth":b="http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|3b46ff",a.label="Syntynyt "+a.label,a.place&&a.place.latitude&&(j.map.center={latitude:a.place.latitude,longitude:a.place.longitude}),a.r=15;break;case"spouse":a.label=a.label+", "+a.time.label;break;case"child":a.label=a.label+", "+a.time.label;break;case"career":a.y=30;break;case"product":a.y=60;break;case"honour":a.y=90;break;default:console.log(a["class"])}a.options={icon:b}}),e||(d+=15),c>=d&&(d=c+75),d>b&&(d=b),a.min_year=c,a.max_year=d;var f=0;return a.forEach(function(a){a.x0=750*(a.x0-c)/(d-c),a.x1=750*(a.x1-c)/(d-c),a.path="M"+a.x0+","+(a.y-a.r)+"a "+a.r+" "+a.r+" 0 0 0 0 "+2*a.r+" H "+a.x1+" a "+a.r+" "+a.r+" 0 0 0 0 -"+2*a.r+" Z",console.log(a.path),a.place&&a.place.latitude&&(a.coords={latitude:a.place.latitude,longitude:a.place.longitude}),a.marker_id=f++}),console.log(a),a}function g(a){for(var b=a.events.min_year,c=b,d=a.events.max_year,e=[],f=10*Math.ceil(b/10);d+10>f;f+=10)e.push({start:750*(c-b)/(d-b),end:750*((d>f?f:d)-b)/(d-b)}),c=f;a.mainline=e}function h(){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return j.person}}})}function i(a){j.isLoadingResults=!1,j.error=a}var j=this;j.openPage=h,j.map={center:{latitude:62,longitude:24},zoom:6},j.focusEvent=function(a){j.currentEvent=a.label,a.place&&a.place.latitude&&(j.map.center={latitude:a.place.latitude,longitude:a.place.longitude})},e()}angular.module("facetApp").controller("MapController",a),a.$inject=["$stateParams","$uibModal","_","mapService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){c.reload()}function j(a){d.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return a}}})}function k(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function l(){var a=e.uniqueId();v=a,t.isLoadingResults=!0,r++<=s?t.pager.getPage(r-1,24).then(function(b){a===v&&(t.people=t.people.concat(b),t.isLoadingResults=!1)})["catch"](q):t.isLoadingResults=!1}function m(){return t.isLoadingResults||r>s}function n(a){return f.updateSortBy(a),p({constraint:t.previousSelections})}function o(a,b){return t.previousSelections&&e.isEqual(b.constraint,t.previousSelections)?void 0:(t.previousSelections=e.clone(b.constraint),h.updateUrlParams(b),p(b))}function p(a){t.isLoadingResults=!0,t.people=[],t.error=void 0;var b=e.uniqueId();w=b,r=0,f.getResults(a).then(function(a){return a.getMaxPageNo().then(function(b){return[a,b]})}).then(function(a){return w===b?(t.pager=a[0],s=a[1],t.isLoadingResults=!1,l()):void 0})["catch"](q)}function q(a){t.isLoadingResults=!1,t.error=a}var r,s,t=this;t.openPage=j,t.nextPage=l,t.isScrollDisabled=m,t.removeFacetSelections=i,t.sortBy=n,t.getSortClass=f.getSortClass,t.people=[];var u=a.$on("sf-initial-constraints",function(a,b){o(a,b),u()});a.$on("sf-facet-constraints",o),f.getFacets().then(function(b){t.facets=b,t.facetOptions=k(),t.facetOptions.scope=a,t.handler=new g(t.facetOptions)});var v,w}angular.module("facetApp").controller("CardsController",a),a.$inject=["$scope","$location","$state","$uibModal","_","nbfService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){d.reload()}function j(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function k(a,b){return r.previousSelections&&e.isEqual(b.constraint,r.previousSelections)?void 0:(r.previousSelections=e.clone(b.constraint),h.updateUrlParams(b),p(b).then(function(a){google.charts.setOnLoadCallback(function(){l("occupation","Myöhempi arvo tai ammatti","chart_occupation")}),google.charts.setOnLoadCallback(function(){l("organization","Työnantajat tai jäsenyydet järjestöissä","chart_organization")}),google.charts.setOnLoadCallback(function(){l("eduorganization","Opiskelupaikkoja Norssin jälkeen","chart_eduorganization")}),google.charts.setOnLoadCallback(function(){l("education","Koulutus Norssin jälkeen","chart_education")}),google.charts.setOnLoadCallback(m)}))}function l(a,b,c){var d=n(r.people,a),e=google.visualization.arrayToDataTable([[b,"Lukumäärä"]].concat(d)),f={title:b},g=new google.visualization.PieChart(document.getElementById(c));g.draw(e,f)}function m(){var a="education",b="eduorganization",c={},d={},e=10;$.each(r.people,function(e,f){if(f.hasOwnProperty(a)&&f.hasOwnProperty(b)){var g=f[a],h=f[b];c.hasOwnProperty(g)?c[g]+=1:c[g]=1,d.hasOwnProperty(h)?d[h]+=1:d[h]=1}}),c=$.map(c,function(a,b){return[[b,a]]}).sort(function(a,b){return b[1]-a[1]}),d=$.map(d,function(a,b){return[[b,a]]}).sort(function(a,b){return b[1]-a[1]});var f={},g={};$.each(c,function(a,b){f[b[0]]={index:e-1>a?a:e-1}}),$.each(d,function(a,b){g[b[0]]={index:e-1>a?a:e-1}});var h=$.map(new Array(Math.min(e,c.length)),function(a,b){return[$.map(new Array(Math.min(e,d.length)),function(a,b){return 0})]});$.each(r.people,function(c,d){if(d.hasOwnProperty(a)&&d.hasOwnProperty(b)){var e=d[a],i=d[b];h[f[e].index][g[i].index]+=1}});for(var i=[],j=0;j<h.length;j++)for(var k=0;k<h[j].length;k++)i.push([e-1>k?d[k][0]:"muu laitos",e-1>j?c[j][0]:"muu arvo",h[j][k]]);var l=new google.visualization.DataTable;l.addColumn("string",b),l.addColumn("string",a),l.addColumn("number","Weight"),l.addRows(i);var m={title:"Otsikko",sankey:{node:{label:{fontSize:14,color:"#000",bold:!0},labelPadding:12}}},n=new google.visualization.Sankey(document.getElementById("chart_sankey"));n.draw(l,m)}function n(a,b){return o(a,b).sort(function(a,b){return b[1]-a[1]})}function o(a,b){var c={};return $.each(a,function(a,d){if(d.hasOwnProperty(b)){var e=d[b];c.hasOwnProperty(e)?c[e]+=1:c[e]=1}}),$.map(c,function(a,b){return[[b,a]]})}function p(a){r.isLoadingResults=!0,r.people=[],r.years=[],r.topTitles=[],r.topOrgs=[],r.error=void 0;var b=e.uniqueId();return t=b,f.getResults2(a).then(function(a){return t===b?(r.isLoadingResults=!1,r.people=a[0],a):void 0})["catch"](q)}function q(a){console.log(a),r.isLoadingResults=!1,r.error=a}var r=this;r.people=[],r.startYear=[],r.topTitles=[],r.topOrgs=[],r.removeFacetSelections=i,google.charts.load("current",{packages:["corechart","line","sankey"]});var s=a.$on("sf-initial-constraints",function(a,b){k(a,b),s()});a.$on("sf-facet-constraints",k),f.getFacets().then(function(b){r.facets=b,r.facetOptions=j(),r.facetOptions.scope=a,r.handler=new g(r.facetOptions)});var t}angular.module("facetApp").controller("VisuController",a),a.$inject=["$scope","$location","$q","$state","_","norssitVisuService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){d.reload()}function j(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function k(a,b){return r.previousSelections&&e.isEqual(b.constraint,r.previousSelections)?void 0:(r.previousSelections=e.clone(b.constraint),h.updateUrlParams(b),p(b).then(function(a){google.charts.setOnLoadCallback(function(){m("0","Aloitusvuosi Norssissa","chart_enrollmentYear")}),google.charts.setOnLoadCallback(function(){m("1","Valmistumisvuosi Norssista","chart_matriculationYear")}),google.charts.setOnLoadCallback(function(){l(r.topSchools,"Yleisimmät oppilaitokset vuosikymmenittäin","chart_topschools")}),google.charts.setOnLoadCallback(function(){l(r.topTitles,"Yleisimmät virat ja toimet vuosikymmenittäin","chart_topeducation")}),google.charts.setOnLoadCallback(function(){l(r.topOrgs,"Yleisimmät työnantajat vuosikymmenittäin","chart_toporganization")})}))}function l(a,b,c){var d={},e=0;if($.each(a,function(a,b){if(b.hasOwnProperty("label")){var c=b.label;d.hasOwnProperty(c)||(d[c]={},e++),d[c][parseInt(b.year)]=parseInt(b.count)}}),d==={}||0==e){a=[];for(var f=1890;2e3>f;f+=10)a.push({count:"0",label:"No results",year:""+f});return l(a,b,c)}var a=new google.visualization.DataTable;a.addColumn("string","X");for(var g={},h=1,i=[],f=0;e>f;f++)i.push(0);$.each(d,function(b,c){a.addColumn("number",b),$.each(c,function(a,b){var c=a;g.hasOwnProperty(c)||(g[c]=[c].concat(i)),g[c][h]+=parseInt(b)}),h++}),g=$.map(g,function(a,b){return[a]});var j=$.map(g,function(a,b){return[a[0]]});a.addRows(g);var k={title:b,hAxis:{title:"Vuosikymmen",ticks:j,gridlines:{color:"none"}},vAxis:{title:"Henkilöä"}},m=new google.visualization.ColumnChart(document.getElementById(c));m.draw(a,k)}function m(a,b,c){var d=new google.visualization.DataTable,e={title:b,legend:{position:"none"},tooltip:{format:"none"},colors:["green"],hAxis:{slantedText:!1,maxAlternation:1,format:""},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},f=new google.visualization.ColumnChart(document.getElementById(c));d.addColumn("string","Vuosi"),d.addColumn("number","Oppilaita");var g=$.map(n(r.years,a),function(a,b){return[[""+a[0],a[1]]]});d.addRows(g),f.draw(d,e)}function n(a,b){var c=[];if($.each(a,function(a,d){d.hasOwnProperty("index")&&d.index==b&&c.push([parseInt(d.year),parseInt(d.count)])}),c=o(c),c.length<2){var d=parseInt(c[0][0])-1;c=[[d,0]].concat(c),d=parseInt(c[c.length-1][0])+1,c.push([d,0])}return c}function o(a){if(a.length<2)return a;for(var b=[],c=parseInt(a[0][0]),d=0;d<a.length;d++){for(var e=parseInt(a[d][0]);e>c;)b.push([c,0]),c++;b.push(a[d]),c++}return b}function p(a){r.isLoadingResults=!0,r.people=[],r.years=[],r.topTitles=[],r.topOrgs=[],r.topSchools=[],r.error=void 0;var b=e.uniqueId();return t=b,f.getResults(a).then(function(a){return t===b?(r.isLoadingResults=!1,r.people=a[0],r.years=a[1],r.topTitles=a[2],r.topOrgs=a[3],r.topSchools=a[4],a):void 0})["catch"](q)}function q(a){console.log(a),r.isLoadingResults=!1,r.error=a}var r=this;r.people=[],r.startYear=[],r.topTitles=[],r.topOrgs=[],r.removeFacetSelections=i,google.charts.load("current",{packages:["corechart","line"]});var s=a.$on("sf-initial-constraints",function(a,b){k(a,b),s()});a.$on("sf-facet-constraints",k),f.getFacets().then(function(b){r.facets=b,r.facetOptions=j(),r.facetOptions.scope=a,r.handler=new g(r.facetOptions)});var t}angular.module("facetApp").controller("VisuController2",a),a.$inject=["$scope","$location","$q","$state","_","norssitVisuService","FacetHandler","facetUrlStateHandlerService"]}(),angular.module("facetApp").run(["$templateCache",function(a){"use strict";a.put("views/achievements-popover.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-show="!person.achievements"> <div class="achievement-list"> <ul class="list-unstyled"> <li ng-repeat="achievement in person.achievements"><a ng-href="{{ achievement.wikipedia }}">{{ achievement.label | castArray | first }}</a></li> </ul> </div>'),a.put("views/cards.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10"> <b>Järjestä:</b> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/cards.partial.html\'"></div> </div> </div> </div>'),a.put("views/cards.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div infinite-scroll="vm.nextPage()" infinite-scroll-disabled="vm.isScrollDisabled()" infinite-scroll-distance="0"> <div class="row"> <div ng-repeat="person in vm.people" class="person-container"> <div class="col-xs-12 col-sm-12 person-panel col-md-4 col-lg-3"> <div class="thumbnail"> <a ui-sref="detail({ personId: person.id })"> <div class="person-profile-img vertical-center"> <img class="img img-responsive center-block media-middle" ng-src="{{ ::person.images | first }}"> </div> </a> <div class="caption"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12 col-sm-3 col-md-12"> <b><a ui-sref="detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b> </div> <div class="col-xs-12 col-sm-9 col-md-12"> <p ng-if="::(person.birthPlace || person.birthDate || person.deathDate)"> &#8727;&nbsp;<span ng-if="::person.birthPlace">{{ ::person.birthPlace }}</span> {{ ::person.birthDate }} <span ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace }}&nbsp;{{ ::person.deathDate }}</span> </p> </div> <div ng-if="::person.occupation" class="col-xs-12"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a title="Näytä matrikkeliteksti" ng-attr-title="{{ showText ? \'Piilota matrikkeliteksti\' : \'Näytä matrikkeliteksti\' }}" href="" ng-click="showText = !showText"><span class="glyphicon" ng-class="{ \'glyphicon-collapse-down\': !showText, \'glyphicon-collapse-up\': showText }" aria-hidden="true"></span></a> <a title="Kansallisbiografia" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="::person.hasAchievements" class="col-xs-6"> <a href="" class="link" ng-click="vm.getAchievements(person)" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto right">Saavutukset</a> </div> <div ng-if="::person.wikipedia" class="col-xs-6"> <a ng-href="{{ ::person.wikipedia }}">Wikipedia</a> </div> <div ng-if="::person.wikidata" class="col-xs-6"> <a ng-href="{{ ::person.wikidata }}">Wikidata</a> </div> <div ng-if="::person.warsa" class="col-xs-6"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsa }}">Sotasampo</a> </div> <div ng-if="::person.kirjasampo" class="col-xs-6"> <a ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="::person.kulttuurisampo" class="col-xs-6"> <a ng-href="{{ ::person.kulttuurisampo }}">Kulttuurisampo</a> </div> <div ng-if="::person.blf" class="col-xs-6"> <a ng-href="{{ ::person.blf }}">BLF</a> </div> <div ng-if="::person.ulan" class="col-xs-6"> <a ng-href="{{ ::person.ulan }}">ULAN</a> </div> <div ng-if="::person.viaf" class="col-xs-6"> <a ng-href="{{ ::person.viaf }}">VIAF</a> </div> <div ng-if="::person.norssit" class="col-xs-6"> <a ng-href="{{ ::person.norssit }}">Norssit</a> </div> <div ng-if="::person.eduskunta" class="col-xs-6"> <a ng-href="{{ ::person.eduskunta }}">Eduskunta</a> </div> <div ng-if="::person.website" class="col-xs-6"> <a ng-href="{{ ::person.website }}">Kotisivu</a> </div> <div ng-if="::person.genicom" class="col-xs-6"> <a ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> </div> <div ng-if="::person.genitree" class="col-xs-6"> <a ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </div> </div> <div ng-if="::person.relative" class="row"> <div class="col-xs-12">Sukulaiset:</div> <div class="col-sm-6 col-md-12" ng-repeat="relative in person.relative | castArray"> {{ ::relative.type }} <a ui-sref="detail({ personId: relative.id })">{{ ::relative.name }}</a> </div> </div> <div ng-if="::person.hobby" class="row"> <div class="col-md-12"> <p>Harrastukset: {{ ::person.hobby | castArray | join: \', \' }}</p> </div> </div> <div uib-collapse="!showText"> <hr> <p ng-bind-html="::person.lead_paragraph"></p> </div> </div> </div> </div> </div> <div class="clearfix visible-lg-block" ng-if="($index + 1) % 4 == 0"></div> <div class="clearfix visible-md-block" ng-if="($index + 1) % 3 == 0"></div> <div class="clearfix visible-sm-block" ng-if="($index + 1) % 1 == 0"></div> <div class="clearfix visible-xs-block" ng-if="($index + 1) % 1 == 0"></div> </div> </div> </div>'),
a.put("views/description.partial.html",'<h1>Semanttinen kansallisbiografia</h1> <p> Kansallisbiografian matrikkelihaku. Voit rajata tulosta tekemällä valintoja suodattimista ja selata henkilöihin liittyvää tietoa linkkien kautta. Lähde: <a href="http://www.kansallisbiografia.fi/">Kansallisbiografia</a> </p>'),a.put("views/description.statistics.partial.html",'<h1>Semanttinen Kansallisbiografia</h1> <p> Matrikkelista luotuja tilastoja. Esitykset luodaan vasemmanpuoleisissa suodattimissa tehtyjen valintojen perusteella. Lähde: <a href="http://www.kansallisbiografia.fi">Kansallisbiografia</a> </p>'),a.put("views/detail.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="col-sm-12 col-md-8 text-center" ng-show="vm.person"> <h1>{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="thumbnail"> <div class="person-profile-img"> <div class="row"> <div class="col-sm-12 text-center"> <img ng-repeat="img in vm.person.images" class="person-img img img-responsive" ng-src="{{ img }}"> </div> </div> </div> <div class="caption"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12"> <p ng-if="(vm.person.birthPlace || vm.person.birthDate || vm.person.deathDate)"> <span ng-if="(vm.person.birthPlace || vm.person.birthDate)">&#8727;&nbsp;{{ vm.person.birthPlace }} {{ vm.person.birthDate }}</span> <span ng-if="(vm.person.deathPlace || vm.person.deathDate)">&dagger;&nbsp;{{ vm.person.deathPlace }}</span> <span ng-if="vm.person.deathDate">{{ vm.person.deathDate }}</span> </p> </div> <div ng-if="vm.person.occupation" class="col-xs-12"> <p>{{ vm.person.occupation | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a ng-if="vm.person.kansallisbiografia" title="Kansallisbiografia" class="" ng-href="{{ vm.person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="{{ vm.person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="vm.person.wikipedia" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.wikipedia }}">Wikipedia</a> </div> <div ng-if="vm.person.wikidata" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.wikidata }}">Wikidata</a> </div> <div ng-if="vm.person.warsa" class="col-xs-6 col-xs-offset-3"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ vm.person.warsa }}">Sotasampo</a> </div> <div ng-if="vm.person.kirjasampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="vm.person.kulttuurisampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.kulttuurisampo }}">Kulttuurisampo</a> </div> <div ng-if="vm.person.blf" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.blf }}">BLF</a> </div> <div ng-if="vm.person.ulan" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.ulan }}">ULAN</a> </div> <div ng-if="vm.person.viaf" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.viaf }}">VIAF</a> </div> <div ng-if="vm.person.eduskunta" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.eduskunta }}">Eduskunta</a> </div> <div ng-if="vm.person.website" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.website }}">Kotisivu</a> </div> <div ng-if="vm.person.genicom" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.genicom }}">Kotisivu (Geni.com)</a> </div> <div ng-if="vm.person.genitree" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.genitree }}">Sukupuu (Geni.com)</a> </div> </div> <div ng-if="vm.person.relative" class="row padded-row"> <div class="col-xs-12"><h4>Sukulaiset:</h4></div> <div class="col-sm-6 col-md-12" ng-repeat="relative in vm.person.relative | castArray"> {{ relative.type }}<a ui-sref="detail({ personId: relative.id })"> {{ relative.name }}</a> </div> </div> <div ng-if="vm.person.hobby" class="row padded-row"> <div class="col-md-12"> <p><b>Harrastukset:</b> {{ vm.person.hobby | castArray | join: \', \' }}</p> </div> </div> <div class="entry-text text-left"> <hr> <p ng-bind-html="vm.person.lead_paragraph"></p> </div> <div ng-if="vm.person.description" class="entry-text text-left"> <hr> <p ng-bind-html="vm.person.description"></p> </div> <div ng-if="vm.person.family_paragraph" class="entry-text text-left"> <hr> <p>{{ vm.person.family_paragraph }}</p> </div> <div ng-if="vm.person.parent_paragraph" class="entry-text text-left"> <hr> <h4>Vanhemmat</h4> <p>{{ vm.person.parent_paragraph }}</p> </div> <div ng-if="vm.person.spouse_paragraph" class="entry-text text-left"> <hr> <h4>Puoliso(t) vanhempineen</h4> <p>{{ vm.person.spouse_paragraph }}</p> </div> <div ng-if="vm.person.child_paragraph" class="entry-text text-left"> <hr> <h4>Lapset</h4> <p>{{ vm.person.child_paragraph }}</p> </div> <div ng-if="vm.person.medal_paragraph" class="entry-text text-left"> <hr> <h4>Kunniamerkit</h4> <p>{{ vm.person.medal_paragraph }}</p> </div> <div ng-if="vm.person.source_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="vm.person.source_paragraph"></p> </div> </div> </div> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.hasAchievements"> <h3>Saavutuksia</h3> <img ng-if="!vm.person.achievements" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="achievement in vm.person.achievements"><a ng-href="{{ achievement.wikipedia }}">{{ achievement.label | castArray | first }}</a></div> </div> </div> </div>'),a.put("views/facets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> <seco-text-facet data-options="vm.facets.entryText"></seco-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <!--  <seco-basic-facet data-options="vm.facets.occupation"></seco-basic-facet> --> <seco-basic-facet data-options="vm.facets.period"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.familyName"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.title"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.birthPlace"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.birthYear"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.deathPlace"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.deathYear"></seco-basic-facet> </div> </div>'),a.put("views/help.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10 text-left"> <h3 class="modal-title">Kansallisbiografia</h3> </div> <div class="col-xs-2"> <a href="#" ng-click="$close()" class="no-decoration btn-lg pull-right glyphicon glyphicon-remove"></a> </div> </div> </div> <div class="modal-body"> <p> Matrikkelin tietoja voi selata käyttöliittymässä käyttämällä vasemmalla olevia suodattimia. Hakeaksesi rekisterillä tekstihaulla, kirjoita haku \'Haku\'-kenttään. Poistaaksesi hakurajauksen, paina X-nappia hakukentän oikealla puolella. Jokaisella suodattimella on oma hakukenttä sekä lista suodattimen vaihtoehdoista, josta voi valita haluamansa ehdon. Tulosten määrä vaihtoehdolla näkyy suluissa valinnan nimen perässä. Valinnan voi poistaa valitsemalla vaihtoehdon \'-- No Selection --\'. Jokaisesta suodattimesta voi valita vain yhden vaihtoehdon, jolloin henkilölistausta suodatetaan valintojen perusteella. Tuloslistaa voi suodattaa käyttäen eri suodattimia yhdessä. </p> <p> <h4>Suodattimien valinta:</h4> <ol> <li>Valitse joku suodattimista ja avaa suodatin painamalla \'+\'-nappia suodattimen otsikon oikealla puolella.</li> <li>Valitse suodattimeen arvo listalta tai hae kirjoittamalla listan yllä olevaan tekstikenttään. Jos suodatinehtoa haetaan tekstikentän avulla alla oleva lista suodattimista päivittyy kirjoittaessa.</li> <li>Suodatinehdon voi valita klikkaamalla sitä listalta, tai poistaa valitsemalla \'-- No Selection --\' listan alusta. </li> <li>Henkilöiden lista päivittyy suodattimien oikealla puolella.</li> <li>Tuloksia voi nyt suodattaa tarvittaessa lisää toistamalla toisella suodattimella edelliset askeleet 1-4.</li> </ol> </p> </div>'),a.put("views/login.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>Kirjaudu</h1> <div ng-show="vm.error" class="alert alert-danger" role="alert">{{ vm.error }}</div> <form> <div class="form-group"> <label for="un">Käyttäjätunnus</label> <input ng-model="vm.un" type="text" class="form-control" id="un" placeholder="Username"> </div> <div class="form-group"> <label for="pw">Salasana</label> <input ng-model="vm.pw" type="password" class="form-control" id="pw" placeholder="Password"> </div> <button ng-click="vm.login()" type="submit" class="btn btn-default">Submit</button> </form> </div> </div> </div>'),a.put("views/map.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="col-sm-12 col-md-8 text-center" ng-show="vm.person"> <h1>{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="thumbnail"> <ui-gmap-google-map center="vm.map.center" zoom="vm.map.zoom"> <ui-gmap-marker ng-repeat="event in ::vm.events" coords="event.coords" idkey="event.marker_id" options="event.options"></ui-gmap-marker> </ui-gmap-google-map> <svg id="timelinecontainer" viewbox="-50,-40,850,180" version="1.0" x="0" y="0" width="900" height="180" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <line ng-repeat="line in ::vm.mainline" ng-attr-x1="{{ line.start }}" ng-attr-x2="{{ line.end }}" y1="0" y2="0"> <a ng-repeat="event in ::vm.events" id="mylink" target="_top" ng-mouseover="vm.focusEvent(event)" ng-mouseleave="vm.currentEvent=\'.\'"> <path class="{{ event.class }}" ng-attr-d="{{ event.path }}"> <title>{{ event.elabel }}</title> </path> </a> <text x="0" y="35">{{ vm.events.min_year }}</text> <text x="750" y="35">{{ vm.events.max_year }}</text> </svg> <p><span>{{ vm.currentEvent }}</span></p> </div> </div> </div> </div>'),a.put("views/page-modal.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-8"> <h3 class="modal-title">{{ $ctrl.person.ordinal }} {{ $ctrl.person.givenName }} {{ $ctrl.person.familyName }}</h3> </div> <div class="col-xs-4 text-right"> <button class="btn btn-default" ng-click="$ctrl.previousPage()" ng-disabled="$ctrl.pageNo === 1" aria-label="Edellinen sivu"> <span class="glyphicon glyphicon-step-backward"></span> </button> <span>{{ $ctrl.pageNo }}</span> <button class="btn btn-default" ng-click="$ctrl.nextPage()" ng-disabled="$ctrl.pageNo === 716" aria-label="Seuraava sivu"> <span class="glyphicon glyphicon-step-forward"></span> </button> <button ng-click="$ctrl.close()" class="btn btn-default" aria-label="Sulje"> <span aria-hidden="true" class="glyphicon glyphicon-remove"></span> </button> </div> </div> </div><div class="modal-body"> <img class="img img-responsive" ng-src="{{ $ctrl.pageUrl }}"> </div>'),a.put("views/profile-image-popover.html",'<div> <img class="img img-responsive" ng-src="{{ img }}"> </div>'),a.put("views/register-text-popover.html","<div> <pre>{{ person.entryText }}</pre> </div>"),a.put("views/subnavbar.html",'<ul class="nav navbar-nav"> <li><a href="" id="show-help" ng-click="vm.showHelp()"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Ohje</a></li> <li ui-sref-active="active"><a ui-sref="cards"><span class="glyphicon glyphicon-th" aria-hidden="true"></span> Ruudukko</a></li> <li ui-sref-active="active"><a ui-sref="table"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span> Lista</a></li> <!--  <li class="dropdown" ui-sref-active="{\'active\': \'visualizations.**\'}">\n  <a class="dropdown-toggle" data-toggle="dropdown" href="" id="statistics"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Tilastoja<span class="caret"></span></a>\n    <ul class="dropdown-menu">\n      <li ui-sref-active="active"><a ui-sref="visualizations.visu"><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Tilastoja 1</a></li>\n      <li ui-sref-active="active"><a ui-sref="visualizations.visu2"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Tilastoja 2</a></li>\n    </ul>\n  </li> --> </ul>'),a.put("views/table.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10"> Järjestä: <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/table.partial.html\'"></div> </div> </div> </div>'),a.put("views/table.partial.html",'<table class="table table-striped norssi-table ng-table-responsive" ng-table="vm.tableParams"> <thead> <tr> <th class="col-xs-4">Nimi</th> <th class="col-xs-1">Henkilö</th> <th class="col-xs-1">Linkit</th> <th class="col-xs-3"><span class="hidden-xs hidden-sm">Muuta</span></th> <th class="col-xs-3 hidden-xs hidden-sm">Matrikkeliteksti</th> </tr> </thead> <tbody> <tr ng-show="!vm.isLoadingResults" ng-repeat="person in $data"> <td class="person-image-container" data-title="\'Nimi\'"> <div ng-class="::{ \'name-col col-md-12 col-lg-7\': person.images }"> <b><a ui-sref="detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b><br> <span ng-if="::(person.birthDate)">&#8727;&nbsp;{{ ::person.birthPlace }} {{ ::person.birthDate }}</span> <span ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace }} {{ ::person.deathDate }}</span> <br> <span class="icon-menu"> <a title="Kansallisbiografia" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </span> </div> <div ng-if="::person.hasImage" class="name-col col-md-12 col-lg-5"> <div ng-repeat="img in ::person.images" ng-class="{ \'col-md-12\': ($first && $last), \'col-sm-6\': !($first && $last) }" class="person-img-col vcenter"> <img uib-popover-template="\'views/profile-image-popover.html\'" popover-trigger="\'mouseenter\'" popover-placement="auto right" popover-append-to-body="true" class="person-image img img-responsive" ng-src="{{ img  }}"> </div> </div> </td> <td class="links" data-title="\'Henkilö\'"> <div ng-if="::person.occupation" class="hidden-xs hidden-sm"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> </td> <td class="links" data-title="\'Linkit\'"> <div ng-if="::person.achievement"> <a href="" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto top">Saavutukset</a> </div> <a class="link" ng-if="::person.wikipedia" ng-href="{{ ::person.wikipedia }}">Wikipedia</a> <a class="link" ng-if="::person.warsa" ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsa }}">Sotasampo</a> <a class="link" ng-if="::person.kirjasampo" ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> <a class="link" ng-if="::person.kulttuurisampo" ng-href="{{ ::person.kulttuurisampo }}">Kulttuurisampo</a> <a class="link" ng-if="::person.blf" ng-href="{{ ::person.blf }}">BLF</a> <a class="link" ng-if="::person.ulan" ng-href="{{ ::person.ulan }}">ULAN</a> <a class="link" ng-if="::person.viaf" ng-href="{{ ::person.viaf }}">VIAF</a> <a class="link" ng-if="::person.eduskunta" ng-href="{{ ::person.eduskunta }}">Eduskunta</a> <a class="link" ng-if="::person.website" ng-href="{{ ::person.website }}">Kotisivu</a> <a class="link" ng-if="::person.genicom" ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> <a class="link" ng-if="::person.genitree" ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </td> <td data-title="\'Muuta\'"> <div ng-if="::person.relative"> <span>Sukulaiset: </span><br> <span ng-repeat="relative in person.relative | castArray"> {{ ::relative.type }} <a ui-sref="detail({ personId: relative.id })">{{ ::relative.name }}</a> </span> </div> <button class="page-btn visible-xs-block visible-sm-block btn btn-default" ng-click="::vm.openPage(person)">Matrikkelisivu</button> <div ng-if="::person.hobby"><span>Harrastukset: </span><br>{{ ::person.hobby | join:\', \' }}</div> <button class="page-btn visible-xs-block visible-sm-block btn btn-default" ng-click="::vm.openPage(person)">Matrikkelisivu</button> </td> <td data-title="\'Matrikkeliteksti\'" class="hidden-xs hidden-sm"><p ng-bind-html="::person.lead_paragraph"></p></td> </tr> </tbody> </table> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),a.put("views/visu.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-1 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="logo.jpg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.statistics.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="chart_education" style="width: 100%; height: 500px"></div> <div id="chart_eduorganization" style="width: 100%; height: 500px"></div> <div id="chart_occupation" style="width: 100%; height: 500px"></div> <div id="chart_organization" style="width: 100%; height: 500px"></div> <p style="font-family: Arial; font-size:15px; color:black"><strong>Oppilaitoksista saatuja oppiarvoja</strong></p> <div id="chart_sankey" style="width: 100%; height: 700px"></div> </div> </div> </div>'),a.put("views/visu2.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-1 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="http://www.norssit.fi/images/norssi_logo.jpg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.statistics.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/norssit.facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="chart_enrollmentYear"></div> <div id="chart_matriculationYear"></div> <div id="chart_topschools" style="width: 100%; height: 500px"></div> <div id="chart_toporganization" style="width: 100%; height: 500px"></div> <div id="chart_topeducation" style="width: 100%; height: 500px"></div> </div> </div> </div>')}]);