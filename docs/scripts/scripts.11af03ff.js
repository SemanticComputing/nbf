!function(){"use strict";angular.module("facetApp",["ui.router","seco.facetedSearch","ngTable","angular.filter","ngAnimate","ui.bootstrap","infinite-scroll","uiGmapgoogle-maps","rzModule"]).constant("_",_).constant("google",google).constant("RESULTS_PER_PAGE",25).constant("PAGES_PER_QUERY",1).value("SPARQL_ENDPOINT_URL","https://ldf.fi/nbf/sparql").run(["authStorage",function(a){a.init()}]).run(["google",function(a){a.charts.load("current",{packages:["corechart","line"]})}]).config(["$urlMatcherFactoryProvider",function(a){a.strictMode(!1)}]).config(["$urlRouterProvider",function(a){a.when("","/ruudukko")}]).service("authInterceptor",["$q","$state",function(a,b){this.responseError=function(c){return 401==c.status&&b.go("login"),a.reject(c)}}]).config(["$httpProvider",function(a){a.interceptors.push("authInterceptor")}]).config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginController",controllerAs:"vm"}).state("person",{"abstract":!0,url:"/:personId",templateUrl:"views/person.html"}).state("person.detail",{url:"",templateUrl:"views/detail.html",controller:"DetailController",controllerAs:"vm"}).state("person.map",{url:"/kartta",templateUrl:"views/map.html",controller:"MapController",controllerAs:"vm"}).state("place",{url:"/place/:placeId",templateUrl:"views/place.html",controller:"PlaceController",controllerAs:"vm"}).state("title",{url:"/title/:titleId",templateUrl:"views/title.html",controller:"TitleController",controllerAs:"vm"}).state("table",{url:"/lista",templateUrl:"views/table.html",controller:"TableController",controllerAs:"vm"}).state("groupmap",{url:"/joukkokartta",templateUrl:"views/groupmap.html",controller:"GroupmapController",controllerAs:"vm"}).state("cards",{url:"/ruudukko",templateUrl:"views/cards.html",controller:"CardsController",controllerAs:"vm"}).state("nlp",{url:"/nlp",templateUrl:"views/nlp.html",controller:"NlpController",controllerAs:"vm"}).state("visualizations",{"abstract":!0}).state("visualizations.visu",{url:"/visualisointi",templateUrl:"views/visu.html",controller:"VisuController",controllerAs:"vm"}).state("visualizations.visu2",{url:"/visualisointi2",templateUrl:"views/visu2.html",controller:"VisuController2",controllerAs:"vm"})}])}(),function(){"use strict";angular.module("facetApp").service("authStorage",["$window","$http",function(a,b){function c(){var a=f();a&&e(a)}function d(){a.sessionStorage.removeItem("sparqlAuthToken")}function e(c){return b.defaults.headers.common.Authorization="Basic "+c,a.sessionStorage.setItem("sparqlAuthToken",c)}function f(){return a.sessionStorage.getItem("sparqlAuthToken")}this.init=c,this.setToken=e,this.getToken=f,this.clearToken=d}])}(),function(){"use strict";function a(a,b,c,d){function e(a,e){c.clearToken();var f=btoa(a+":"+e),g={headers:{Authorization:"Basic "+f}};return b.get(d+"?query=ASK{}",g).then(function(){return c.setToken(f),!0})["catch"](function(){return!1})}this.login=e}angular.module("facetApp").service("loginService",a),a.$inject=["$q","$http","authStorage","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";angular.module("facetApp").filter("castArray",["_",function(a){return function(b){return a.castArray(b)}}])}(),function(){"use strict";function a(a,b,c){function d(){this.objectClass=Object}function e(c){return c.forEach(function(c){if(c.hasImage=!!c.images,c.images=c.images?b.castArray(c.images):["images/person_placeholder.cd371769.svg"],c.description&&(c.description=a.trustAsHtml(c.description),console.log(c.description)),c.source_paragraph&&(c.source_paragraph=a.trustAsHtml(c.source_paragraph)),c.lead_paragraph&&(c.lead_paragraph=a.trustAsHtml(c.lead_paragraph)),c.norssi&&(c.norssi=c.norssi.replace("http://ldf.fi/norssit/","")),c.fennica){c.fennica.constructor!==Array&&(c.fennica=[c.fennica]);for(var d=0;d<c.fennica.length;d++)c.fennica[d]="http://data.nationallibrary.fi/"+c.fennica[d].replace("http://urn.fi/URN:NBN:fi:","").replace(/:/g,"/")}c.givenName.constructor===Array&&2==c.givenName.length&&(c.givenName=c.givenName[0]+" ja "+c.givenName[1])}),c}d.prototype.postProcess=e;var f=Object.getPrototypeOf(c);return d.prototype=angular.extend({},f,d.prototype),new d}angular.module("facetApp").factory("personMapperService",a),a.$inject=["$sce","_","objectMapperService"]}(),function(){"use strict";function a(a,b,c){function d(){this.objectClass=Object}function e(a){return a}d.prototype.postProcess=e;var f=Object.getPrototypeOf(c);return d.prototype=angular.extend({},f,PersonMapper.prototype),new d}angular.module("facetApp").factory("eventMapperService",a),a.$inject=["$sce","_","objectMapperService"]}(),function(){"use strict";function a(a,b){function c(){var b=angular.copy(e);return a.when(b)}function d(){return g}this.getFacets=c,this.getFacetOptions=d;var e={entryText:{facetId:"entryText",graph:"<http://ldf.fi/nbf/people>",name:"Haku",enabled:!0},dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source>",name:"Tietokanta",chart:!0,enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"fennica",pattern:"?id <http://ldf.fi/nbf/fennica> [] .",label:"Fennica - Suomen kansallisbibliografia"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsampo> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssi> [] .",label:"Norssit"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] . ",label:"Kirjasampo"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"BLF"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"}],chart:!0,enabled:!0,name:"Linkitetyt tietokannat"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",chart:!0,enabled:!0},familyName:{facetId:"familyName",predicate:"<http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://schema.org/familyName>",chart:!0,name:"Sukunimi"},author:{facetId:"author",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://schema.org/author>",chart:!0,name:"Kirjoittaja"},birthYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart>",name:"Synnyinaika",enabled:!0},place:{facetId:"place",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>|^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>)/<http://ldf.fi/nbf/place>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Paikkakunta",chart:!0,enabled:!0},deathYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>/<http://ldf.fi/nbf/time>",name:"Kuolinaika",enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/has_title>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Arvo, ammatti tai toiminta",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:3,chart:!0,enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/related_company>",name:"Yritys tai yhteisö",chart:!0,enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>",name:"Toimiala",chart:!0,enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli",chart:!0,enabled:!0}},f={endpointUrl:b,usePost:!0},g={endpointUrl:f.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://www.w3.org/2008/05/skos-xl#prefLabel>/<http://www.w3.org/2004/02/skos/core#prefLabel> ?familyName . ?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"}}angular.module("facetApp").service("facetService",a),a.$inject=["$q","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(a){return w.getResults(a,n())}function j(b){var c=p+r,d="VALUES ?idorg { <"+b+"> } . ?idorg owl:sameAs* ?id . ";return x.getObjects(c.replace("<RESULT_SET>",d)).then(function(b){return b.length?b[b.length-1]:a.reject("Not found")})}function k(a){var b=p+s,c="VALUES ?id { <"+a+"> } . ";return x.getObjectsNoGrouping(b.replace("<RESULT_SET>",c)).then(function(a){return a})}function l(a){var b=p+t,c="VALUES ?id { <"+a+"> } . ";return x.getObjectsNoGrouping(b.replace("<RESULT_SET>",c)).then(function(a){return a})}function m(a){var c=b.search().sortBy||"?ordinal";c===a&&b.search("desc",b.search().desc?null:!0),b.search("sortBy",a)}function n(){var a=b.search().sortBy;c.isString(a)||(a="?ordinal");var d;return d="?ordinal"===a?b.search().desc?a:"DESC("+a+")":b.search().desc?"DESC("+a+")":a,"?ordinal"===a?d:d+" ?ordinal"}function o(a,c){var d=b.search().sortBy||"?ordinal",e=c?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";if("?ordinal"===a){if(d===a)return b.search().desc?e:e+"-alt"}else if(d===a)return b.search().desc?e+"-alt":e}this.getResults=i,this.getFacets=d.getFacets,this.getFacetOptions=d.getFacetOptions,this.updateSortBy=m,this.getSortClass=o,this.getPerson=j,this.getSimilar=l,this.getBios=k;var p=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:	<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",q=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }  FILTER not exists { ?id owl:sameAs [] }  ?id skosxl:prefLabel ?plabel .   		OPTIONAL { ?plabel schema:givenName ?givenName . }  		OPTIONAL { ?plabel schema:familyName ?familyName . }  OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:fennica ?fennica . }  OPTIONAL { ?id nbf:warsampo ?warsampo . }  OPTIONAL { ?id nbf:norssi ?norssi . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:genicom ?genicom . }  OPTIONAL { ?id nbf:genitree ?genitree . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id nbf:kirjasampo ?kirjasampo . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { ?id foaf:focus ?prs .   		OPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:place ?birthPlace . filter (isliteral(?birthPlace)) }   		OPTIONAL { ?prs ^crm:P98_brought_into_life/nbf:time/skos:prefLabel ?birthDate . }  		OPTIONAL { ?prs ^crm:P100_was_death_of/nbf:time/skos:prefLabel ?deathDate . }  		OPTIONAL { ?prs ^crm:P100_was_death_of/nbf:place ?deathPlace . filter (isliteral(?deathPlace)) }  		OPTIONAL { ?prs schema:gender ?gender . }  		OPTIONAL { ?prs schema:image ?images . }  		OPTIONAL { ?prs ^bioc:inheres_in ?occupation_id .   			?occupation_id a nbf:Occupation ; skos:prefLabel ?occupation   			OPTIONAL { ?occupation_id nbf:related_company ?company . }		}  		OPTIONAL { ?prs nbf:has_category ?category . }  		OPTIONAL { ?prs nbf:has_biography ?bio .   			OPTIONAL { ?bio nbf:has_paragraph [ nbf:content ?lead_paragraph ; nbf:id "0"^^xsd:integer  ] }  		} } }',r=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   ?id skosxl:prefLabel ?plabel .   		OPTIONAL { ?plabel schema:givenName ?givenName . }  		OPTIONAL { ?plabel schema:familyName ?familyName . }   OPTIONAL { ?id nbf:viaf ?viaf . }  OPTIONAL { ?id nbf:ulan ?ulan . }  OPTIONAL { ?id nbf:wikidata ?wikidata . }  OPTIONAL { ?id nbf:wikipedia ?wikipedia . }  OPTIONAL { ?id nbf:fennica ?fennica . }  OPTIONAL { ?id nbf:blf ?blf . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:eduskunta ?eduskunta . }  OPTIONAL { ?id nbf:warsampo ?warsampo . }  OPTIONAL { ?id nbf:norssi ?norssi . }  OPTIONAL { ?id nbf:kirjasampo ?kirjasampo . }  OPTIONAL { ?id nbf:website ?website . }  OPTIONAL { ?id nbf:genicom ?genicom . }  OPTIONAL { ?id nbf:genitree ?genitree . }  OPTIONAL { ?id schema:relatedLink ?kansallisbiografia . }  OPTIONAL { { ?id bioc:has_family_relation [   		bioc:inheres_in ?relative__id ;   		a/skos:prefLabel ?relative__type ] . } 		UNION { ?relative__id bioc:has_family_relation [   		bioc:inheres_in ?id ;   		bioc:inverse_role/skos:prefLabel ?relative__type ] . }   		FILTER (LANG(?relative__type)="fi")   		?relative__id skosxl:prefLabel/schema:familyName ?relative__familyName ; 		      skosxl:prefLabel/schema:givenName ?relative__givenName .  		BIND (replace(concat(?relative__givenName," ",?relative__familyName),"[(][^)]+[)]\\\\s*","") AS ?relative__name)    }   OPTIONAL { ?id foaf:focus ?prs .   		OPTIONAL { ?prs ^crm:P98_brought_into_life ?bir .   			OPTIONAL { ?bir nbf:place ?birthPlace . filter (isliteral(?birthPlace)) }   			OPTIONAL { ?bir nbf:time/skos:prefLabel ?birthDate . }		}   		OPTIONAL { ?prs ^crm:P100_was_death_of ?dea . 			OPTIONAL { ?dea nbf:time/skos:prefLabel ?deathDate . }  			OPTIONAL { ?dea nbf:place ?deathPlace . filter (isliteral(?deathPlace)) }		}   		OPTIONAL { ?prs schema:image ?images . }  		OPTIONAL { ?prs ^bioc:inheres_in ?occupation_id .   			?occupation_id a nbf:Occupation ; skos:prefLabel ?occupation }  		OPTIONAL { ?prs nbf:has_category ?category . }  } }',s='SELECT DISTINCT * WHERE { { <RESULT_SET> } ?id owl:sameAs*|^owl:sameAs ?prs . ?prs foaf:focus/nbf:has_biography ?bio .  OPTIONAL { ?bio dct:source ?source . ?source skos:prefLabel ?database }  OPTIONAL { ?bio nbf:authors ?author_text }  OPTIONAL { ?bio schema:dateCreated ?created }  OPTIONAL { ?bio schema:dateModified ?modified }  OPTIONAL { ?bio schema:relatedLink ?link }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "0"^^xsd:integer ; nbf:content ?lead_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "1"^^xsd:integer ; nbf:content ?description    ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "2"^^xsd:integer ; nbf:content ?family_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "3"^^xsd:integer ; nbf:content ?parent_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "4"^^xsd:integer ; nbf:content ?spouse_paragraph ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "5"^^xsd:integer ; nbf:content ?child_paragraph  ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "6"^^xsd:integer ; nbf:content ?medal_paragraph  ] }  OPTIONAL { ?bio nbf:has_paragraph [ nbf:id "7"^^xsd:integer ; nbf:content ?source_paragraph ] }} ORDER BY str(?source)',t='SELECT DISTINCT ?prs ?label WHERE {   { <RESULT_SET> }  {     ?dst bioc:relates_to ?id ; bioc:relates_to ?prs ; bioc:value ?val .     } UNION {       ?dst bioc:relates_to ?id ; bioc:relates_to ?idX ; bioc:value ?valX .       ?dst2 bioc:relates_to ?idX ; bioc:relates_to ?prs ; bioc:value ?val2 .         BIND (?valX+?val2 AS ?val)   } UNION {      ?dst bioc:relates_to ?id ; bioc:relates_to ?idX ; bioc:value ?valX .     ?dst2 bioc:relates_to ?idX ; bioc:relates_to ?idY ; bioc:value ?valY .         ?dst3 bioc:relates_to ?idY ; bioc:relates_to ?prs ; bioc:value ?val2 .         BIND (?valX+?valY+?val2 AS ?val)   }   FILTER (?id != ?prs)   OPTIONAL { ?prs skosxl:prefLabel/schema:familyName ?fname . }   OPTIONAL { ?prs skosxl:prefLabel/schema:givenName ?gname . }   BIND (CONCAT(COALESCE(?gname, "")," ",COALESCE(?fname, "")) AS ?label)} ORDER by ?val LIMIT 16 ',u={endpointUrl:f,usePost:!0},v={mapper:h,queryTemplate:q,prefixes:p,paging:!0,pagesPerQuery:2},w=new e(u,v),x=new g(u,h)}angular.module("facetApp").service("nbfService",a),a.$inject=["$q","$location","_","facetService","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){var b=n.replace(/<RESULT_SET>/g,a.constraint.join(" "));return s.getObjectsNoGrouping(b)}function i(c){var d=this,e=l.replace(/<RESULT_SET>/g,c.constraint.join(" "));return s.getObjectsNoGrouping(e).then(function(c){if(c.length>1e4)return a.reject({message:"Tulosjoukko on liian suuri. Ole hyvä ja rajaa tuloksia suodittimien avulla"});var e={},f=m.replace(/<DOC>/g,"<"+b.map(c,"id").join("> <")+">");return d.upos.forEach(function(a){e[a]=r.getObjectsNoGrouping(f.replace(/<UPOS>/g,a))}),a.all(e)})}function j(){return q}this.getResults=i,this.getStatistics=h,this.getFacets=f.getFacets,this.getFacetOptions=j,this.upos=["VERB","NOUN","ADJ","PROPN"];var k=" PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX gvp: <http://vocab.getty.edu/ontology#>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX conll: <http://ufal.mff.cuni.cz/conll2009-st/task-description.html#>  PREFIX nif: <http://persistence.uni-leipzig.org/nlp2rdf/ontologies/nif-core#>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> ",l=" SELECT DISTINCT ?id WHERE {  {     <RESULT_SET>   }  }",m=k+' SELECT DISTINCT ?lemma (COUNT(?lemma) AS ?count) {   VALUES ?doc { <DOC> }   ?s nif:structure/<http://ldf.fi/nbf/biography/data#bioId> ?doc .   ?s a nif:Sentence .   ?word nif:sentence ?s .   ?word conll:UPOS "<UPOS>" .   ?word conll:LEMMA ?lemma .   FILTER(STRLEN(STR(?lemma))>1)  } GROUP BY ?lemma ORDER BY DESC(?count) LIMIT 50',n=k+" SELECT DISTINCT ?year (COUNT(distinct ?id) AS ?count) {   {     <RESULT_SET>   }   ?id foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .   BIND (FLOOR(YEAR(?birth)/10)*10 AS ?year)  } GROUP BY ?year ORDER BY ?year ",o={endpointUrl:e,usePost:!0},p={endpointUrl:"https://ldf.fi/nbf-nlp/sparql",usePost:!0},q={endpointUrl:o.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography> [] .",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},r=new c(p,g),s=new c(o,g)}angular.module("facetApp").service("nlpService",a),a.$inject=["$q","_","AdvancedSparqlService","FacetResultHandler","SPARQL_ENDPOINT_URL","facetService","objectMapperService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(b){var c=m+n,d="VALUES ?idorg { <"+b+"> } . ?idorg owl:sameAs* ?pc . ";return q.getObjects(c.replace("<RESULT_SET>",d)).then(function(b){return b.length?b:a.reject("No events found")})}function i(){var b=angular.copy(facets);return a.when(b)}function j(){return facetOptions}function k(a){var c=b.search().sortBy||"?ordinal";c===a&&b.search("desc",b.search().desc?null:!0),b.search("sortBy",a)}function l(a,c){var d=b.search().sortBy||"?ordinal",e=c?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";return d===a?b.search().desc?e+"-alt":e:void 0}this.getFacets=i,this.getFacetOptions=j,this.updateSortBy=k,this.getSortClass=l,this.getEvents=h;var m=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories: <http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",n=' SELECT DISTINCT * WHERE {  {     <RESULT_SET>   }   ?pc a nbf:PersonConcept ;       foaf:focus ?prs ;   		skosxl:prefLabel ?ilabel .   OPTIONAL { ?ilabel schema:givenName ?givenName }   OPTIONAL { ?ilabel schema:familyName ?familyName }   { ?pc bioc:has_family_relation ?id . 		?id bioc:inheres_in ?relative }   UNION   { ?id crm:P100_was_death_of ?prs . }   UNION   { ?id crm:P98_brought_into_life ?prs . }   UNION   { ?id bioc:inheres_in ?prs . }    ?id a/skos:prefLabel ?class . FILTER (lang(?class)="en")   ?id nbf:time ?time . 		OPTIONAL { ?time gvp:estStart ?time__start. }   		OPTIONAL { ?time gvp:estEnd ?time__end. }   		OPTIONAL { ?time skos:prefLabel ?time__label. }   	    BIND ( CONCAT(	        IF(bound(?time__start),str(year(?time__start)),"")	        ,"-", 	        IF(bound(?time__end),str(year(?time__end)),"")	      ) AS ?time__span)   OPTIONAL { ?id skos:prefLabel ?label }   OPTIONAL { ?id nbf:place ?place__uri .     	?place__uri geo:lat ?place__latitude ;            geo:long ?place__longitude  ;    		skos:prefLabel ?place__name .  }  } ORDER BY ?time__start DESC(?time__end)',o={endpointUrl:e,usePost:!0},p={mapper:g,queryTemplate:n,prefixes:m,paging:!0,pagesPerQuery:2},q=(new d(o,p),new f(o,g))}angular.module("facetApp").service("mapService",a),a.$inject=["$q","$location","_","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function a(){return{restrict:"E",scope:{options:"="},controller:"SliderFacetController",controllerAs:"vm",templateUrl:"views/sliderFacet.directive.html"}}function b(a,b,c,d,e,f){function g(){var c=a.$on(e,function(d,e){var g=b.cloneDeep(a.options);g.initial=e.facets,g.update=i,n.facet=new f(g),c()});a.$emit(d)}function h(){var b={id:n.facet.facetId,constraint:n.facet.getConstraint(),value:n.facet.getSelectedValue(),priority:n.facet.getPriority()};a.$emit(c,b)}function i(){h()}function j(){n.facet.clear(),h()}function k(){n.facet.enable()}function l(){n.facet.disable(),h()}function m(){return n.facet?n.facet.isEnabled():!1}var n=this;n.changed=i,n.clear=j,n.enableFacet=k,n.disableFacet=l,n.isFacetEnabled=m;var o=a.$watch("options",function(a){a&&(g(),o())})}function c(a){function b(b){var c={preferredLang:"fi"};this.config=angular.extend({},c,b),this.name=this.config.name,this.facetId=this.config.facetId,this.predicate=this.config.predicate,this.config.enabled?this.enable():this.disable(),this.internalId=a.uniqueId();var d=parseInt(this.config.min)||200,e=parseInt(this.config.max)||(new Date).getFullYear();this.slider={minValue:d,maxValue:e,options:{floor:d,ceil:e,step:10,draggableRange:!0,onEnd:this.config.update}};var f=a.get(b,"initial."+this.facetId+".value");f&&(this._isEnabled=!0,this.slider.minValue=f.min,this.slider.maxValue=f.max)}function c(){var a=this.slider.minValue,b=this.slider.maxValue,c="?slider_"+this.internalId,d="?id <PREDICATE> <OBJ> . FILTER (<STARTYEAR><=year(<OBJ>) && year(<OBJ>)<=<ENDYEAR>) ".replace(/<OBJ>/g,c).replace(/<PREDICATE>/g,this.predicate).replace("<STARTYEAR>",a).replace("<ENDYEAR>",b);return d}function d(){return this.config.preferredLang}function e(){return{min:this.slider.minValue,max:this.slider.maxValue}}function f(){return this.config.priority}function g(){}function h(){return this._isEnabled}function i(){this._isEnabled=!0}function j(){this.selectedValue=void 0,this._isEnabled=!1}return b.prototype.getConstraint=c,b.prototype.getPriority=f,b.prototype.getPreferredLang=d,b.prototype.disable=j,b.prototype.enable=i,b.prototype.clear=g,b.prototype.isEnabled=h,b.prototype.getSelectedValue=e,b}angular.module("seco.facetedSearch").factory("SliderFacet",c).controller("SliderFacetController",b).directive("secoSliderFacet",a),b.$inject=["$scope","_","EVENT_FACET_CHANGED","EVENT_REQUEST_CONSTRAINTS","EVENT_INITIAL_CONSTRAINTS","SliderFacet"],c.$inject=["_"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){var b=n+o.replace("<RESULT_SET>",a.constraint.join(" "));return s.getObjectsNoGrouping(b)}function i(){var b=angular.copy(m);return a.when(b)}function j(){return q}function k(a){var c=b.search().sortBy||"?ordinal";c===a&&b.search("desc",b.search().desc?null:!0),b.search("sortBy",a)}function l(a,c){var d=b.search().sortBy||"?ordinal",e=c?"glyphicon-sort-by-order":"glyphicon-sort-by-alphabet";return d===a?b.search().desc?e+"-alt":e:void 0}this.getResults=h,this.getFacets=i,this.getFacetOptions=j,this.updateSortBy=k,this.getSortClass=l;var m={entryText:{facetId:"entryText",graph:"<http://ldf.fi/nbf/people>",name:"Haku",enabled:!0},dataset:{facetId:"dataset",predicate:"<http://purl.org/dc/terms/source>",name:"Tietokanta"},slider:{facetId:"slider",name:"Rajaa henkilöiden syntymäaika",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>/<http://vocab.getty.edu/ontology#estStart>",enabled:!0},link:{facetId:"link",choices:[{id:"wikipedia",pattern:"?id <http://ldf.fi/nbf/wikipedia> [] .",label:"Wikipedia"},{id:"wikidata",pattern:"?id <http://ldf.fi/nbf/wikidata> [] .",label:"Wikidata"},{id:"sotasampo",pattern:"?id <http://ldf.fi/nbf/warsampo> [] .",label:"Sotasampo"},{id:"norssit",pattern:"?id <http://ldf.fi/nbf/norssi> [] .",label:"Norssit"},{id:"kirjasampo",pattern:"?id <http://ldf.fi/nbf/kirjasampo> [] . ",label:"Kirjasampo"},{id:"blf",pattern:"?id <http://ldf.fi/nbf/blf> [] .",label:"BLF"},{id:"ulan",pattern:"?id <http://ldf.fi/nbf/ulan> [] .",label:"ULAN"},{id:"viaf",pattern:"?id <http://ldf.fi/nbf/viaf> [] .",label:"VIAF"},{id:"genicom",pattern:"?id <http://ldf.fi/nbf/genicom> [] .",label:"Geni.com"},{id:"website",pattern:"?id <http://ldf.fi/nbf/website> [] .",label:"Kotisivu"},{id:"eduskunta",pattern:"?id <http://ldf.fi/nbf/eduskunta> [] .",label:"Eduskunta"}],enabled:!0,name:"Linkit"},period:{facetId:"period",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_period>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Ajanjakso",enabled:!0},author:{facetId:"author",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_biography>/<http://schema.org/author>",name:"Kirjoittaja"},birthYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>/<http://ldf.fi/nbf/time>",name:"Synnyinaika",enabled:!0},place:{facetId:"place",predicate:"<http://xmlns.com/foaf/0.1/focus>/(^<http://www.cidoc-crm.org/cidoc-crm/P98_brought_into_life>|^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>)/<http://ldf.fi/nbf/place>/<http://www.w3.org/2004/02/skos/core#prefLabel>",name:"Paikkakunta",enabled:!0},deathYear:{facetId:"birthYear",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://www.cidoc-crm.org/cidoc-crm/P100_was_death_of>/<http://ldf.fi/nbf/time>",name:"Kuolinaika",enabled:!0},title:{facetId:"title",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/has_title>",name:"Arvo, ammatti tai toiminta",hierarchy:"<http://www.w3.org/2004/02/skos/core#broader>",depth:3,enabled:!0},company:{facetId:"company",predicate:"<http://xmlns.com/foaf/0.1/focus>/^<http://ldf.fi/schema/bioc/inheres_in>/<http://ldf.fi/nbf/related_company>",name:"Yritys tai yhteisö",enabled:!0},category:{facetId:"category",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/has_category>",name:"Toimiala",enabled:!0},gender:{facetId:"gender",predicate:"<http://xmlns.com/foaf/0.1/focus>/<http://ldf.fi/nbf/sukupuoli>",name:"Sukupuoli",enabled:!0}},n=" PREFIX owl: <http://www.w3.org/2002/07/owl#>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX dct: <http://purl.org/dc/terms/>  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX xml: <http://www.w3.org/XML/1998/namespace>  PREFIX bioc: <http://ldf.fi/schema/bioc/>  PREFIX nbf: <http://ldf.fi/nbf/>  PREFIX categories:	<http://ldf.fi/nbf/categories/>  PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>  PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#>  PREFIX gvp: <http://vocab.getty.edu/ontology#> ",o='SELECT DISTINCT ?id ?evt ?person__name ?time__start ?time__end ?class ?place__uri ?place__label ?place__latitude ?place__longitude WHERE {   { SELECT DISTINCT ?id WHERE {    { <RESULT_SET> }   } LIMIT 2500 }   ?id foaf:focus ?prs .   ?id skosxl:prefLabel ?person__label .   OPTIONAL { ?person__label schema:familyName ?person__fname }   OPTIONAL { ?person__label schema:givenName ?person__gname }   BIND (CONCAT(COALESCE(?person__gname, "")," ",COALESCE(?person__fname, "")) AS ?person__name)   { ?evt crm:P100_was_death_of ?prs . }   UNION   { ?evt crm:P98_brought_into_life ?prs . }     ?evt nbf:time ?time .   OPTIONAL { ?time gvp:estStart ?time__start. }   OPTIONAL { ?time gvp:estEnd ?time__end. }   FILTER (BOUND(?time__start) || BOUND(?time__end))      ?evt a/skos:prefLabel ?class .   FILTER (lang(?class)="en")     ?evt nbf:place ?place__uri .      ?place__uri geo:lat ?place__latitude ;           geo:long ?place__longitude ;          skos:prefLabel ?place__label . 	FILTER (lang(?place__label)="fi") } ORDER BY ?person__fname',p={endpointUrl:e,usePost:!0},q={endpointUrl:p.endpointUrl,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",constraint:"?id <http://ldf.fi/nbf/ordinal> ?ordinal . ",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},r={mapper:g,queryTemplate:o,prefixes:n,paging:!1,pagesPerQuery:1},s=(new d(p,r),new f(p,g))}angular.module("facetApp").service("groupmapService",a),a.$inject=["$q","$location","_","FacetResultHandler","SPARQL_ENDPOINT_URL","AdvancedSparqlService","personMapperService"]}(),function(){"use strict";function a(a,b,c,d){function e(a,d){var e="navbar-fi.html";return b(e).then(function(a){return d.html(a),b("views/subnavbar.html")}).then(function(b){return angular.element("#subnav").html(b),c(d.contents())(a)})}function f(){function a(){d.open({templateUrl:"views/help.html",size:"lg"})}var b=this;b.showHelp=a}return{link:e,controller:f,controllerAs:"vm"}}angular.module("facetApp").directive("wsNavbar",a),a.$inject=["$location","$templateRequest","$compile","$uibModal"]}(),function(){"use strict";function a(a,b,c){function d(){return c.login(e.un,e.pw).then(function(c){return c?a.transitionTo("cards",b,{reload:!0,inherit:!1,notify:!0}):void(e.error="Kirjautuminen epäonnistui")})}var e=this;e.login=d}angular.module("facetApp").controller("LoginController",a),a.$inject=["$state","$stateParams","loginService"]}(),function(){"use strict";function a(a,b,c,d,e){function f(){d.getPerson(a.personId).then(function(a){return i.person=a,d.getBios(i.person.id).then(function(a){a.length&&(a.forEach(function(a){a.description&&(a.description=e.trustAsHtml(a.description)),a.source_paragraph&&(a.source_paragraph=e.trustAsHtml(a.source_paragraph)),a.lead_paragraph&&(a.lead_paragraph=e.trustAsHtml(a.lead_paragraph))}),i.person.bios=a)}),d.getSimilar(i.person.id).then(function(a){a.length&&(i.person.similar=a)}),a})["catch"](h)}function g(){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return i.person}}})}function h(a){
i.isLoadingResults=!1,i.error=a}var i=this;i.openPage=g,f()}angular.module("facetApp").controller("DetailController",a),a.$inject=["$stateParams","$uibModal","_","nbfService","$sce"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){b.reload()}function k(){r.tableParams=new g({count:e},{getData:n})}function l(a){c.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return a}}})}function m(){var a=f.getFacetOptions();return a.initialState=i.getFacetValuesFromUrlParams(),a}function n(a){return r.isLoadingResults=!0,r.pager.getPage(a.page()-1,a.count()).then(function(a){return r.pager.getTotalCount().then(function(b){return r.tableParams.total(b),a}).then(function(a){return r.isLoadingResults=!1,a})})}function o(a,b){return i.updateUrlParams(b),r.previousSelections=d.clone(b.constraint),p(b)}function p(a){r.isLoadingResults=!0,f.getResults(a).then(function(a){r.pager=a,r.tableParams?(r.tableParams.page(1),r.tableParams.reload()):k()})}function q(a){return f.updateSortBy(a),p({constraint:r.previousSelections})}var r=this;r.openPage=l,r.removeFacetSelections=j,r.sortBy=q,r.getSortClass=f.getSortClass;var s=a.$on("sf-initial-constraints",function(a,b){o(a,b),s()});a.$on("sf-facet-constraints",o),f.getFacets().then(function(b){r.facets=b,r.facetOptions=m(),r.facetOptions.scope=a,r.handler=new h(r.facetOptions)})}angular.module("facetApp").controller("TableController",a),a.$inject=["$scope","$state","$uibModal","_","RESULTS_PER_PAGE","nbfService","NgTableParams","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d){function e(){d.getEvents(a.personId).then(function(a){return m.currentEvent=".",m.events=a,a.length&&(m.person=a[0]),m.events=f(a,m),m.viewBox="1930,-10,120,27",h(m),a})["catch"](k)}function f(a,b){var c=(new Date).getFullYear(),d=!1,e=0;b.min_time=c,b.max_time=0;var f={};a.forEach(function(a){a.place&&a.place.uri&&(["uri","latitude","longitude"].forEach(function(b){a.place[b]&&a.place[b].constructor!==Array&&(a.place[b]=[a.place[b]])}),a.place.uri.forEach(function(b){f.hasOwnProperty(b)||(f[b]={count:0,latitude:a.place.latitude,longitude:a.place.longitude,type:a["class"]}),f[b].count+=1}))});var h=[[],[],[],[]];return a.forEach(function(a){a.y=0,a.r=1,a.markers=[],a.blobs=[],a.time.span.constructor!==Array&&(a.time.span=[a.time.span]),a.time.span.forEach(function(c){var d=c.split("-"),e={};""!=d[0]&&(d[0]=parseInt(d[0]),d[0]<b.min_time&&(b.min_time=d[0]),b.max_time<d[0]&&(b.max_time=d[0]),e.estStart=d[0]),""!=d[1]&&(d[1]=parseInt(d[1]),d[1]<b.min_time&&(b.min_time=d[1]),b.max_time<d[1]&&(b.max_time=d[1]),e.estEnd=d[1]),a.blobs.push(e)}),a.label||(a.label=""),a["class"]||(a["class"]="event"),a["class"]=a["class"].toLowerCase();var c=0;switch(a["class"]){case"death":d=!0,a.label="Kuollut "+a.label,a.r=1.5;break;case"birth":a.label="Syntynyt "+a.label,a.place&&a.place.latitude&&(b.map.center={latitude:a.place.latitude[0],longitude:a.place.longitude[0]}),a.r=1.5,b.min_time<a.blobs[0].estStart&&(b.min_time=a.blobs[0].estStart);break;case"spouse":case"child":a.relative&&(a.relativelink=a.relative),a.label=a.label+", "+a.time.label;break;case"career":a.y=5,c=1;break;case"product":a.y=10,c=2;break;case"honour":a.y=15,c=3;break;default:a.y=5,a["class"]="event",c=1}if(h[c].push(a),a.id=++e,a.place&&a.place.latitude)for(var i=0;i<a.place.latitude.length;i++){var j=a.place.uri[i]&&f[a.place.uri[i]]&&f[a.place.uri[i]].count?15*Math.sqrt(f[a.place.uri[i]].count):15,k=g(a.place.latitude[i],a.place.longitude[i],a.id,a["class"],j);a.markers.push(k),b.markers.push(k)}}),h.forEach(function(a){l(a).forEach(function(b){a[b].y+=2.5})}),d||(b.max_time+=15),b.max_time<=b.min_time&&(b.max_time=b.min_time+75),b.max_time>b.min_time+150&&(b.max_time=b.min_time+150),b.max_time>c&&(b.max_time=c),a.forEach(function(a){a.path="";var c=.1*Math.random();a.blobs.forEach(function(d){var e=d.estStart?i(d.estStart,b.min_time,b.max_time)+c:void 0,f=d.estEnd?i(d.estEnd,b.min_time,b.max_time)+c:void 0;e?f?a.path+="M"+e+","+(a.y-a.r)+" a"+a.r+","+a.r+",0,0,0,0,"+2*a.r+" H"+f+" a"+a.r+","+a.r+",0,0,0,0,-"+2*a.r+" Z":(f=e+3,a.path+="M"+f+","+(a.y-a.r)+" H"+e+" a"+a.r+","+a.r+",0,0,0,0,"+2*a.r+" H"+f):(e=f-3,a.path+="M"+e+","+(a.y+a.r)+" H"+f+" a"+a.r+","+a.r+",0,0,0,0,-"+2*a.r+" H"+e)}),a.blobs=[]}),a}function g(a,b,c,d,e){e||(e=15);var f={death:"#ff4141",birth:"#777fff",spouse:"#c3b981",child:"#7f6780",career:"#999999",product:"#83d236",honour:"#ce5c00",event:"#999999"},g={latitude:a,longitude:b,id:n++,options:{icon:{path:"M-"+e+" 0 A "+e+","+e+", 0 ,1, 1,"+e+",0 A"+e+","+e+",0,1,1,-"+e+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:f[d],fillOpacity:.6,strokeOpacity:.5,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},zIndex:c,optimized:!1,label:{text:""+c,fontSize:"14px",fontFamily:'"Courier New", Courier,Monospace',color:"black"}}};return g}function h(a){for(var b=a.min_time,c=a.max_time,d=[],e=[{x:-2.5,y:0,content:"Elinkaari"},{x:-2.5,y:5,content:"Ura"},{x:-2.5,y:10,content:"Teokset"},{x:-2.5,y:15,content:"Kunniamaininnat"}],f=10*Math.ceil(b/10);c>f;f+=10){var g=i(f,b,c);d.push({x1:g,x2:g,y1:0,y2:15}),e.push({x:g+1,y:-2,content:""+f})}for(var h=0;20>h;h+=5)d.push({x1:i(b,b,c),x2:i(c,b,c),y1:h,y2:h});a.mainline={lines:d,texts:e}}function i(a,b,c){return a-b}function j(){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return m.person}}})}function k(a){m.isLoadingResults=!1,m.error=a}function l(a){for(var b={},c=a.length,d=0;c>d;d++)a[d].blobs.forEach(function(a){for(var c=a.estStart?a.estStart:a.estEnd-3,e=a.estEnd?a.estEnd:c+3,f=c;e>=f;f++)b[f]=d});var e=Array(c).fill(!1);for(var f in b)e[b[f]]=!0;for(var g=[],d=0;c>d;d++)e[d]||g.push(d);return g}var m=this;m.openPage=j,m.map={center:{latitude:62,longitude:24},zoom:6},m.markers=[],m.focusEvent=function(a){m.currentEvent=a.id+": "+a.label,a.markers.forEach(function(a){a.options.icon.strokeWeight=4,a.options.zIndex+=100,setTimeout(function(){a.options.animation=null},1200)})},m.unfocusEvent=function(a){m.currentEvent=".",a.markers.forEach(function(a){a.options.icon.strokeWeight=1,a.options.zIndex-=100})},e();var n=1}angular.module("facetApp").controller("MapController",a),a.$inject=["$stateParams","$uibModal","_","mapService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){function j(){c.reload()}function k(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function l(){return r.isLoadingResults||nextPageNo>maxPage}function m(a,b){return r.previousSelections&&e.isEqual(b.constraint,r.previousSelections)?void 0:(r.previousSelections=e.clone(b.constraint),h.updateUrlParams(b),n(b))}function n(a){r.isLoadingResults=!0,r.error=void 0;var b=e.uniqueId();return t=b,f.getResults(a).then(function(a){r.events=p(a,r)})["catch"](o)}function o(a){r.isLoadingResults=!1,r.error=a}function p(a,b){var c={};a.forEach(function(a){a["class"]||(a["class"]="event"),a["class"]=a["class"].toLowerCase();var b=a["class"]+a.place.uri;c.hasOwnProperty(b)||(c[b]={count:0,latitude:a.place.latitude,longitude:a.place.longitude,label:a.place.label,type:a["class"],people:{}}),c[b].count+=1,c[b].people[a.id]=a.person.name}),b.markers=[];var d=0;for(var e in c){var f=c[e],g=q(b,f.latitude,f.longitude,++d,f.type,f.count,f.label,f.people);b.markers.push(g)}b.markers.sort(function(a,b){return b.count-a.count});var h=new google.maps.LatLngBounds,i=document.getElementById("ui-gmap-google-map");return i&&i.fitBounds&&i.fitBounds(h),a}function q(b,c,d,e,f,g,h,i){var j=5*Math.sqrt(g),k={death:"#ff4141",birth:"#777fff",spouse:"#c3b981",child:"#7f6780",career:"#999999",product:"#83d236",honour:"#ce5c00",event:"#ABCDEF"},l={count:g,latitude:c,longitude:d,id:e,options:{icon:{path:"M-"+j+" 0 A "+j+","+j+", 0 ,1, 1,"+j+",0 A"+j+","+j+",0,1,1,-"+j+",0 Z",scale:1,anchor:new google.maps.Point(0,0),fillColor:k[f],fillOpacity:.6,strokeOpacity:.2,strokeWeight:1,labelOrigin:new google.maps.Point(0,0)},optimized:!0},onClick:function(){b.place_label=h,"death"==f?b.place_label+=", kuolleet":"birth"==f&&(b.place_label+=", syntyneet");var e=[];for(var g in i)e.push({uri:g,label:i[g]});b.people=e,b.window.position.lat=parseInt(c),b.window.position.lng=parseInt(d),b.showWindow(),a.$apply()}};return l}var r=this;r.map={center:{latitude:62,longitude:24},zoom:6},r.markers=[],r.window={show:!1,position:{lat:60.192059,lng:24.945831}},r.showWindow=function(){r.window.show=!0},r.closeWindow=function(){r.window.show=!1},r.isScrollDisabled=l,r.removeFacetSelections=j,r.getSortClass=f.getSortClass;var s=a.$on("sf-initial-constraints",function(a,b){m(a,b),s()});a.$on("sf-facet-constraints",m),f.getFacets().then(function(b){r.facets=b,r.facetOptions=k(),r.facetOptions.scope=a,r.handler=new g(r.facetOptions)});var t}angular.module("facetApp").controller("GroupmapController",a),a.$inject=["$scope","$location","$state","$uibModal","_","groupmapService","FacetHandler","facetUrlStateHandlerService","EVENT_FACET_CHANGED"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){c.reload()}function j(a){d.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return a}}})}function k(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function l(){var a=e.uniqueId();v=a,t.isLoadingResults=!0,r++<=s?t.pager.getPage(r-1,24).then(function(b){a===v&&(t.people=t.people.concat(b),t.isLoadingResults=!1)})["catch"](q):t.isLoadingResults=!1}function m(){return t.isLoadingResults||r>s}function n(a){return f.updateSortBy(a),p({constraint:t.previousSelections})}function o(a,b){return t.previousSelections&&e.isEqual(b.constraint,t.previousSelections)?void 0:(t.previousSelections=e.clone(b.constraint),h.updateUrlParams(b),p(b))}function p(a){t.isLoadingResults=!0,t.people=[],t.error=void 0;var b=e.uniqueId();w=b,r=0,f.getResults(a).then(function(a){return a.getMaxPageNo().then(function(b){return[a,b]})}).then(function(a){return w===b?(t.pager=a[0],s=a[1],t.isLoadingResults=!1,l()):void 0})["catch"](q)}function q(a){t.isLoadingResults=!1,t.error=a}var r,s,t=this;t.openPage=j,t.nextPage=l,t.isScrollDisabled=m,t.removeFacetSelections=i,t.sortBy=n,t.getSortClass=f.getSortClass,t.people=[];var u=a.$on("sf-initial-constraints",function(a,b){o(a,b),u()});a.$on("sf-facet-constraints",o),f.getFacets().then(function(b){t.facets=b,t.facetOptions=k(),t.facetOptions.scope=a,t.handler=new g(t.facetOptions)});var v,w}angular.module("facetApp").controller("CardsController",a),a.$inject=["$scope","$location","$state","$uibModal","_","nbfService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){c.reload()}function j(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function k(a,b){return o.previousSelections&&d.isEqual(b.constraint,o.previousSelections)?void 0:(o.previousSelections=d.clone(b.constraint),h.updateUrlParams(b),m(b))}function l(a){e.charts.setOnLoadCallback(function(){var b=new e.visualization.DataTable,c=d.map(a,function(a){return parseInt(a.year)}),f=d.map(a,function(a){return[a.year,parseInt(a.count)]}),g={title:"Biografiajakauma vuosikymmenittäin",legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:c},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},h=new e.visualization.ColumnChart(document.getElementById("biography-chart"));b.addColumn("string","Vuosikymmen"),b.addColumn("number","Biografioita"),b.addRows(f),h.draw(b,g)})}function m(a){o.isLoadingResults=!0,o.results=[],o.error=void 0;var b=d.uniqueId();return q=b,f.getStatistics(a).then(function(a){q===b&&l(a)}).then(function(){return f.getResults(a).then(function(a){q===b&&(o.results=a,o.isLoadingResults=!1)})})["catch"](n)}function n(b){o.isLoadingResults=!1,o.error=b,a.error(b)}var o=this;o.removeFacetSelections=i,o.upos=f.upos;var p=b.$on("sf-initial-constraints",function(a,b){k(a,b),p()});b.$on("sf-facet-constraints",k),f.getFacets().then(function(a){o.facets=a,o.facetOptions=j(),o.facetOptions.scope=b,o.handler=new g(o.facetOptions)});var q}angular.module("facetApp").controller("NlpController",a),a.$inject=["$log","$scope","$state","_","google","nlpService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h){function i(){d.reload()}function j(){var a=f.getFacetOptions();return a.initialState=h.getFacetValuesFromUrlParams(),a}function k(a,b){return r.previousSelections&&e.isEqual(b.constraint,r.previousSelections)?void 0:(r.previousSelections=e.clone(b.constraint),h.updateUrlParams(b),p(b).then(function(a){google.charts.setOnLoadCallback(function(){l("occupation","Myöhempi arvo tai ammatti","chart_occupation")}),google.charts.setOnLoadCallback(function(){l("organization","Työnantajat tai jäsenyydet järjestöissä","chart_organization")}),google.charts.setOnLoadCallback(function(){l("eduorganization","Opiskelupaikkoja Norssin jälkeen","chart_eduorganization")}),google.charts.setOnLoadCallback(function(){l("education","Koulutus Norssin jälkeen","chart_education")}),google.charts.setOnLoadCallback(m)}))}function l(a,b,c){var d=n(r.people,a),e=google.visualization.arrayToDataTable([[b,"Lukumäärä"]].concat(d)),f={title:b},g=new google.visualization.PieChart(document.getElementById(c));g.draw(e,f)}function m(){var a="education",b="eduorganization",c={},d={},e=10;$.each(r.people,function(e,f){if(f.hasOwnProperty(a)&&f.hasOwnProperty(b)){var g=f[a],h=f[b];c.hasOwnProperty(g)?c[g]+=1:c[g]=1,d.hasOwnProperty(h)?d[h]+=1:d[h]=1}}),c=$.map(c,function(a,b){return[[b,a]]}).sort(function(a,b){return b[1]-a[1]}),d=$.map(d,function(a,b){return[[b,a]]}).sort(function(a,b){return b[1]-a[1]});var f={},g={};$.each(c,function(a,b){f[b[0]]={index:e-1>a?a:e-1}}),$.each(d,function(a,b){g[b[0]]={index:e-1>a?a:e-1}});var h=$.map(new Array(Math.min(e,c.length)),function(a,b){return[$.map(new Array(Math.min(e,d.length)),function(a,b){return 0})]});$.each(r.people,function(c,d){if(d.hasOwnProperty(a)&&d.hasOwnProperty(b)){var e=d[a],i=d[b];h[f[e].index][g[i].index]+=1}});for(var i=[],j=0;j<h.length;j++)for(var k=0;k<h[j].length;k++)i.push([e-1>k?d[k][0]:"muu laitos",e-1>j?c[j][0]:"muu arvo",h[j][k]]);var l=new google.visualization.DataTable;l.addColumn("string",b),l.addColumn("string",a),l.addColumn("number","Weight"),l.addRows(i);var m={title:"Otsikko",sankey:{node:{label:{fontSize:14,color:"#000",bold:!0},labelPadding:12}}},n=new google.visualization.Sankey(document.getElementById("chart_sankey"));n.draw(l,m)}function n(a,b){return o(a,b).sort(function(a,b){return b[1]-a[1]})}function o(a,b){var c={};return $.each(a,function(a,d){if(d.hasOwnProperty(b)){var e=d[b];c.hasOwnProperty(e)?c[e]+=1:c[e]=1}}),$.map(c,function(a,b){return[[b,a]]})}function p(a){r.isLoadingResults=!0,r.people=[],r.years=[],r.topTitles=[],r.topOrgs=[],r.error=void 0;var b=e.uniqueId();return t=b,f.getResults2(a).then(function(a){return t===b?(r.isLoadingResults=!1,r.people=a[0],a):void 0})["catch"](q)}function q(a){console.log(a),r.isLoadingResults=!1,r.error=a}var r=this;r.people=[],r.startYear=[],r.topTitles=[],r.topOrgs=[],r.removeFacetSelections=i,google.charts.load("current",{packages:["corechart","line","sankey"]});var s=a.$on("sf-initial-constraints",function(a,b){k(a,b),s()});a.$on("sf-facet-constraints",k),f.getFacets().then(function(b){r.facets=b,r.facetOptions=j(),r.facetOptions.scope=a,r.handler=new g(r.facetOptions)});var t}angular.module("facetApp").controller("VisuController",a),a.$inject=["$scope","$location","$q","$state","_","visuService","FacetHandler","facetUrlStateHandlerService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j){function k(){d.reload()}function l(){var a=g.getFacetOptions();return a.initialState=i.getFacetValuesFromUrlParams(),a}function m(a,b){return s.previousSelections&&e.isEqual(b.constraint,s.previousSelections)?void 0:(s.previousSelections=e.clone(b.constraint),i.updateUrlParams(b),q(b).then(function(a){f.charts.setOnLoadCallback(function(){n(s.ages,[1,120],"Elinikä","chart_age")}),f.charts.setOnLoadCallback(function(){n(s.marriageAges,[1,120],"Naimisiinmenoikä","chart_marriageAge")}),f.charts.setOnLoadCallback(function(){n(s.firstChildAges,[1,120],"Lapsensaanti-ikä","chart_firstChildAge")}),f.charts.setOnLoadCallback(function(){n(s.numberOfChildren,[1,25],"Lasten lukumäärä","chart_numberOfChildren")}),f.charts.setOnLoadCallback(function(){n(s.numberOfSpouses,[1,7],"Puolisoiden lukumäärä","chart_numberOfSpouses")})}))}function n(a,b,c,d){for(var e=new Array(b[1]-b[0]+1),g=0;g<e.length;g++)e[g]=[];for(var g=0;g<a.length;g++){var h=a[g];e[parseInt(h.value)].push(h.id)}for(var i=[],g=0;g<e.length;g++)i[g]=[g,e[g].length];var j=p(i),k=new f.visualization.DataTable,l={title:c+", otos: "+j[0]+", keskiarvo: "+j[1].toFixed(2)+", keskihajonta: "+j[2].toFixed(2),legend:{position:"none"},tooltip:{format:"none"},colors:["blue"],hAxis:{slantedText:!1,maxAlternation:1,format:"",ticks:o(b)},vAxis:{maxValue:4},width:"95%",bar:{groupWidth:"88%"},height:500},m=new f.visualization.ColumnChart(document.getElementById(d));k.addColumn("number","Ikä"),k.addColumn("number","Henkilöä"),k.addRows(i),m.draw(k,l),f.visualization.events.addListener(m,"select",function(){var a=m.getSelection();s.people=e[a[0].row],s.showForm()})}function o(a){for(var b=[],c=10*Math.floor(1+a[0]/10);c<a[1];)b.push(c),c+=10;return b}function p(a){var b=0,c=0,d=0;if($.each(a,function(a,e){var f=e[0]*e[1];b+=f,c+=e[0]*f,d+=e[1]}),d>0){var e=b/d;return[d,e,Math.sqrt(c/d-e*e)]}return[0,0,0]}function q(a){s.isLoadingResults=!0,s.ages=[],s.marriageAges=[],s.firstChildAges=[],s.numberOfChildren=[],s.numberOfSpouses=[],s.error=void 0;var b=e.uniqueId();return u=b,g.getResults(a).then(function(a){return u===b?(s.isLoadingResults=!1,s.ages=a[0],s.marriageAges=a[1],s.firstChildAges=a[2],s.numberOfChildren=a[3],s.numberOfSpouses=a[4],a):void 0})["catch"](r)}function r(a){console.log(a),s.isLoadingResults=!1,s.error=a}var s=this;s.people=[],s.startYear=[],s.showForm=function(){j.open({templateUrl:"views/visu.popup.html",scope:a})},s.removeFacetSelections=k;var t=a.$on("sf-initial-constraints",function(a,b){m(a,b),t()});a.$on("sf-facet-constraints",m),g.getFacets().then(function(b){s.facets=b,s.facetOptions=l(),s.facetOptions.scope=a,s.handler=new h(s.facetOptions)});var u}angular.module("facetApp").controller("VisuController2",a),a.$inject=["$scope","$location","$q","$state","_","google","visuService","FacetHandler","facetUrlStateHandlerService","$uibModal"]}(),function(){"use strict";function a(a,b,c,d,e){function f(a){var b=a.constraint.join(" "),c=o.replace("<RESULT_SET>",b);return u.getObjectsNoGrouping(c)}function g(a){var b=a.constraint.join(" "),c=p.replace("<RESULT_SET>",b);return u.getObjectsNoGrouping(c)}function h(a){var b=a.constraint.join(" "),c=n.replace("<RESULT_SET>",b);return u.getObjectsNoGrouping(c)}function i(a){var b=a.constraint.join(" "),c=q.replace(/<RESULT_SET>/g,b);return u.getObjectsNoGrouping(c)}function j(a){var b=a.constraint.join(" "),c=r.replace(/<RESULT_SET>/g,b);return u.getObjectsNoGrouping(c)}function k(b){var c=[this.getAge(b),this.getMarriageAge(b),this.getFirstChildAge(b),this.getNumberOfChildren(b),this.getNumberOfSpouses(b)];return a.all(c)}function l(){return t}this.getAge=h,this.getMarriageAge=f,this.getFirstChildAge=g,this.getNumberOfChildren=i,this.getNumberOfSpouses=j,this.getResults=k,this.getFacets=d.getFacets,this.getFacetOptions=l;var m="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX	nbf:	<http://ldf.fi/nbf/>  PREFIX	categories:	<http://ldf.fi/nbf/categories/>  PREFIX	gvp:	<http://vocab.getty.edu/ontology#>	 PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX	relations:	<http://ldf.fi/nbf/relations/> PREFIX	sources:	<http://ldf.fi/nbf/sources/> ",n=m+'SELECT DISTINCT (?id AS ?id__uri) ?id__name ?value WHERE {  { <RESULT_SET> }   ?id foaf:focus/^crm:P100_was_death_of/nbf:time [ gvp:estStart ?time ; gvp:estEnd ?time2 ] ;       foaf:focus/^crm:P98_brought_into_life/nbf:time [ gvp:estStart ?birth ; gvp:estEnd ?birth2 ] .   BIND (xsd:integer(0.5*(year(?time)+year(?time2)-year(?birth)-year(?birth2))) AS ?value)   FILTER (-1<?value && ?value<120)      ?id skosxl:prefLabel ?id__label .     OPTIONAL { ?id__label schema:familyName ?id__fname }     OPTIONAL { ?id__label schema:givenName ?id__gname }     BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name)  } ORDER BY ?value ?id__fname ?id__gname ',o=m+'SELECT DISTINCT (?id AS ?id__uri) ?id__name ?value  WHERE {      {     SELECT DISTINCT ?id (min(?age) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Spouse }       ?id bioc:has_family_relation [ a ?rel ;  nbf:time/gvp:estStart ?time ] ;                                      foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .       BIND (year(?time)-year(?birth) AS ?age)       FILTER (13<?age && ?age<120)}    GROUP BY ?id }    FILTER (BOUND(?id))  	?id skosxl:prefLabel ?id__label .       OPTIONAL { ?id__label schema:familyName ?id__fname }       OPTIONAL { ?id__label schema:givenName ?id__gname }       BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY ?value ?id__fname ?id__gname ',p=m+'SELECT DISTINCT (?id AS ?id__uri) ?id__name ?value  WHERE {      {     SELECT DISTINCT ?id (min(?age) AS ?value)     WHERE {       { <RESULT_SET> }       VALUES ?rel { relations:Child relations:Son relations:Daughter }       ?id bioc:has_family_relation [ a ?rel ;  nbf:time/gvp:estStart ?time ] ;                                      foaf:focus/^crm:P98_brought_into_life/nbf:time/gvp:estStart ?birth .       BIND (year(?time)-year(?birth) AS ?age)       FILTER (13<?age && ?age<120)}     GROUP BY ?id }    FILTER (BOUND(?id))  	?id skosxl:prefLabel ?id__label .       OPTIONAL { ?id__label schema:familyName ?id__fname }       OPTIONAL { ?id__label schema:givenName ?id__gname }       BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY ?value ?id__fname ?id__gname ',q=m+'SELECT DISTINCT (?id as ?id__uri) ?id__name ?value WHERE {   {       SELECT DISTINCT ?id (count(?rel) AS ?value)       WHERE { { <RESULT_SET> }         VALUES ?rel { relations:Child relations:Son relations:Daughter }         ?id bioc:has_family_relation/a ?rel . }        GROUP BY ?id }   UNION {     	{ <RESULT_SET> }       ?id dcterms:source sources:source1 ;           foaf:focus/nbf:has_biography/nbf:has_paragraph/nbf:id "2"^^xsd:integer .       FILTER not exists { ?id bioc:has_family_relation/a relations:Child } 	   BIND (0 AS ?value) }   FILTER (BOUND(?id))   ?id skosxl:prefLabel ?id__label .       OPTIONAL { ?id__label schema:familyName ?id__fname }       OPTIONAL { ?id__label schema:givenName ?id__gname }       BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY ?value ?id__fname ?id__gname ',r=m+'SELECT DISTINCT (?id as ?id__uri) ?id__name ?value WHERE {   {       SELECT DISTINCT ?id (count(?rel) AS ?value)       WHERE { { <RESULT_SET> }         VALUES ?rel { relations:Spouse }         ?id bioc:has_family_relation/a ?rel . }        GROUP BY ?id }   UNION {     	{ <RESULT_SET> }       ?id dcterms:source sources:source1 ;           foaf:focus/nbf:has_biography/nbf:has_paragraph/nbf:id "2"^^xsd:integer .       FILTER not exists { ?id bioc:has_family_relation/a relations:Spouse } 	   BIND (0 AS ?value) }   FILTER (BOUND(?id))   ?id skosxl:prefLabel ?id__label .       OPTIONAL { ?id__label schema:familyName ?id__fname }       OPTIONAL { ?id__label schema:givenName ?id__gname }       BIND (CONCAT(COALESCE(?id__gname, "")," ",COALESCE(?id__fname, "")) AS ?id__name) } ORDER BY ?value ?id__fname ?id__gname ',s=e,t={endpointUrl:s,rdfClass:"<http://ldf.fi/nbf/PersonConcept>",preferredLang:"fi",noSelectionString:"-- Ei valintaa --"},u=new b(s,c)}angular.module("facetApp").service("visuService",a),a.$inject=["$q","AdvancedSparqlService","objectMapperService","facetService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function a(a,b,c,d){function e(){d.getPlace(a.placeId).then(function(a){return console.log(a),f(a,i),console.log(i.place),i.place})["catch"](h)}function f(a,b){var c=[],d=[],e=[];a.forEach(function(a){var b=a.prs;switch(b.event){case"http://ldf.fi/nbf/Birth":c.push(b);break;case"http://ldf.fi/nbf/Death":d.push(b);break;default:b.label=b.label+": "+b.eventLabel,e.push(b)}}),b.place={id:a[0].id,label:a[0].label},b.place.born=c,b.place.died=d,b.place.event=e}function g(){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return i.place}}})}function h(a){i.isLoadingResults=!1,i.error=a}var i=this;i.openPage=g,e()}angular.module("facetApp").controller("PlaceController",a),a.$inject=["$stateParams","$uibModal","_","placeService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){var b="VALUES ?id { <"+a+"> } . ",c=k.replace("<RESULT_SET>",b);return m.getObjectsNoGrouping(c)}function i(b){var c=[this.getPlace(b)];return a.all(c)}this.getPlace=h,this.getResults=i;var j="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX	nbf:	<http://ldf.fi/nbf/>  PREFIX	categories:	<http://ldf.fi/nbf/categories/>  PREFIX	gvp:	<http://vocab.getty.edu/ontology#>	 PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX	relations:	<http://ldf.fi/nbf/relations/> PREFIX	sources:	<http://ldf.fi/nbf/sources/> ",k=j+' SELECT distinct ?id ?label ?prs__event ?prs__eventLabel ?prs__id ?prs__label  WHERE {    { <RESULT_SET> }    ?id a nbf:Place ;        skos:prefLabel ?label . FILTER (lang(?label)="fi")    { OPTIONAL { ?prs__id foaf:focus/^crm:P98_brought_into_life [ nbf:place ?id ; a ?prs__event ] }    } UNION {    OPTIONAL { ?prs__id foaf:focus/^crm:P100_was_death_of [ nbf:place ?id ; a ?prs__event ] }    } UNION {     OPTIONAL { ?prs__id foaf:focus/^bioc:inheres_in  [ nbf:place ?id ; a ?prs__event ; skos:prefLabel ?prs__eventLabel ] }    }    ?prs__id skosxl:prefLabel ?prs__lab .      OPTIONAL { ?prs__lab schema:familyName ?prs__fname }      OPTIONAL { ?prs__lab schema:givenName ?prs__gname }      BIND (CONCAT(COALESCE(?prs__gname, "")," ",COALESCE(?prs__fname, "")) AS ?prs__label )  } ',l=g,m=new d(l,f)}angular.module("facetApp").service("placeService",a),a.$inject=["$q","$location","_","AdvancedSparqlService","FacetResultHandler","objectMapperService","SPARQL_ENDPOINT_URL"]}(),function(){"use strict";function a(a,b,c,d){function e(){d.getTitle(a.titleId).then(function(a){return h.title=a[0],h.title})["catch"](g)}function f(){b.open({component:"registerPageModal",size:"lg",resolve:{person:function(){return h.title}}})}function g(a){h.isLoadingResults=!1,h.error=a}var h=this;h.openPage=f,e()}angular.module("facetApp").controller("TitleController",a),a.$inject=["$stateParams","$uibModal","_","titleService"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){function h(a){var b="VALUES ?id { <"+a+"> } . ",c=k.replace("<RESULT_SET>",b);return console.log(c),m.getObjectsNoGrouping(c)}function i(b){var c=[this.getPlace(b)];return a.all(c)}this.getTitle=h,this.getResults=i;var j="PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX xsd: <http://www.w3.org/2001/XMLSchema#> PREFIX bioc:  <http://ldf.fi/schema/bioc/>  PREFIX rdfs:  <http://www.w3.org/2000/01/rdf-schema#>  PREFIX schema: <http://schema.org/>  PREFIX skos:  <http://www.w3.org/2004/02/skos/core#>  PREFIX skosxl: <http://www.w3.org/2008/05/skos-xl#>  PREFIX	nbf:	<http://ldf.fi/nbf/>  PREFIX	categories:	<http://ldf.fi/nbf/categories/>  PREFIX	gvp:	<http://vocab.getty.edu/ontology#>	 PREFIX crm:   <http://www.cidoc-crm.org/cidoc-crm/>  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>  PREFIX dcterms: <http://purl.org/dc/terms/>  PREFIX foaf: <http://xmlns.com/foaf/0.1/>  PREFIX gvp: <http://vocab.getty.edu/ontology#> PREFIX	relations:	<http://ldf.fi/nbf/relations/> PREFIX	sources:	<http://ldf.fi/nbf/sources/> ",k=j+" SELECT distinct ?id ?label   WHERE {  	 { <RESULT_SET> }    ?id a nbf:Title ;    skos:prefLabel ?label .}",l=g,m=new d(l,f)}angular.module("facetApp").service("titleService",a),a.$inject=["$q","$location","_","AdvancedSparqlService","FacetResultHandler","objectMapperService","SPARQL_ENDPOINT_URL"]}(),angular.module("facetApp").run(["$templateCache",function(a){"use strict";a.put("views/cards.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.partial.html\'"></div> </div> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> <b>Järjestä:</b> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/cards.partial.html\'"></div> </div> </div> </div>'),a.put("views/cards.partial.html",'<img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div infinite-scroll="vm.nextPage()" infinite-scroll-disabled="vm.isScrollDisabled()" infinite-scroll-distance="0"> <div class="row"> <div ng-repeat="person in vm.people" class="person-container"> <div class="col-xs-12 col-sm-12 person-panel col-md-4 col-lg-3"> <div class="thumbnail"> <a ui-sref="person.detail({ personId: person.id })"> <div class="person-profile-img vertical-center"> <img class="img img-responsive center-block media-middle" ng-src="{{ ::person.images | first }}"> </div> </a> <div class="caption"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12 col-sm-3 col-md-12"> <b><a ui-sref="person.detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b> </div> <div class="col-xs-12 col-sm-9 col-md-12"> <p ng-if="::(person.birthPlace || person.birthDate || person.deathDate)"> &#8727;&nbsp;<span ng-if="::person.birthPlace">{{ ::person.birthPlace }}</span> {{ ::person.birthDate }} <span ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace }}&nbsp;{{ ::person.deathDate }}</span> </p> </div> <div ng-if="::person.occupation" class="col-xs-12"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a title="Näytä matrikkeliteksti" ng-attr-title="{{ showText ? \'Piilota matrikkeliteksti\' : \'Näytä matrikkeliteksti\' }}" href="" ng-click="showText = !showText"><span class="glyphicon" ng-class="{ \'glyphicon-collapse-down\': !showText, \'glyphicon-collapse-up\': showText }" aria-hidden="true"></span></a> <a title="Kansallisbiografia" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="::person.hasAchievements" class="col-xs-6"> <a href="" class="link" ng-click="vm.getAchievements(person)" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto right">Saavutukset</a> </div> <div ng-if="::person.wikipedia" class="col-xs-6"> <a ng-href="{{ ::person.wikipedia }}">Wikipedia</a> </div> <div ng-if="::person.wikidata" class="col-xs-6"> <a ng-href="{{ ::person.wikidata }}">Wikidata</a> </div> <div ng-if="::person.fennica[0]" class="col-xs-6"> <a ng-href="{{ ::person.fennica[0] }}">Fennica</a> </div> <div ng-if="::person.fennica[1]" class="col-xs-6"> <a ng-href="{{ ::person.fennica[1] }}">Fennica (2)</a> </div> <div ng-if="::person.warsampo" class="col-xs-6"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsampo }}">Sotasampo</a> </div> <div ng-if="::person.norssi" class="col-xs-6"> <a ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ ::person.norssi }}">Norssi</a> </div> <div ng-if="::person.kirjasampo" class="col-xs-6"> <a ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="::person.blf" class="col-xs-6"> <a ng-href="{{ ::person.blf }}">BLF</a> </div> <div ng-if="::person.ulan" class="col-xs-6"> <a ng-href="{{ ::person.ulan }}">ULAN</a> </div> <div ng-if="::person.viaf" class="col-xs-6"> <a ng-href="{{ ::person.viaf }}">VIAF</a> </div> <div ng-if="::person.norssit" class="col-xs-6"> <a ng-href="{{ ::person.norssit }}">Norssit</a> </div> <div ng-if="::person.eduskunta" class="col-xs-6"> <a ng-href="{{ ::person.eduskunta }}">Eduskunta</a> </div> <div ng-if="::person.website" class="col-xs-6"> <a ng-href="{{ ::person.website }}">Kotisivu</a> </div> <div ng-if="::person.genicom" class="col-xs-6"> <a ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> </div> <div ng-if="::person.genitree" class="col-xs-6"> <a ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </div> </div> <div ng-if="::person.relative" class="row"> <div class="col-xs-12">Sukulaiset:</div> <div class="col-sm-6 col-md-12" ng-repeat="relative in person.relative | castArray"> {{ ::relative.type }} <a ui-sref="person.detail({ personId: relative.id })">{{ ::relative.name }}</a> </div> </div> <div ng-if="::person.hobby" class="row"> <div class="col-md-12"> <p>Harrastukset: {{ ::person.hobby | castArray | join: \', \' }}</p> </div> </div> <div uib-collapse="!showText"> <hr> <p ng-bind-html="::person.lead_paragraph"></p> </div> </div> </div> </div> </div> <div class="clearfix visible-lg-block" ng-if="($index + 1) % 4 == 0"></div> <div class="clearfix visible-md-block" ng-if="($index + 1) % 3 == 0"></div> <div class="clearfix visible-sm-block" ng-if="($index + 1) % 1 == 0"></div> <div class="clearfix visible-xs-block" ng-if="($index + 1) % 1 == 0"></div> </div> </div> </div>'),
a.put("views/description.partial.html",'<h1>Semanttinen Kansallisbiografia</h1> <p> Kansallisbiografian matrikkelihaku. Voit rajata tulosta tekemällä valintoja suodattimista ja selata henkilöihin liittyvää tietoa linkkien kautta. Lähde: <a href="http://www.kansallisbiografia.fi/">Biografiakeskus</a> </p>'),a.put("views/description.statistics.partial.html",'<h1>Semanttinen Kansallisbiografia</h1> <p> Aineistosta luotuja tilastoja. Esitykset luodaan vasemmanpuoleisissa suodattimissa tehtyjen valintojen perusteella. Lähde: <a href="http://www.kansallisbiografia.fi">Biografiakeskus</a> </p>'),a.put("views/detail.html",'<div class="col-sm-12 col-md-8 text-center" ng-show="vm.person"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <h1>{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="thumbnail"> <div class="person-profile-img"> <div class="row"> <div class="col-sm-12 text-center"> <img ng-repeat="img in vm.person.images" class="person-img img img-responsive" ng-src="{{ img }}"> </div> </div> </div> <div class="caption"> <div class="visible-caption"> <div class="row"> <div class="col-xs-12"> <p ng-if="(vm.person.birthPlace || vm.person.birthDate || vm.person.deathDate)"> <span ng-if="(vm.person.birthPlace || vm.person.birthDate)">&#8727;&nbsp;{{ vm.person.birthPlace }} {{ vm.person.birthDate }}</span> <span ng-if="(vm.person.deathPlace || vm.person.deathDate)">&dagger;&nbsp;{{ vm.person.deathPlace }}</span> <span ng-if="vm.person.deathDate">{{ vm.person.deathDate }}</span> </p> </div> <div ng-if="vm.person.occupation" class="col-xs-12"> <p>{{ vm.person.occupation | castArray | join:\', \' }}</p> </div> <div class="col-xs-12 icon-menu"> <a title="Data" class="" ng-href="{{ vm.person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </div> </div> <div class="row"> <div ng-if="vm.person.wikipedia" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.wikipedia }}">Wikipedia</a> </div> <div ng-if="vm.person.wikidata" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.wikidata }}">Wikidata</a> </div> <div ng-if="vm.person.fennica[0]" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.fennica[0] }}">Fennica</a> </div> <div ng-if="vm.person.fennica[1]" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.fennica[1] }}">Fennica (2)</a> </div> <div ng-if="vm.person.warsampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ vm.person.warsampo }}">Sotasampo</a> </div> <div ng-if="vm.person.kirjasampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.kirjasampo }}">Kirjasampo</a> </div> <div ng-if="vm.person.kulttuurisampo" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.kulttuurisampo }}">Kulttuurisampo</a> </div> <div ng-if="vm.person.blf" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.blf }}">BLF</a> </div> <div ng-if="vm.person.ulan" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.ulan }}">ULAN</a> </div> <div ng-if="vm.person.viaf" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.viaf }}">VIAF</a> </div> <div ng-if="vm.person.eduskunta" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.eduskunta }}">Eduskunta</a> </div> <div ng-if="vm.person.norssi" class="col-xs-6 col-xs-offset-3"> <a ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ vm.person.norssi }}">Norssi</a> </div> <div ng-if="vm.person.website" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.website }}">Kotisivu</a> </div> <div ng-if="vm.person.genicom" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.genicom }}">Kotisivu (Geni.com)</a> </div> <div ng-if="vm.person.genitree" class="col-xs-6 col-xs-offset-3"> <a ng-href="{{ vm.person.genitree }}">Sukupuu (Geni.com)</a> </div> </div> <div ng-if="vm.person.relative" class="row padded-row"> <div class="col-xs-12"><h4>Sukulaiset:</h4></div> <div class="col-sm-6 col-md-12" ng-repeat="relative in vm.person.relative | castArray"> {{ relative.type }}<a ui-sref="person.detail({ personId: relative.id })"> {{ relative.name }}</a> </div> </div> <div ng-if="vm.person.hobby" class="row padded-row"> <div class="col-md-12"> <p><b>Harrastukset:</b> {{ vm.person.hobby | castArray | join: \', \' }}</p> </div> </div> <div class="col-sm-6 col-md-12" ng-repeat="bio in vm.person.bios | castArray"> <div ng-if="bio.database" class="entry-text text-left icon-menu"> <hr> <h4>{{ bio.database }} <a ng-if="bio.link" title="Artikkeli Biografiakeskuksen sivulla" class="" ng-href="{{ bio.link }}"> <span class="glyphicon glyphicon-book" aria-hidden="true"></span> </a></h4> </div> <div ng-if="bio.lead_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="bio.lead_paragraph"></p> </div> <div ng-if="bio.description" class="entry-text text-left"> <hr> <p ng-bind-html="bio.description"></p> </div> <div ng-if="bio.family_paragraph" class="entry-text text-left"> <hr> <p>{{ bio.family_paragraph }}</p> </div> <div ng-if="bio.parent_paragraph" class="entry-text text-left"> <hr> <h4>Vanhemmat</h4> <p>{{ bio.parent_paragraph }}</p> </div> <div ng-if="bio.spouse_paragraph" class="entry-text text-left"> <hr> <h4>Puoliso(t) vanhempineen</h4> <p>{{ bio.spouse_paragraph }}</p> </div> <div ng-if="bio.child_paragraph" class="entry-text text-left"> <hr> <h4>Lapset</h4> <p>{{ bio.child_paragraph }}</p> </div> <div ng-if="bio.medal_paragraph" class="entry-text text-left"> <hr> <h4>Kunniamerkit</h4> <p>{{ bio.medal_paragraph }}</p> </div> <div ng-if="bio.source_paragraph" class="entry-text text-left"> <hr> <p ng-bind-html="bio.source_paragraph"></p> </div> <div class="entry-text text-left"> <hr> <span ng-if="bio.author_text">Kirjoittaja(t): {{ bio.author_text }}. </span> <span ng-if="bio.created">Julkaistu {{ bio.created | date:\'dd.MM.yyyy\' }}</span> <span ng-if="bio.modified">(päivitetty {{ bio.modified | date:\'dd.MM.yyyy\' }})</span> </div> <hr> </div> </div> </div> </div> </div> <div class="col-md-4 text-left" ng-if="vm.person.similar"> <h3>Samankaltaisia henkilöitä</h3> <img ng-if="!vm.person.similar" class="loading-img" src="images/loading-lg.7ba320e0.gif"> <div class="col-sm-6" ng-repeat="person in vm.person.similar"> <a ui-sref="person.detail({ personId: person.prs })">{{ person.label }}</a> </div> </div>  '),a.put("views/directive/ws-related-links-paged.directive.html",'<img src="images/loading.gif" ng-show="!vm.totalItems && vm.isLoadingPage"> <div class="row related" ng-if="vm.totalItems" ng-init="show = true"> <div class="col-sm-12" title="{{ additionalText }}"> <h3 ng-click="show = !show"> <a>{{ title }} ({{ vm.totalItems }}) <span ng-class="[\'glyphicon\', {\'glyphicon-menu-down\': show, \'glyphicon-menu-right\': !show}]"></span> </a> <img src="images/loading.gif" ng-show="vm.isLoadingPage"> </h3> <div uib-collapse="!show"> <ul class="list-group"> <li class="list-group-item" ng-repeat="thing in vm.related"> <span ng-if="!external"> <a ws-page-link="thing.id">{{ vm.getLabel(thing) | words:10 }}</a> </span> <span ng-if="external"> <a ng-href="{{ thing.id }}">{{ vm.getLabel(thing) | words:10 }}</a>  </span></li> <li class="list-group-item" ng-if="vm.totalItems > vm.pageSize"> <ul uib-pagination total-items="vm.totalItems" ng-change="vm.updatePage()" ng-model="vm.currentPage" max-size="5" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" class="pagination-sm no-margin" boundary-links="true"></ul> </li> </ul> </div> </div> </div>'),a.put("views/directive/ws-related-links.directive.html",'<div class="row related" ng-if="related && related.length" ng-init="show = related.length <= 10"> <div class="col-sm-12"> <h3 ng-click="show = !show"> <a>{{ title }} ({{ related.length }}) <span ng-class="[\'glyphicon\', {\'glyphicon-menu-down\': show, \'glyphicon-menu-right\': !show}]"></span> </a> </h3> <div uib-collapse="!show"> <ul class="list-group"> <li class="list-group-item" ng-repeat="thing in related"> <span ng-switch="!!external"> <span ng-switch-when="false"> <a ng-href="{{ thing.id }}">{{ thing.label }}</a> </span> <span ng-switch-when="true"> <a ng-href="{{ thing.id }}">{{ thing.listLabel || thing.getLabel() || thing.label | words:10 }}</a> </span> </span> </li> </ul> </div> </div> </div>'),a.put("views/facets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> <seco-jena-text-facet data-options="vm.facets.entryText"></seco-jena-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <seco-slider-facet data-options="vm.facets.birthYear"></seco-slider-facet> <seco-basic-facet data-options="vm.facets.period"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.familyName"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.author"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-hierarchy-facet data-options="vm.facets.title"></seco-hierarchy-facet> <seco-basic-facet data-options="vm.facets.place"></seco-basic-facet> <!-- \n    <seco-basic-facet data-options="vm.facets.deathYear"></seco-basic-facet> --> </div> </div>'),a.put("views/groupmap.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12" ng-show="!vm.markers && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center"> Kartalla näytetään henkilöiden <span style="color:#777fff">synnyin-</span> ja <span style="color:#ff4141">kuolin</span>paikat. Esitys luodaan vasemmanpuoleisissa suodattimissa tehtyjen valintojen perusteella. Lähde: <a href="http://www.kansallisbiografia.fi">Kansallisbiografia</a> <div class="container-fluid thumbnail"> <div class="col-md-4 pull-md-4 col-lg-3"> <seco-slider-facet data-options="vm.facets.slider"></seco-slider-facet> <div ng-include="\'views/mapfacets.partial.html\'"></div> </div> <div class="container-fluid thumbnail"> <div class="col-md-8 col-lg-9"> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom"> <ui-gmap-window id="ui-gmap-window" show="vm.window.show" options="vm.window" templateurl="\'views/groupmap.popup.html\'" templateparameter="vm" closeclick="vm.closeWindow"> <span></span> </ui-gmap-window> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options" click="marker.onClick()"></ui-gmap-marker> </ui-gmap-google-map> </div> </div> </div> </div> </div></div>'),a.put("views/groupmap.popup.html",'<div class="map-popup"> <div id="popupcontainer" class="col-sm-4 col-md-2 text-center"> <h3 ng-show="parameter.place_label">{{ parameter.place_label }}</h3> <ul class="list-group row list-group-persons ng-scope" id="popupcontainer2"> <li class="list-group-item col-xs-6 ng-scope" ng-show="parameter.people" ng-repeat="person in parameter.people"> <a ui-sref="person.detail({ personId: person.uri })">{{ person.label }}</a> </li> </ul> </div> </div>'),a.put("views/help.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-10 text-left"> <h3 class="modal-title">Kansallisbiografia</h3> </div> <div class="col-xs-2"> <a href="#" ng-click="$close()" class="no-decoration btn-lg pull-right glyphicon glyphicon-remove"></a> </div> </div> </div> <div class="modal-body"> <p>Matrikkelin tietoja voi selata käyttöliittymässä käyttämällä vasemmalla olevia suodattimia. </p> <p>Hakeaksesi rekisteristä tekstihaulla, kirjoita hakutermit ylimpänä olevaan \'Haku\'-kenttään. <br>Poistaaksesi hakurajauksen, paina X-nappia hakukentän oikealla puolella.</p> <p>Jokaisella suodattimella on oma hakukenttä sekä lista suodattimen vaihtoehdoista, josta voi valita haluamansa ehdon. Valitun ehdon antamien tulosten määrä näkyy suluissa valinnan nimen perässä. Rajauksen voi poistaa valitsemalla vaihtoehdon \'-- Ei valintaa --\'.</p> <p>Kustakin suodattimesta voi valita vain yhden vaihtoehdon, jolloin henkilölistausta suodatetaan tämän vaihtoehdon perusteella. Useita eri suodattimia voi käyttää samanaikaisesti. </p> <p> <h4>Suodattimien valinta:</h4> <ol> <li>Valitse joku suodattimista ja avaa suodatin painamalla \'+\'-nappia suodattimen otsikon oikealla puolella.</li> <li>Valitse suodattimeen arvo listalta tai hae kirjoittamalla listan yllä olevaan tekstikenttään. Jos suodatinehtoa haetaan tekstikentän avulla alla oleva lista suodattimista päivittyy kirjoittaessa.</li> <li>Suodatinehdon voi valita klikkaamalla sitä listalta, tai poistaa valitsemalla \'-- Ei valintaa --\' listan alusta. </li> <li>Henkilöiden lista päivittyy suodattimien oikealla puolella.</li> <li>Tuloksia voi nyt suodattaa tarvittaessa lisää toistamalla toisella suodattimella edelliset askeleet 1-4.</li> </ol> </p> </div>'),a.put("views/login.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>Kirjaudu</h1> <div ng-show="vm.error" class="alert alert-danger" role="alert">{{ vm.error }}</div> <form> <div class="form-group"> <label for="un">Käyttäjätunnus</label> <input ng-model="vm.un" type="text" class="form-control" id="un" placeholder="Username"> </div> <div class="form-group"> <label for="pw">Salasana</label> <input ng-model="vm.pw" type="password" class="form-control" id="pw" placeholder="Password"> </div> <button ng-click="vm.login()" type="submit" class="btn btn-default">Submit</button> </form> </div> </div> </div>'),a.put("views/map.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12" ng-show="!vm.person && !vm.error"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif"> </div> <div uib-alert ng-if="vm.error"> {{ vm.error }} </div> <div class="container-fluid text-center" ng-show="vm.person"> <h1>{{ vm.person.givenName }} {{ vm.person.familyName }}</h1> <div class="container-fluid thumbnail"> <div> <div id="labelcontainer" class="col-sm-4 col-md-2 text-center" ng-show="vm.person"> <p ng-repeat="event in ::vm.events" class="{{event.class}}" ng-mouseenter="vm.focusEvent(event)" ng-mouseleave="vm.unfocusEvent(event)"> <a ng-if="::event.relative" ui-sref="person.detail({ personId: event.relative })"> {{ event.id }}: {{ event.label }}</a> <span ng-if="::!event.relative">{{ event.id }}: {{ event.label }}</span> </p> </div> </div> <div class="col-sm-12 col-md-10 text-center"> <ui-gmap-google-map id="ui-gmap-google-map" center="vm.map.center" zoom="vm.map.zoom"> <ui-gmap-marker ng-repeat="marker in vm.markers" coords="marker" idkey="marker.id" options="marker.options"></ui-gmap-marker> </ui-gmap-google-map> <svg id="timelinecontainer" viewbox="-15,-7,120,27" preserveaspectratio="none" version="1.0" x="0" y="0" width="900" height="180" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"> <line ng-repeat="line in ::vm.mainline.lines" ng-attr-x1="{{ line.x1 }}" ng-attr-x2="{{ line.x2 }}" ng-attr-y1="{{ line.y1 }}" ng-attr-y2="{{ line.y2 }}"> </line> <text ng-repeat="text in ::vm.mainline.texts" ng-attr-x="{{ text.x }}" ng-attr-y="{{ text.y }}"> {{ text.content }} </text> <path ng-repeat="event in vm.events" ng-mouseenter="vm.focusEvent(event)" ng-mouseleave="vm.unfocusEvent(event)" class="{{ event.class }}" ng-attr-d="{{ event.path }}"> </path> </svg> <p> <span>{{ vm.currentEvent }}</span> </p> </div> </div> </div> </div> </div>'),a.put("views/mapfacets.partial.html",'<a href="" ng-click="vm.removeFacetSelections()">Poista kaikki valinnat</a> <div class="facets"> <seco-jena-text-facet data-options="vm.facets.entryText"></seco-jena-text-facet> <div class="show-facets row"> <div class="col-xs-12"> <button class="btn btn-default pull-right visible-xs-block visible-sm-block" ng-click="show = !show">{{ show ? \'Piilota fasetit\' : \'Näytä fasetit\' }}</button> </div> </div> <div class="hideable-facets" ng-class="{ \'hidden-sm hidden-xs\': !show }"> <seco-checkbox-facet data-options="vm.facets.link"></seco-checkbox-facet> <!--  <seco-basic-facet data-options="vm.facets.occupation"></seco-basic-facet> \n    <seco-basic-facet data-options="vm.facets.period"></seco-basic-facet> --> <seco-basic-facet data-options="vm.facets.gender"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.dataset"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.author"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.category"></seco-basic-facet> <seco-basic-facet data-options="vm.facets.company"></seco-basic-facet> <seco-hierarchy-facet data-options="vm.facets.title"></seco-hierarchy-facet> <seco-basic-facet data-options="vm.facets.place"></seco-basic-facet> </div> </div>'),a.put("views/nlp.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.statistics.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="biography-chart"></div> <div ng-show="vm.error" class="alert alert-info" role="alert">{{ vm.error.message }}</div> <div class="col-md-3" ng-repeat="key in vm.upos"> <table> <th>{{ key }}</th> <th>Lkm</th> <tr ng-repeat="word in vm.results[key]"> <td>{{ word.lemma }}</td> <td>{{ word.count }}</td> </tr> </table> </div> </div> </div> </div>'),a.put("views/page-modal.html",'<div class="modal-header"> <div class="row"> <div class="col-xs-8"> <h3 class="modal-title">{{ $ctrl.person.ordinal }} {{ $ctrl.person.givenName }} {{ $ctrl.person.familyName }}</h3> </div> <div class="col-xs-4 text-right"> <button class="btn btn-default" ng-click="$ctrl.previousPage()" ng-disabled="$ctrl.pageNo === 1" aria-label="Edellinen sivu"> <span class="glyphicon glyphicon-step-backward"></span> </button> <span>{{ $ctrl.pageNo }}</span> <button class="btn btn-default" ng-click="$ctrl.nextPage()" ng-disabled="$ctrl.pageNo === 716" aria-label="Seuraava sivu"> <span class="glyphicon glyphicon-step-forward"></span> </button> <button ng-click="$ctrl.close()" class="btn btn-default" aria-label="Sulje"> <span aria-hidden="true" class="glyphicon glyphicon-remove"></span> </button> </div> </div> </div><div class="modal-body"> <img class="img img-responsive" ng-src="{{ $ctrl.pageUrl }}"> </div>'),a.put("views/person.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <ul class="nav nav-tabs"> <li ui-sref="person.detail" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Henkilön tiedot</a> </li> <li ui-sref="person.map" ui-sref-active="active"> <a href=""><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Aikajana</a> </li> </ul> </div> </div> <div class="row"> <div ui-view></div> </div> </div>'),a.put("views/place.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>{{ vm.place.label }}</h1> </div> </div> <div class="col-md-8"> <div id="linkContent"> <ws-related-links data-title="\'Syntyneet\'" data-related="vm.place.born"></ws-related-links> <ws-related-links data-title="\'Tapahtumat\'" data-related="vm.place.event"></ws-related-links> <ws-related-links data-title="\'Kuolleet\'" data-related="vm.place.died"></ws-related-links> </div> </div> </div>'),a.put("views/profile-image-popover.html",'<div> <img class="img img-responsive" ng-src="{{ img }}"> </div>'),a.put("views/sliderFacet.directive.html",'<seco-facet-wrapper> <rzslider rz-slider-model="vm.facet.slider.minValue" rz-slider-high="vm.facet.slider.maxValue" rz-slider-options="vm.facet.slider.options"></rzslider> </seco-facet-wrapper>'),a.put("views/subnavbar.html",'<ul class="nav navbar-nav"> <li><a href="" id="show-help" ng-click="vm.showHelp()"><span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Ohje</a></li> <li ui-sref-active="active"><a ui-sref="cards"><span class="glyphicon glyphicon-th" aria-hidden="true"></span> Ruudukko</a></li> <li ui-sref-active="active"><a ui-sref="table"><span class="glyphicon glyphicon-align-justify" aria-hidden="true"></span> Lista</a></li> <li ui-sref-active="active"><a ui-sref="groupmap"><span class="glyphicon glyphicon glyphicon-globe" aria-hidden="true"></span> Kartta</a></li> <li ui-sref-active="active"><a ui-sref="visualizations.visu2"><span class="glyphicon glyphicon-stats" aria-hidden="true"></span> Tilastoja</a></li> <li ui-sref-active="active"><a ui-sref="nlp"><span class="glyphicon glyphicon-book" aria-hidden="true"></span> Kielianalyysi</a></li> </ul>'),a.put("views/table.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-8 col-md-7 col-lg-8 vcenter push-xs-8"> <div ng-include="\'views/description.partial.html\'"></div> </div> <div class="col-md-4 pull-md-4 col-lg-3"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-8 col-lg-9"> Järjestä: <span class="sort"> <a href="" ng-click="vm.sortBy(\'?ordinal\')">Aikajärjestys</a> <span ng-class="vm.getSortClass(\'?ordinal\', true)" class="glyphicon" aria-hidden="true"></span> </span> <span class="sort"> <a href="" ng-click="vm.sortBy(\'?familyName\')">Sukunimi</a> <span ng-class="vm.getSortClass(\'?familyName\')" class="glyphicon" aria-hidden="true"></span> </span> <div ng-include="\'views/table.partial.html\'"></div> </div> </div> </div>'),a.put("views/table.partial.html",'<table class="table table-striped norssi-table ng-table-responsive" ng-table="vm.tableParams"> <thead> <tr> <th class="col-xs-4">Nimi</th> <th class="col-xs-1">Henkilö</th> <th class="col-xs-1">Linkit</th> <!-- <th class="col-xs-3"><span class="hidden-xs hidden-sm">Muuta</span></th>  --> <th class="col-xs-3 hidden-xs hidden-sm">Matrikkeliteksti</th> </tr> </thead> <tbody> <tr ng-show="!vm.isLoadingResults" ng-repeat="person in $data"> <td class="person-image-container" data-title="\'Nimi\'"> <div ng-class="::{ \'name-col col-md-12 col-lg-7\': person.images }"> <b><a ui-sref="person.detail({ personId: person.id })">{{ ::person.givenName }} {{ ::person.familyName }}</a></b><br> <span ng-if="::(person.birthDate)">&#8727;&nbsp;{{ ::person.birthPlace }} {{ ::person.birthDate }}</span> <span ng-if="::person.deathDate">&dagger;&nbsp;{{ ::person.deathPlace }} {{ ::person.deathDate }}</span> <br> <span class="icon-menu"> <a title="Kansallisbiografia" class="" ng-href="{{ ::person.kansallisbiografia }}"><span class="glyphicon glyphicon-book" aria-hidden="true"></span></a> <a title="Data" class="" ng-href="{{ ::person.id }}"><span class="glyphicon glyphicon-hdd" aria-hidden="true"></span></a> </span> </div> <div ng-if="::person.hasImage" class="name-col col-md-12 col-lg-5"> <div ng-repeat="img in ::person.images" ng-class="{ \'col-md-12\': ($first && $last), \'col-sm-6\': !($first && $last) }" class="person-img-col vcenter"> <img uib-popover-template="\'views/profile-image-popover.html\'" popover-trigger="\'mouseenter\'" popover-placement="auto right" popover-append-to-body="true" class="person-image img img-responsive" ng-src="{{ img  }}"> </div> </div> </td> <td class="links" data-title="\'Henkilö\'"> <div ng-if="::person.occupation" class="hidden-xs hidden-sm"> <p>{{ ::person.occupation | castArray | join:\', \' }}</p> </div> </td> <td class="links" data-title="\'Linkit\'"> <div ng-if="::person.achievement"> <a href="" uib-popover-template="\'views/achievements-popover.html\'" popover-trigger="\'outsideClick\'" popover-append-to-body="true" popover-placement="auto top">Saavutukset</a> </div> <a class="link" ng-if="::person.wikipedia" ng-href="{{ ::person.wikipedia }}">Wikipedia</a> <a class="link" ng-if="::person.warsa" ng-href="http://www.sotasampo.fi/fi/persons/?uri={{ ::person.warsa }}">Sotasampo</a> <a class="link" ng-if="::person.fennica[0]" ng-href="{{ ::person.fennica[0] }}">Fennica</a> <a class="link" ng-if="::person.fennica[1]" ng-href="{{ ::person.fennica[1] }}">Fennica (2)</a> <a class="link" ng-if="::person.kirjasampo" ng-href="{{ ::person.kirjasampo }}">Kirjasampo</a> <a class="link" ng-if="::person.kulttuurisampo" ng-href="{{ ::person.kulttuurisampo }}">Kulttuurisampo</a> <a class="link" ng-if="::person.blf" ng-href="{{ ::person.blf }}">BLF</a> <a class="link" ng-if="::person.ulan" ng-href="{{ ::person.ulan }}">ULAN</a> <a class="link" ng-if="::person.viaf" ng-href="{{ ::person.viaf }}">VIAF</a> <a class="link" ng-if="::person.norssi" ng-href="http://www.norssit.fi/semweb/#!/tiedot/http:~2F~2Fldf.fi~2Fnorssit~2F{{ ::person.norssi }}">Norssi</a> <a class="link" ng-if="::person.eduskunta" ng-href="{{ ::person.eduskunta }}">Eduskunta</a> <a class="link" ng-if="::person.website" ng-href="{{ ::person.website }}">Kotisivu</a> <a class="link" ng-if="::person.genicom" ng-href="{{ ::person.genicom }}">Kotisivu (Geni.com)</a> <a class="link" ng-if="::person.genitree" ng-href="{{ ::person.genitree }}">Sukupuu (Geni.com)</a> </td> <!-- \n    <td data-title="\'Muuta\'">\n      <div ng-if="::person.relative">\n      	<span>Sukulaiset: </span><br>\n      	<span ng-repeat="relative in person.relative | castArray">\n          {{ ::relative.type }} <a ui-sref="person.detail({ personId: relative.id })">{{ ::relative.name }}</a>\n      	</span>\n      </div>\n      <div ng-if="::person.hobby"><span>Harrastukset: </span><br>{{ ::person.hobby | join:\', \' }}</div>\n    </td>\n     --> <td data-title="\'Matrikkeliteksti\'" class="hidden-xs hidden-sm"><p ng-bind-html="::person.lead_paragraph"></p></td> </tr> </tbody> </table> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults">'),a.put("views/title.html",'<div class="container-fluid"> <div class="row"> <div class="col-sm-12"> <h1>{{ vm.title.label }}</h1> Under Construction </div> </div> <div class="row"> <div ui-view></div> </div> </div>'),a.put("views/visu.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.statistics.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> Työn alla - under construction <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="chart_education" style="width: 100%; height: 500px"></div> <div id="chart_eduorganization" style="width: 100%; height: 500px"></div> <div id="chart_occupation" style="width: 100%; height: 500px"></div> <div id="chart_organization" style="width: 100%; height: 500px"></div> <p style="font-family: Arial; font-size:15px; color:black"><strong>Oppilaitoksista saatuja oppiarvoja</strong></p> <div id="chart_sankey" style="width: 100%; height: 700px"></div> </div> </div> </div>'),a.put("views/visu.popup.html",'<div class="modal-header"> <h3>Henkil&ouml;t</h3> <ul class="list-group row list-group-persons ng-scope" id="popupcontainer2"> <li class="list-group-item col-xs-6 ng-scope" ng-show="vm.people" ng-repeat="person in vm.people"> <a ui-sref="person.detail({ personId: person.uri })">{{ person.name }}</a> </li> </ul> </div>'),a.put("views/visu2.html",'<div class="container-fluid"> <div class="row"> <div class="col-md-2 col-sm-2 col-xs-2 vcenter push-xs-2"> <img src="images/SKB.6aa384d7.svg" class="norssi-logo center-block img img-responsive"> </div><!-- DO NOT REMOVE THIS COMMENT, IT IS A HACK\n --><div class="col-xs-9 col-md-8 col-lg-9 vcenter push-xs-9"> <div ng-include="\'views/description.statistics.partial.html\'"></div> </div> <div class="col-md-3 pull-md-3 col-lg-2"> <div ng-include="\'views/facets.partial.html\'"></div> </div> <div class="col-md-9 col-lg-10" min-height="500"> <img class="loading-img" src="images/loading-lg.7ba320e0.gif" ng-if="vm.isLoadingResults"> <div id="chart_age"></div> <div id="chart_marriageAge"></div> <div id="chart_firstChildAge"></div> <div id="chart_numberOfChildren"></div> <div id="chart_numberOfSpouses"></div> <!-- \n         <div id="chart_matriculationYear"></div>\n         <div id="chart_topschools" style="width: 100%; height: 500px;"></div>\n         <div id="chart_toporganization" style="width: 100%; height: 500px;"></div>\n         <div id="chart_topeducation" style="width: 100%; height: 500px;"></div>\n          --> </div> </div> </div>')}]);